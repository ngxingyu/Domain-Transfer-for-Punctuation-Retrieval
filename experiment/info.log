[INFO] - Global seed set to 42
[INFO] - GPU available: True, used: True
[INFO] - TPU available: None, using: 0 TPU cores
[INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
[INFO] - Using native 16bit precision.
[INFO] - shuffling train set
[INFO] - Global seed set to 42
[INFO] - initializing ddp: GLOBAL_RANK: 0, MEMBER: 1/1
[INFO] - Optimizer config = AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.001
    weight_decay: 0.0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.01
    weight_decay: 0.0
)
[INFO] - Scheduler "<core.optim.lr_scheduler.CosineAnnealing object at 0x7fc91d99c250>" 
will be used during training (effective maximum steps = 1504) - 
Parameters : 
(warmup_steps: null
warmup_ratio: 0.1
min_lr: 1.0e-08
last_epoch: -1
max_steps: 1504
)
[INFO] - 
  | Name                       | Type                 | Params
--------------------------------------------------------------------
0 | transformer                | ElectraModel         | 108 M 
1 | punct_classifier           | TokenClassifier      | 600 K 
2 | domain_classifier          | SequenceClassifier   | 2.3 K 
3 | punctuation_loss           | FocalDiceLoss        | 0     
4 | domain_loss                | FocalDiceLoss        | 0     
5 | agg_loss                   | AggregatorLoss       | 0     
6 | punct_class_report         | ClassificationReport | 0     
7 | chunked_punct_class_report | ClassificationReport | 0     
8 | domain_class_report        | ClassificationReport | 0     
--------------------------------------------------------------------
602 K     Trainable params
108 M     Non-trainable params
109 M     Total params
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          69.46      31.17      43.03       9632
# (label_id: 1)                                         17.51       6.54       9.52       1376
, (label_id: 2)                                         12.26      29.81      17.37       2100
- (label_id: 3)                                          1.02       5.05       1.70        198
. (label_id: 4)                                          4.28      15.40       6.70       1000
? (label_id: 5)                                          0.00       0.00       0.00        112
… (label_id: 6)                                          0.96       0.65       0.78        308
-------------------
micro avg                                               26.38      26.38      26.38      14726
macro avg                                               15.07      12.66      11.30      14726
weighted avg                                            49.14      26.38      32.01      14726

-------------------
                       #           ,           -           .           ?           …
     3002.00       310.00       468.00       146.00       254.00        22.00       120.00
      302.00        90.00        50.00        10.00        42.00         6.00        14.00
     3590.00       290.00       626.00        10.00       464.00        48.00        78.00
      574.00        42.00       234.00        10.00        70.00        24.00        26.00
     2002.00       642.00       698.00        22.00       154.00         8.00        68.00
        0.00         0.00         0.00         0.00         2.00         0.00         0.00
      162.00         2.00        24.00         0.00        14.00         4.00         2.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00      89.39      94.40        132
1 (label_id: 1)                                          0.00       0.00       0.00          0
2 (label_id: 2)                                          0.00       0.00       0.00          0
-------------------
micro avg                                               89.39      89.39      89.39        132
macro avg                                               33.33      29.80      31.47        132
weighted avg                                           100.00      89.39      94.40        132

-------------------
           0           1           2
      118.00         0.00         0.00
        8.00         0.00         0.00
        6.00         0.00         0.00
-------------------

[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          96.84      85.65      90.90     398163
# (label_id: 1)                                         89.66      95.00      92.25      61618
, (label_id: 2)                                         57.73      70.77      63.59      92079
- (label_id: 3)                                         65.06      90.36      75.65       7045
. (label_id: 4)                                         45.61      48.33      46.93      42874
? (label_id: 5)                                         20.43      55.14      29.81       3348
… (label_id: 6)                                         11.48      30.21      16.63       6461
-------------------
micro avg                                               81.03      81.03      81.03     611588
macro avg                                               55.26      67.92      59.39     611588
weighted avg                                            84.95      81.03      82.55     611588

-------------------
                       #           ,           -           .           ?           …
   341007.00      2456.00      7010.00       190.00      1073.00        78.00       328.00
     6744.00     58537.00         4.00         4.00         0.00         0.00         0.00
    33379.00       109.00     65166.00       317.00     10950.00       535.00      2430.00
     2288.00        16.00       905.00      6366.00       152.00         9.00        49.00
    11014.00       372.00     11130.00        54.00     20723.00       729.00      1417.00
     1396.00         8.00      2189.00         9.00      3304.00      1846.00       285.00
     2335.00       120.00      5675.00       105.00      6672.00       151.00      1952.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00       4.62       8.83       5606
1 (label_id: 1)                                          0.00       0.00       0.00          0
2 (label_id: 2)                                          0.00       0.00       0.00          0
-------------------
micro avg                                                4.62       4.62       4.62       5606
macro avg                                               33.33       1.54       2.94       5606
weighted avg                                           100.00       4.62       8.83       5606

-------------------
           0           1           2
      259.00         0.00         0.00
      177.00         0.00         0.00
     5170.00         0.00         0.00
-------------------

[INFO] - Epoch 0, global step 187: val_loss reached 0.84230 (best 0.84230), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-21_07-48-57/checkpoints/Punctuation_with_Domain_discriminator---val_loss=0.84-epoch=0.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          97.06      87.40      91.97     398163
# (label_id: 1)                                         89.16      96.90      92.87      61618
, (label_id: 2)                                         61.46      73.66      67.01      92079
- (label_id: 3)                                         71.13      89.38      79.22       7045
. (label_id: 4)                                         48.90      65.36      55.95      42874
? (label_id: 5)                                         33.30      37.31      35.19       3348
… (label_id: 6)                                         17.46      15.74      16.55       6461
-------------------
micro avg                                               83.73      83.73      83.73     611588
macro avg                                               59.78      66.53      62.68     611588
weighted avg                                            86.04      83.73      84.52     611588

-------------------
                       #           ,           -           .           ?           …
   347982.00      1277.00      7336.00       212.00      1248.00       110.00       365.00
     7204.00     59705.00        23.00        24.00         8.00         0.00         0.00
    29167.00       144.00     67822.00       318.00      9659.00       583.00      2665.00
     2073.00        16.00       341.00      6297.00       100.00         5.00        21.00
    10803.00       448.00     14261.00       137.00     28024.00      1353.00      2280.00
      510.00        16.00       722.00        20.00      1121.00      1249.00       113.00
      424.00        12.00      1574.00        37.00      2714.00        48.00      1017.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00       3.48       6.72       5606
1 (label_id: 1)                                          0.00       0.00       0.00          0
2 (label_id: 2)                                          0.00       0.00       0.00          0
-------------------
micro avg                                                3.48       3.48       3.48       5606
macro avg                                               33.33       1.16       2.24       5606
weighted avg                                           100.00       3.48       6.72       5606

-------------------
           0           1           2
      195.00         0.00         0.00
      123.00         0.00         0.00
     5288.00         0.00         0.00
-------------------

[INFO] - Epoch 1, global step 375: val_loss reached 0.85639 (best 0.84230), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-21_07-48-57/checkpoints/Punctuation_with_Domain_discriminator---val_loss=0.86-epoch=1.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          97.05      88.57      92.62     398163
# (label_id: 1)                                         89.39      98.16      93.57      61618
, (label_id: 2)                                         63.63      72.70      67.86      92079
- (label_id: 3)                                         73.23      88.72      80.23       7045
. (label_id: 4)                                         49.43      60.35      54.35      42874
? (label_id: 5)                                         23.44      53.64      32.62       3348
… (label_id: 6)                                         17.51      18.42      17.95       6461
-------------------
micro avg                                               84.24      84.24      84.24     611588
macro avg                                               59.10      68.65      62.74     611588
weighted avg                                            86.39      84.24      85.04     611588

-------------------
                       #           ,           -           .           ?           …
   352652.00       568.00      7946.00       320.00      1366.00        92.00       429.00
     7115.00     60486.00        45.00         8.00        12.00         0.00         0.00
    25395.00        85.00     66944.00       318.00      9345.00       496.00      2625.00
     1532.00         8.00       491.00      6250.00       196.00         5.00        53.00
    10018.00       467.00     13017.00       119.00     25876.00       925.00      1923.00
     1034.00         4.00      1874.00        13.00      2701.00      1796.00       241.00
      417.00         0.00      1762.00        17.00      3378.00        34.00      1190.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00       4.05       7.78       5606
1 (label_id: 1)                                          0.00       0.00       0.00          0
2 (label_id: 2)                                          0.00       0.00       0.00          0
-------------------
micro avg                                                4.05       4.05       4.05       5606
macro avg                                               33.33       1.35       2.59       5606
weighted avg                                           100.00       4.05       7.78       5606

-------------------
           0           1           2
      227.00         0.00         0.00
      213.00         0.00         0.00
     5166.00         0.00         0.00
-------------------

[INFO] - Epoch 2, global step 563: val_loss reached 0.84835 (best 0.84230), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-21_07-48-57/checkpoints/Punctuation_with_Domain_discriminator---val_loss=0.85-epoch=2.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          96.60      89.39      92.86     398163
# (label_id: 1)                                         90.97      96.40      93.61      61618
, (label_id: 2)                                         62.36      76.16      68.57      92079
- (label_id: 3)                                         78.12      86.71      82.19       7045
. (label_id: 4)                                         51.62      55.66      53.57      42874
? (label_id: 5)                                         32.24      39.67      35.57       3348
… (label_id: 6)                                         15.77      17.63      16.65       6461
-------------------
micro avg                                               84.68      84.68      84.68     611588
macro avg                                               61.10      65.95      63.29     611588
weighted avg                                            86.31      84.68      85.28     611588

-------------------
                       #           ,           -           .           ?           …
   355918.00      1648.00      8324.00       395.00      1597.00       141.00       419.00
     5863.00     59402.00        29.00         0.00         0.00         4.00         0.00
    25923.00        97.00     70127.00       351.00     12377.00       716.00      2862.00
     1213.00         4.00       335.00      6109.00       121.00         5.00        33.00
     8305.00       423.00     10520.00       100.00     23865.00      1108.00      1911.00
      413.00         4.00       923.00         9.00      1345.00      1328.00        97.00
      528.00        40.00      1821.00        81.00      3569.00        46.00      1139.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00       3.03       5.89       5606
1 (label_id: 1)                                          0.00       0.00       0.00          0
2 (label_id: 2)                                          0.00       0.00       0.00          0
-------------------
micro avg                                                3.03       3.03       3.03       5606
macro avg                                               33.33       1.01       1.96       5606
weighted avg                                           100.00       3.03       5.89       5606

-------------------
           0           1           2
      170.00         0.00         0.00
      131.00         0.00         0.00
     5305.00         0.00         0.00
-------------------

[INFO] - Epoch 3, step 751: val_loss was not in top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          96.69      89.76      93.10     398163
# (label_id: 1)                                         90.41      97.93      94.02      61618
, (label_id: 2)                                         63.71      75.59      69.14      92079
- (label_id: 3)                                         80.51      86.96      83.61       7045
. (label_id: 4)                                         51.04      61.66      55.85      42874
? (label_id: 5)                                         33.08      35.19      34.10       3348
… (label_id: 6)                                         20.65       9.60      13.10       6461
-------------------
micro avg                                               85.30      85.30      85.30     611588
macro avg                                               62.30      65.24      63.28     611588
weighted avg                                            86.56      85.30      85.70     611588

-------------------
                       #           ,           -           .           ?           …
   357408.00       730.00      8815.00       356.00      1716.00       128.00       479.00
     6369.00     60344.00        25.00         4.00         0.00         4.00         0.00
    23725.00        80.00     69601.00       354.00     11963.00       683.00      2842.00
     1139.00         0.00       262.00      6126.00        53.00         0.00        29.00
     8999.00       456.00     11975.00       180.00     26436.00      1338.00      2406.00
      375.00         8.00       754.00         8.00      1153.00      1178.00        85.00
      148.00         0.00       647.00        17.00      1553.00        17.00       620.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00       3.25       6.29       5606
1 (label_id: 1)                                          0.00       0.00       0.00          0
2 (label_id: 2)                                          0.00       0.00       0.00          0
-------------------
micro avg                                                3.25       3.25       3.25       5606
macro avg                                               33.33       1.08       2.10       5606
weighted avg                                           100.00       3.25       6.29       5606

-------------------
           0           1           2
      182.00         0.00         0.00
      119.00         0.00         0.00
     5305.00         0.00         0.00
-------------------

[INFO] - Epoch 4, step 939: val_loss was not in top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          96.42      90.44      93.34     398163
# (label_id: 1)                                         90.81      97.93      94.23      61618
, (label_id: 2)                                         65.69      73.43      69.34      92079
- (label_id: 3)                                         79.18      86.27      82.58       7045
. (label_id: 4)                                         51.14      64.67      57.12      42874
? (label_id: 5)                                         34.59      35.04      34.81       3348
… (label_id: 6)                                         17.82       9.55      12.43       6461
-------------------
micro avg                                               85.62      85.62      85.62     611588
macro avg                                               62.24      65.33      63.41     611588
weighted avg                                            86.69      85.62      85.98     611588

-------------------
                       #           ,           -           .           ?           …
   360109.00       722.00      9564.00       387.00      2017.00       137.00       527.00
     6092.00     60340.00        13.00         4.00         0.00         0.00         0.00
    21230.00        76.00     67613.00       353.00     10439.00       645.00      2575.00
     1227.00         8.00       242.00      6078.00        84.00         4.00        33.00
     8922.00       468.00     12936.00       166.00     27727.00      1364.00      2632.00
      404.00         4.00       707.00        12.00      1014.00      1173.00        77.00
      179.00         0.00      1004.00        45.00      1593.00        25.00       617.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00       3.03       5.89       5606
1 (label_id: 1)                                          0.00       0.00       0.00          0
2 (label_id: 2)                                          0.00       0.00       0.00          0
-------------------
micro avg                                                3.03       3.03       3.03       5606
macro avg                                               33.33       1.01       1.96       5606
weighted avg                                           100.00       3.03       5.89       5606

-------------------
           0           1           2
      170.00         0.00         0.00
      103.00         0.00         0.00
     5333.00         0.00         0.00
-------------------

[INFO] - Epoch 5, step 1127: val_loss was not in top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          96.74      89.93      93.21     398163
# (label_id: 1)                                         90.75      98.09      94.27      61618
, (label_id: 2)                                         64.57      74.68      69.26      92079
- (label_id: 3)                                         80.11      85.81      82.86       7045
. (label_id: 4)                                         51.02      64.80      57.09      42874
? (label_id: 5)                                         33.57      35.27      34.40       3348
… (label_id: 6)                                         16.11       7.00       9.76       6461
-------------------
micro avg                                               85.47      85.47      85.47     611588
macro avg                                               61.84      65.08      62.98     611588
weighted avg                                            86.70      85.47      85.86     611588

-------------------
                       #           ,           -           .           ?           …
   358078.00       622.00      8686.00       408.00      1769.00       113.00       487.00
     6143.00     60440.00        17.00         4.00         0.00         0.00         0.00
    22932.00        72.00     68768.00       365.00     10917.00       690.00      2751.00
     1230.00        12.00       170.00      6045.00        64.00         0.00        25.00
     9201.00       464.00     12818.00       177.00     27784.00      1335.00      2677.00
      416.00         8.00       735.00        17.00      1092.00      1181.00        69.00
      163.00         0.00       885.00        29.00      1248.00        29.00       452.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00       3.18       6.15       5606
1 (label_id: 1)                                          0.00       0.00       0.00          0
2 (label_id: 2)                                          0.00       0.00       0.00          0
-------------------
micro avg                                                3.18       3.18       3.18       5606
macro avg                                               33.33       1.06       2.05       5606
weighted avg                                           100.00       3.18       6.15       5606

-------------------
           0           1           2
      178.00         0.00         0.00
       91.00         0.00         0.00
     5337.00         0.00         0.00
-------------------

[INFO] - Epoch 6, step 1315: val_loss was not in top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          96.72      90.01      93.24     398163
# (label_id: 1)                                         90.77      98.09      94.29      61618
, (label_id: 2)                                         64.64      74.89      69.39      92079
- (label_id: 3)                                         79.40      85.86      82.51       7045
. (label_id: 4)                                         51.18      63.74      56.77      42874
? (label_id: 5)                                         32.05      36.77      34.25       3348
… (label_id: 6)                                         17.72       7.97      10.99       6461
-------------------
micro avg                                               85.50      85.50      85.50     611588
macro avg                                               61.78      65.33      63.06     611588
weighted avg                                            86.71      85.50      85.89     611588

-------------------
                       #           ,           -           .           ?           …
   358394.00       622.00      8728.00       420.00      1806.00       101.00       490.00
     6123.00     60444.00        17.00         4.00         0.00         0.00         0.00
    22833.00        72.00     68955.00       353.00     11043.00       686.00      2733.00
     1222.00         8.00       218.00      6049.00        88.00         0.00        33.00
     8972.00       464.00     12547.00       173.00     27328.00      1305.00      2609.00
      468.00         8.00       808.00        17.00      1228.00      1231.00        81.00
      151.00         0.00       806.00        29.00      1381.00        25.00       515.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00       3.25       6.29       5606
1 (label_id: 1)                                          0.00       0.00       0.00          0
2 (label_id: 2)                                          0.00       0.00       0.00          0
-------------------
micro avg                                                3.25       3.25       3.25       5606
macro avg                                               33.33       1.08       2.10       5606
weighted avg                                           100.00       3.25       6.29       5606

-------------------
           0           1           2
      182.00         0.00         0.00
       99.00         0.00         0.00
     5325.00         0.00         0.00
-------------------

[INFO] - Epoch 7, step 1503: val_loss was not in top 3
[INFO] - Saving latest checkpoint...
[INFO] - Global seed set to 42
[INFO] - Optimizer config = AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0001
    weight_decay: 0.0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.001
    weight_decay: 0.0
)
[INFO] - Scheduler "<core.optim.lr_scheduler.CosineAnnealing object at 0x7fc8b85bfe20>" 
will be used during training (effective maximum steps = 1504) - 
Parameters : 
(warmup_steps: null
warmup_ratio: 0.1
min_lr: 1.0e-08
last_epoch: -1
max_steps: 1504
)
[INFO] - 
  | Name                       | Type                 | Params
--------------------------------------------------------------------
0 | transformer                | ElectraModel         | 108 M 
1 | punct_classifier           | TokenClassifier      | 600 K 
2 | domain_classifier          | SequenceClassifier   | 2.3 K 
3 | punctuation_loss           | FocalDiceLoss        | 0     
4 | domain_loss                | FocalDiceLoss        | 0     
5 | agg_loss                   | AggregatorLoss       | 0     
6 | punct_class_report         | ClassificationReport | 0     
7 | chunked_punct_class_report | ClassificationReport | 0     
8 | domain_class_report        | ClassificationReport | 0     
--------------------------------------------------------------------
7.7 M     Trainable params
101 M     Non-trainable params
109 M     Total params
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          96.77      89.58      93.03       9632
# (label_id: 1)                                         90.47      97.97      94.07       1376
, (label_id: 2)                                         63.60      81.05      71.27       2100
- (label_id: 3)                                         76.58      85.86      80.95        198
. (label_id: 4)                                         54.89      67.40      60.50       1000
? (label_id: 5)                                         42.86      37.50      40.00        112
… (label_id: 6)                                         37.50      11.69      17.82        308
-------------------
micro avg                                               85.56      85.56      85.56      14726
macro avg                                               66.09      67.29      65.38      14726
weighted avg                                            86.69      85.56      85.68      14726

-------------------
                       #           ,           -           .           ?           …
     8628.00        16.00       176.00        14.00        42.00         6.00        34.00
      140.00      1348.00         0.00         2.00         0.00         0.00         0.00
      590.00         0.00      1702.00         8.00       234.00        22.00       120.00
       44.00         0.00         4.00       170.00         0.00         0.00         4.00
      212.00        12.00       174.00         4.00       674.00        42.00       110.00
       16.00         0.00        16.00         0.00        20.00        42.00         4.00
        2.00         0.00        28.00         0.00        30.00         0.00        36.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00       4.55       8.70        132
1 (label_id: 1)                                          0.00       0.00       0.00          0
2 (label_id: 2)                                          0.00       0.00       0.00          0
-------------------
micro avg                                                4.55       4.55       4.55        132
macro avg                                               33.33       1.52       2.90        132
weighted avg                                           100.00       4.55       8.70        132

-------------------
           0           1           2
        6.00         0.00         0.00
        0.00         0.00         0.00
      126.00         0.00         0.00
-------------------

[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          96.72      90.01      93.24     398163
# (label_id: 1)                                         90.77      98.09      94.29      61618
, (label_id: 2)                                         64.63      74.88      69.38      92079
- (label_id: 3)                                         79.40      85.86      82.51       7045
. (label_id: 4)                                         51.19      63.74      56.78      42874
? (label_id: 5)                                         32.08      36.77      34.27       3348
… (label_id: 6)                                         17.80       8.03      11.07       6461
-------------------
micro avg                                               85.50      85.50      85.50     611588
macro avg                                               61.80      65.34      63.08     611588
weighted avg                                            86.71      85.50      85.89     611588

-------------------
                       #           ,           -           .           ?           …
   358398.00       622.00      8728.00       420.00      1810.00       101.00       490.00
     6123.00     60444.00        17.00         4.00         0.00         0.00         0.00
    22837.00        72.00     68947.00       353.00     11043.00       686.00      2737.00
     1222.00         8.00       218.00      6049.00        88.00         0.00        33.00
     8964.00       464.00     12551.00       173.00     27328.00      1305.00      2601.00
      468.00         8.00       808.00        17.00      1224.00      1231.00        81.00
      151.00         0.00       810.00        29.00      1381.00        25.00       519.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00       3.25       6.29       5606
1 (label_id: 1)                                          0.00       0.00       0.00          0
2 (label_id: 2)                                          0.00       0.00       0.00          0
-------------------
micro avg                                                3.25       3.25       3.25       5606
macro avg                                               33.33       1.08       2.10       5606
weighted avg                                           100.00       3.25       6.29       5606

-------------------
           0           1           2
      182.00         0.00         0.00
       99.00         0.00         0.00
     5325.00         0.00         0.00
-------------------

[INFO] - Epoch 0, step 1691: val_loss was not in top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          96.71      90.01      93.24     398163
# (label_id: 1)                                         90.77      98.09      94.29      61618
, (label_id: 2)                                         64.64      74.89      69.39      92079
- (label_id: 3)                                         79.40      85.86      82.51       7045
. (label_id: 4)                                         51.19      63.74      56.78      42874
? (label_id: 5)                                         32.05      36.77      34.25       3348
… (label_id: 6)                                         17.83       8.03      11.08       6461
-------------------
micro avg                                               85.50      85.50      85.50     611588
macro avg                                               61.80      65.34      63.08     611588
weighted avg                                            86.71      85.50      85.89     611588

-------------------
                       #           ,           -           .           ?           …
   358394.00       626.00      8728.00       420.00      1810.00       101.00       490.00
     6123.00     60440.00        17.00         4.00         0.00         0.00         0.00
    22837.00        72.00     68959.00       353.00     11039.00       686.00      2733.00
     1222.00         8.00       218.00      6049.00        88.00         0.00        33.00
     8968.00       464.00     12543.00       173.00     27328.00      1305.00      2605.00
      468.00         8.00       808.00        17.00      1228.00      1231.00        81.00
      151.00         0.00       806.00        29.00      1381.00        25.00       519.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00       3.25       6.29       5606
1 (label_id: 1)                                          0.00       0.00       0.00          0
2 (label_id: 2)                                          0.00       0.00       0.00          0
-------------------
micro avg                                                3.25       3.25       3.25       5606
macro avg                                               33.33       1.08       2.10       5606
weighted avg                                           100.00       3.25       6.29       5606

-------------------
           0           1           2
      182.00         0.00         0.00
       99.00         0.00         0.00
     5325.00         0.00         0.00
-------------------

[INFO] - Epoch 1, step 1879: val_loss was not in top 3
[INFO] - Global seed set to 42
[INFO] - Optimizer config = AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 1e-05
    weight_decay: 0.0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0001
    weight_decay: 0.0
)
[INFO] - Scheduler "<core.optim.lr_scheduler.CosineAnnealing object at 0x7fc8b824deb0>" 
will be used during training (effective maximum steps = 1504) - 
Parameters : 
(warmup_steps: null
warmup_ratio: 0.1
min_lr: 1.0e-08
last_epoch: -1
max_steps: 1504
)
[INFO] - 
  | Name                       | Type                 | Params
--------------------------------------------------------------------
0 | transformer                | ElectraModel         | 108 M 
1 | punct_classifier           | TokenClassifier      | 600 K 
2 | domain_classifier          | SequenceClassifier   | 2.3 K 
3 | punctuation_loss           | FocalDiceLoss        | 0     
4 | domain_loss                | FocalDiceLoss        | 0     
5 | agg_loss                   | AggregatorLoss       | 0     
6 | punct_class_report         | ClassificationReport | 0     
7 | chunked_punct_class_report | ClassificationReport | 0     
8 | domain_class_report        | ClassificationReport | 0     
--------------------------------------------------------------------
14.8 M    Trainable params
94.7 M    Non-trainable params
109 M     Total params
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          96.77      89.58      93.03       9632
# (label_id: 1)                                         90.47      97.97      94.07       1376
, (label_id: 2)                                         63.60      81.05      71.27       2100
- (label_id: 3)                                         76.58      85.86      80.95        198
. (label_id: 4)                                         54.89      67.40      60.50       1000
? (label_id: 5)                                         42.86      37.50      40.00        112
… (label_id: 6)                                         37.50      11.69      17.82        308
-------------------
micro avg                                               85.56      85.56      85.56      14726
macro avg                                               66.09      67.29      65.38      14726
weighted avg                                            86.69      85.56      85.68      14726

-------------------
                       #           ,           -           .           ?           …
     8628.00        16.00       176.00        14.00        42.00         6.00        34.00
      140.00      1348.00         0.00         2.00         0.00         0.00         0.00
      590.00         0.00      1702.00         8.00       234.00        22.00       120.00
       44.00         0.00         4.00       170.00         0.00         0.00         4.00
      212.00        12.00       174.00         4.00       674.00        42.00       110.00
       16.00         0.00        16.00         0.00        20.00        42.00         4.00
        2.00         0.00        28.00         0.00        30.00         0.00        36.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00       4.55       8.70        132
1 (label_id: 1)                                          0.00       0.00       0.00          0
2 (label_id: 2)                                          0.00       0.00       0.00          0
-------------------
micro avg                                                4.55       4.55       4.55        132
macro avg                                               33.33       1.52       2.90        132
weighted avg                                           100.00       4.55       8.70        132

-------------------
           0           1           2
        6.00         0.00         0.00
        0.00         0.00         0.00
      126.00         0.00         0.00
-------------------

[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          96.71      90.01      93.24     398163
# (label_id: 1)                                         90.77      98.09      94.29      61618
, (label_id: 2)                                         64.64      74.89      69.39      92079
- (label_id: 3)                                         79.40      85.86      82.51       7045
. (label_id: 4)                                         51.19      63.74      56.78      42874
? (label_id: 5)                                         32.05      36.77      34.25       3348
… (label_id: 6)                                         17.83       8.03      11.08       6461
-------------------
micro avg                                               85.50      85.50      85.50     611588
macro avg                                               61.80      65.34      63.08     611588
weighted avg                                            86.71      85.50      85.89     611588

-------------------
                       #           ,           -           .           ?           …
   358394.00       626.00      8728.00       420.00      1810.00       101.00       490.00
     6123.00     60440.00        17.00         4.00         0.00         0.00         0.00
    22837.00        72.00     68959.00       353.00     11039.00       686.00      2733.00
     1222.00         8.00       218.00      6049.00        88.00         0.00        33.00
     8968.00       464.00     12543.00       173.00     27328.00      1305.00      2605.00
      468.00         8.00       808.00        17.00      1228.00      1231.00        81.00
      151.00         0.00       806.00        29.00      1381.00        25.00       519.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00       3.25       6.29       5606
1 (label_id: 1)                                          0.00       0.00       0.00          0
2 (label_id: 2)                                          0.00       0.00       0.00          0
-------------------
micro avg                                                3.25       3.25       3.25       5606
macro avg                                               33.33       1.08       2.10       5606
weighted avg                                           100.00       3.25       6.29       5606

-------------------
           0           1           2
      182.00         0.00         0.00
       99.00         0.00         0.00
     5325.00         0.00         0.00
-------------------

[INFO] - Epoch 0, step 1880: val_loss was not in top 3
[INFO] - GPU available: True, used: True
[INFO] - TPU available: None, using: 0 TPU cores
[INFO] - Using environment variable NODE_RANK for node rank (0).
[INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          96.55      89.92      93.12     412350
# (label_id: 1)                                         90.72      98.19      94.31      62980
, (label_id: 2)                                         64.80      73.61      68.93      98536
- (label_id: 3)                                         80.56      84.94      82.69       7708
. (label_id: 4)                                         47.60      63.26      54.32      40894
? (label_id: 5)                                         30.78      37.40      33.77       2666
… (label_id: 6)                                         22.13       8.28      12.05       7486
-------------------
micro avg                                               85.23      85.23      85.23     632620
macro avg                                               61.88      65.09      62.74     632620
weighted avg                                            86.51      85.23      85.62     632620

-------------------
                       #           ,           -           .           ?           …
   370780.00       584.00      9774.00       597.00      1680.00        96.00       502.00
     6291.00     61837.00        16.00         4.00         8.00         0.00         4.00
    24476.00        78.00     72534.00       336.00     11005.00       541.00      2957.00
     1222.00         0.00       267.00      6547.00        79.00         0.00        12.00
     9013.00       457.00     14550.00       192.00     25871.00      1032.00      3237.00
      365.00        20.00       695.00        16.00       992.00       997.00       154.00
      203.00         4.00       700.00        16.00      1259.00         0.00       620.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00       4.54       8.69       5792
1 (label_id: 1)                                          0.00       0.00       0.00          0
2 (label_id: 2)                                          0.00       0.00       0.00          0
-------------------
micro avg                                                4.54       4.54       4.54       5792
macro avg                                               33.33       1.51       2.90       5792
weighted avg                                           100.00       4.54       8.69       5792

-------------------
           0           1           2
      263.00         0.00         0.00
       74.00         0.00         0.00
     5455.00         0.00         0.00
-------------------

[INFO] - saving to /home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-21_07-48-57/test-swi-9.txt
[INFO] - Internal process exited
