[INFO] - Global seed set to 42
[INFO] - GPU available: True, used: True
[INFO] - TPU available: None, using: 0 TPU cores
[INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [1]
[INFO] - Using native 16bit precision.
[INFO] - shuffling train set
[INFO] - Global seed set to 42
[INFO] - initializing ddp: GLOBAL_RANK: 0, MEMBER: 1/1
[INFO] - Optimizer config = AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.001
    weight_decay: 0.0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.01
    weight_decay: 0.0
)
[INFO] - Scheduler "<core.optim.lr_scheduler.CosineAnnealing object at 0x7fb7483098b0>" 
will be used during training (effective maximum steps = 2000) - 
Parameters : 
(warmup_steps: null
warmup_ratio: 0.1
min_lr: 1.0e-08
last_epoch: -1
max_steps: 2000
)
[INFO] - 
  | Name                       | Type                 | Params
--------------------------------------------------------------------
0 | transformer                | ElectraModel         | 108 M 
1 | punct_classifier           | TokenClassifier      | 599 K 
2 | domain_classifier          | TokenClassifier      | 592 K 
3 | punctuation_loss           | FocalDiceLoss        | 0     
4 | domain_loss                | FocalDiceLoss        | 0     
5 | agg_loss                   | AggregatorLoss       | 0     
6 | punct_class_report         | ClassificationReport | 0     
7 | chunked_punct_class_report | ClassificationReport | 0     
8 | domain_class_report        | ClassificationReport | 0     
--------------------------------------------------------------------
1.2 M     Trainable params
108 M     Non-trainable params
110 M     Total params
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          70.18       4.39       8.27      10606
, (label_id: 1)                                          0.00       0.00       0.00          0
. (label_id: 2)                                          0.00       0.00       0.00       2236
? (label_id: 3)                                          0.45       5.41       0.84        148
! (label_id: 4)                                          6.47      55.87      11.59        988
- (label_id: 5)                                          0.00       0.00       0.00          0
… (label_id: 6)                                          0.00       0.00       0.00         20
: (label_id: 7)                                          1.10       6.25       1.87        128
-------------------
micro avg                                                7.32       7.32       7.32      14126
macro avg                                                9.78       8.99       2.82      14126
weighted avg                                            53.16       7.32       7.05      14126

-------------------
                       ,           .           ?           !           -           …           :
      466.00         0.00       114.00         2.00        74.00         0.00         0.00         8.00
     1350.00         0.00       396.00        12.00       110.00         0.00         6.00        24.00
       16.00         0.00         0.00         2.00         6.00         0.00         0.00         0.00
     1258.00         0.00       348.00         8.00       136.00         0.00         4.00        12.00
     6766.00         0.00      1036.00       100.00       552.00         0.00         8.00        76.00
      300.00         0.00        20.00         4.00        24.00         0.00         0.00         0.00
      154.00         0.00         4.00         0.00         4.00         0.00         0.00         0.00
      296.00         0.00       318.00        20.00        82.00         0.00         2.00         8.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00      57.86      73.31      14126
1 (label_id: 1)                                          0.00       0.00       0.00          0
-------------------
micro avg                                               57.86      57.86      57.86      14126
macro avg                                               50.00      28.93      36.65      14126
weighted avg                                           100.00      57.86      73.31      14126

-------------------
           0           1
     8174.00         0.00
     5952.00         0.00
-------------------

[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          97.05      80.08      87.75     115368
, (label_id: 1)                                          0.00       0.00       0.00          4
. (label_id: 2)                                         47.67      71.16      57.09      26620
? (label_id: 3)                                         70.44      90.54      79.24       2664
! (label_id: 4)                                         38.33      48.64      42.88      12064
- (label_id: 5)                                          0.00       0.00       0.00          0
… (label_id: 6)                                         11.11      38.57      17.25        560
: (label_id: 7)                                         18.90      29.56      23.06       2936
-------------------
micro avg                                               75.34      75.34      75.34     160216
macro avg                                               35.44      44.82      38.41     160216
weighted avg                                            82.24      75.34      77.70     160216

-------------------
                       ,           .           ?           !           -           …           :
    92392.00         0.00      2068.00       112.00       460.00         0.00        16.00       156.00
        0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00
    16684.00         4.00     18944.00        84.00      2908.00         0.00       100.00      1020.00
      596.00         0.00       296.00      2412.00        92.00         0.00         4.00        24.00
     4708.00         0.00      3664.00        56.00      5868.00         0.00       220.00       792.00
        0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00
      492.00         0.00       484.00         0.00       676.00         0.00       216.00        76.00
      496.00         0.00      1164.00         0.00      2060.00         0.00         4.00       868.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00      14.88      25.91     160216
1 (label_id: 1)                                          0.00       0.00       0.00          0
-------------------
micro avg                                               14.88      14.88      14.88     160216
macro avg                                               50.00       7.44      12.95     160216
weighted avg                                           100.00      14.88      25.91     160216

-------------------
           0           1
    23840.00         0.00
   136376.00         0.00
-------------------

[INFO] - Epoch 0, global step 249: val_loss reached 1.34467 (best 1.34467), saving model to "/home/nxingyu/project/Punctuation_with_Domain_discriminator/2021-03-22_10-02-47/checkpoints/Punctuation_with_Domain_discriminator---val_loss=1.34-epoch=0.ckpt" as top 3
[INFO] - Saving latest checkpoint...
[INFO] - Epoch 1, global step 487: val_loss reached 1.34467 (best 1.34467), saving model to "/home/nxingyu/project/Punctuation_with_Domain_discriminator/2021-03-22_10-02-47/checkpoints/Punctuation_with_Domain_discriminator---val_loss=1.34-epoch=1.ckpt" as top 3
[INFO] - Internal process exited
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             [INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          76.50      80.65      78.52     115368
, (label_id: 1)                                          0.00       0.00       0.00          4
. (label_id: 2)                                         28.86      25.41      27.02      26620
? (label_id: 3)                                         26.36      21.77      23.85       2664
! (label_id: 4)                                         17.82      16.81      17.30      12064
- (label_id: 5)                                          0.00       0.00       0.00          0
… (label_id: 6)                                         14.50      13.57      14.02        560
: (label_id: 7)                                         11.97       4.22       6.24       2936
-------------------
micro avg                                               64.05      64.05      64.05     160216
macro avg                                               22.00      20.30      20.87     160216
weighted avg                                            61.93      64.05      62.90     160216

-------------------
                       ,           .           ?           !           -           …           :
    93048.00         4.00     16712.00      1664.00      7912.00         0.00       336.00      1952.00
        8.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00
    14072.00         0.00      6764.00       264.00      1816.00         0.00        64.00       460.00
     1040.00         0.00       372.00       580.00       132.00         0.00         8.00        68.00
     6408.00         0.00      2404.00       144.00      2028.00         0.00        64.00       332.00
        0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00
      256.00         0.00       140.00         0.00        52.00         0.00        76.00         0.00
      536.00         0.00       228.00        12.00       124.00         0.00        12.00       124.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00       6.33      11.90       1644
1 (label_id: 1)                                          0.00       0.00       0.00          0
2 (label_id: 2)                                          0.00       0.00       0.00          0
-------------------
micro avg                                                6.33       6.33       6.33       1644
macro avg                                               33.33       2.11       3.97       1644
weighted avg                                           100.00       6.33      11.90       1644

-------------------
           0           1           2
      104.00         0.00         0.00
       80.00         0.00         0.00
     1460.00         0.00         0.00
-------------------

[INFO] - Epoch 1, step 629: val_loss was not in top 3
[INFO] - Internal process exited
