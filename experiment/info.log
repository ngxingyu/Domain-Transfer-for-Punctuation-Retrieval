[INFO] - GPU available: True, used: True
[INFO] - TPU available: None, using: 0 TPU cores
[INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
[INFO] - Using native 16bit precision.
[INFO] - shuffling train set
[INFO] - initializing ddp: GLOBAL_RANK: 0, MEMBER: 1/1
[INFO] - Optimizer config = AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.02
    weight_decay: 0.0
)
[INFO] - Scheduler "<core.optim.lr_scheduler.CosineAnnealing object at 0x7ff6846b3b80>" 
will be used during training (effective maximum steps = 104) - 
Parameters : 
(warmup_steps: null
warmup_ratio: 0.1
min_lr: 1.0e-08
last_epoch: -1
max_steps: 104
)
[INFO] - 
  | Name                       | Type                 | Params
--------------------------------------------------------------------
0 | transformer                | ElectraModel         | 108 M 
1 | punct_classifier           | TokenClassifier      | 6.9 K 
2 | domain_classifier          | SequenceClassifier   | 4.7 M 
3 | punctuation_loss           | LinearChainCRF       | 99    
4 | domain_loss                | CrossEntropyLoss     | 0     
5 | agg_loss                   | AggregatorLoss       | 0     
6 | punct_class_report         | ClassificationReport | 0     
7 | chunked_punct_class_report | ClassificationReport | 0     
8 | domain_class_report        | ClassificationReport | 0     
--------------------------------------------------------------------
4.7 M     Trainable params
108 M     Non-trainable params
113 M     Total params
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          81.82       0.10       0.21      34866
! (label_id: 1)                                          0.00       0.00       0.00         34
# (label_id: 2)                                         14.68       6.63       9.13       3230
, (label_id: 3)                                          4.08       2.61       3.18       2376
- (label_id: 4)                                          1.47      16.67       2.69        240
. (label_id: 5)                                          2.37      31.05       4.40       2074
: (label_id: 6)                                          0.00       0.00       0.00         56
? (label_id: 7)                                          0.00       0.00       0.00        170
… (label_id: 8)                                          0.00       0.00       0.00         10
-------------------
micro avg                                                2.31       2.31       2.31      43056
macro avg                                               11.60       6.34       2.18      43056
weighted avg                                            67.70       2.31       1.25      43056

-------------------
                       !           #           ,           -           .           :           ?           …
       36.00         0.00         8.00         0.00         0.00         0.00         0.00         0.00         0.00
      240.00         0.00        22.00        14.00         0.00        34.00         0.00         2.00         0.00
     1066.00         0.00       214.00        86.00        14.00        70.00         2.00         6.00         0.00
     1248.00         2.00       124.00        62.00         2.00        78.00         0.00         2.00         2.00
     1798.00         6.00       230.00       288.00        40.00       328.00         6.00        34.00         0.00
    23962.00         8.00      1578.00       784.00        90.00       644.00        32.00        62.00         8.00
      382.00         0.00       570.00         4.00         0.00         2.00         0.00         0.00         0.00
      332.00         0.00        10.00        26.00         0.00         2.00         0.00         0.00         0.00
     5802.00        18.00       474.00      1112.00        94.00       916.00        16.00        64.00         0.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00     100.00     100.00        368
-------------------
micro avg                                              100.00     100.00     100.00        368
macro avg                                              100.00     100.00     100.00        368
weighted avg                                           100.00     100.00     100.00        368

-------------------
           0
      368.00
-------------------

[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          90.44      93.04      91.72     553457
! (label_id: 1)                                          0.00       0.00       0.00        482
# (label_id: 2)                                         79.14      75.72      77.39      58468
, (label_id: 3)                                         37.80      38.59      38.19      43682
- (label_id: 4)                                          0.00       0.00       0.00       3534
. (label_id: 5)                                         55.89      12.10      19.90      35434
: (label_id: 6)                                          0.00       0.00       0.00        844
? (label_id: 7)                                          0.00       0.00       0.00       2961
… (label_id: 8)                                          0.07       6.69       0.15        239
-------------------
micro avg                                               83.02      83.02      83.02     699101
macro avg                                               29.26      25.13      25.26     699101
weighted avg                                            83.41      83.02      82.48     699101

-------------------
                       !           #           ,           -           .           :           ?           …
   514952.00       196.00     12206.00     24278.00      2977.00     13236.00       270.00      1184.00       116.00
        8.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00
    10961.00         0.00     44271.00       256.00       268.00       170.00        10.00         1.00         0.00
     8710.00       253.00        77.00     16855.00        99.00     16758.00       497.00      1237.00       105.00
        8.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00
     1926.00        33.00        42.00       879.00        33.00      4288.00        26.00       443.00         2.00
        0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00
    16892.00         0.00      1872.00      1414.00       157.00       982.00        41.00        96.00        16.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00     100.00     100.00       5883
-------------------
micro avg                                              100.00     100.00     100.00       5883
macro avg                                              100.00     100.00     100.00       5883
weighted avg                                           100.00     100.00     100.00       5883

-------------------
           0
     5883.00
-------------------

[INFO] - Epoch 0, global step 12: val_loss reached 53.28495 (best 53.28495), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-02-22_14-06-14/checkpoints/Punctuation_with_Domain_discriminator---val_loss=53.28-epoch=0.ckpt" as top 3
