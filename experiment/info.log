[INFO] - GPU available: True, used: True
[INFO] - TPU available: None, using: 0 TPU cores
[INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [1]
[INFO] - Using native 16bit precision.
[INFO] - shuffling train set
[INFO] - initializing ddp: GLOBAL_RANK: 0, MEMBER: 1/1
[INFO] - Optimizer config = AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.01
    weight_decay: 0.0
)
[INFO] - Scheduler "<core.optim.lr_scheduler.CosineAnnealing object at 0x7f98a67675e0>" 
will be used during training (effective maximum steps = 78825) - 
Parameters : 
(warmup_steps: null
warmup_ratio: 0.1
min_lr: 1.0e-10
last_epoch: -1
max_steps: 78825
)
[INFO] - 
  | Name                | Type                 | Params
-------------------------------------------------------------
0 | transformer         | ElectraModel         | 108 M 
1 | punct_classifier    | TokenClassifier      | 7.7 K 
2 | domain_classifier   | SequenceClassifier   | 3.1 K 
3 | punctuation_loss    | FocalDiceLoss        | 0     
4 | domain_loss         | CrossEntropyLoss     | 0     
5 | agg_loss            | AggregatorLoss       | 0     
6 | punct_class_report  | ClassificationReport | 0     
7 | domain_class_report | ClassificationReport | 0     
-------------------------------------------------------------
2.4 M     Trainable params
106 M     Non-trainable params
108 M     Total params
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          97.31       1.05       2.09      17162
! (label_id: 1)                                          0.28      10.34       0.54         58
, (label_id: 2)                                          3.49      10.34       5.22        532
- (label_id: 3)                                          0.00       0.00       0.00         27
. (label_id: 4)                                          7.95       2.53       3.84       1028
: (label_id: 5)                                          0.00       0.00       0.00          0
; (label_id: 6)                                          0.03      50.00       0.06          4
? (label_id: 7)                                          0.37       2.07       0.63        145
— (label_id: 8)                                          0.00       0.00       0.00          0
… (label_id: 9)                                          0.52      36.00       1.03         75
-------------------
micro avg                                                1.58       1.58       1.58      19031
macro avg                                               13.74      14.04       1.68      19031
weighted avg                                            88.29       1.58       2.25      19031

-------------------
181.00  0.00  0.00  1.00  4.00  0.00  0.00  0.00  0.00  0.00
2048.00  6.00 37.00  4.00 59.00  0.00  1.00  9.00  0.00 10.00
1435.00 10.00 55.00  0.00 68.00  0.00  0.00  5.00  0.00  1.00
80.00  0.00  3.00  0.00  2.00  0.00  0.00  0.00  0.00  1.00
273.00  1.00 17.00  0.00 26.00  0.00  0.00  8.00  0.00  2.00
2232.00  7.00 48.00  6.00 81.00  0.00  1.00 12.00  0.00  1.00
5515.00 19.00 217.00 10.00 431.00  0.00  2.00 72.00  0.00 30.00
754.00  0.00 13.00  2.00 28.00  0.00  0.00  3.00  0.00  3.00
15.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
4629.00 15.00 142.00  4.00 329.00  0.00  0.00 36.00  0.00 27.00
[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                          0.00       0.00       0.00         80
1 (label_id: 1)                                         50.00     100.00      66.67         80
-------------------
micro avg                                               50.00      50.00      50.00        160
macro avg                                               25.00      50.00      33.33        160
weighted avg                                            25.00      50.00      33.33        160

-------------------
 0.00  0.00
80.00 80.00
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          95.76      96.99      96.37   15595410
! (label_id: 1)                                         20.62      33.51      25.53     132074
, (label_id: 2)                                         36.23      32.82      34.44     481066
- (label_id: 3)                                         35.39      11.59      17.46      44642
. (label_id: 4)                                         46.75      40.61      43.47     922110
: (label_id: 5)                                          0.00       0.00       0.00       2427
; (label_id: 6)                                          0.00       0.00       0.00        951
? (label_id: 7)                                         35.71      35.33      35.52     244079
— (label_id: 8)                                          0.00       0.00       0.00         81
… (label_id: 9)                                          0.00       0.00       0.00      80692
-------------------
micro avg                                               90.23      90.23      90.23   17503532
macro avg                                               27.05      25.08      25.28   17503532
weighted avg                                            89.52      90.23      89.83   17503532

-------------------
15125737.00 27277.00 191637.00 26435.00 313125.00 1788.00 462.00 70019.00 27.00 39497.00
27847.00 44260.00 41574.00 3953.00 74077.00 65.00 54.00 15328.00  8.00 7456.00
113780.00 20070.00 157886.00 3314.00 106258.00 113.00 35.00 20225.00  8.00 14080.00
7777.00 83.00 168.00 5172.00 1025.00 27.00  1.00 119.00  1.00 242.00
254717.00 33525.00 71011.00 2723.00 374479.00 316.00 345.00 52153.00 24.00 11717.00
 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
65552.00 6859.00 18790.00 3045.00 53146.00 118.00 54.00 86235.00 13.00 7700.00
 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                         50.00     100.00      66.67      72939
1 (label_id: 1)                                          0.00       0.00       0.00      72939
-------------------
micro avg                                               50.00      50.00      50.00     145878
macro avg                                               25.00      50.00      33.33     145878
weighted avg                                            25.00      50.00      33.33     145878

-------------------
72939.00 72939.00
 0.00  0.00
[INFO] - Epoch 0, global step 5254: val_loss reached 115.21539 (best 115.21539), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-02-12_19-14-52/checkpoints/Punctuation_with_Domain_discriminator---val_loss=115.22-epoch=0.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          96.94      95.95      96.44   15594360
! (label_id: 1)                                         24.17      34.29      28.35     131487
, (label_id: 2)                                         37.23      37.73      37.48     481266
- (label_id: 3)                                         28.21      25.70      26.90      44079
. (label_id: 4)                                         42.22      54.07      47.41     922224
: (label_id: 5)                                          0.00       0.00       0.00       2409
; (label_id: 6)                                          0.00       0.00       0.00        979
? (label_id: 7)                                         68.33      28.19      39.92     244473
— (label_id: 8)                                          0.00       0.00       0.00         80
… (label_id: 9)                                         21.74      19.09      20.33      80827
-------------------
micro avg                                               90.18      90.18      90.18   17502184
macro avg                                               31.88      29.50      29.68   17502184
weighted avg                                            90.93      90.18      90.39   17502184

-------------------
14962490.00 17786.00 153114.00 18055.00 201695.00 1774.00 332.00 47661.00 15.00 31863.00
17955.00 45084.00 32767.00 2197.00 69259.00 22.00 53.00 14020.00  8.00 5190.00
109565.00 24617.00 181579.00 1899.00 129163.00 60.00 43.00 29063.00  9.00 11679.00
25530.00 182.00 347.00 11329.00 2400.00 39.00  3.00 132.00  1.00 191.00
446731.00 39136.00 98104.00 3537.00 498618.00 463.00 535.00 78504.00 27.00 15484.00
 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
12991.00 2301.00 7030.00 316.00 8301.00 17.00  4.00 68925.00  5.00 988.00
 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
19098.00 2381.00 8325.00 6746.00 12788.00 34.00  9.00 6168.00 15.00 15432.00
[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                         75.40      77.49      76.43      72939
1 (label_id: 1)                                         76.85      74.72      75.77      72939
-------------------
micro avg                                               76.11      76.11      76.11     145878
macro avg                                               76.13      76.11      76.10     145878
weighted avg                                            76.13      76.11      76.10     145878

-------------------
56524.00 18438.00
16415.00 54501.00
[INFO] - Epoch 1, global step 10509: val_loss reached 22.29331 (best 22.29331), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-02-12_19-14-52/checkpoints/Punctuation_with_Domain_discriminator---val_loss=22.29-epoch=1.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          97.37      95.54      96.45   15597741
! (label_id: 1)                                         26.42      30.96      28.51     131817
, (label_id: 2)                                         42.10      32.84      36.90     481164
- (label_id: 3)                                         23.37      34.25      27.79      44240
. (label_id: 4)                                         41.14      65.17      50.44     922389
: (label_id: 5)                                          0.00       0.00       0.00       2305
; (label_id: 6)                                          0.00       0.00       0.00        978
? (label_id: 7)                                         65.90      30.99      42.16     244399
— (label_id: 8)                                          0.00       0.00       0.00         85
… (label_id: 9)                                         35.29      13.04      19.05      80604
-------------------
micro avg                                               90.28      90.28      90.28   17505722
macro avg                                               33.16      30.28      30.13   17505722
weighted avg                                            91.42      90.28      90.57   17505722

-------------------
14902258.00 14322.00 140661.00 15231.00 161865.00 1308.00 294.00 37909.00 12.00 31475.00
15291.00 40806.00 26976.00 1918.00 54217.00 34.00 54.00 10322.00  4.00 4836.00
75146.00 20443.00 158025.00 1326.00 90923.00 37.00 18.00 19692.00  6.00 9759.00
42984.00 618.00 1546.00 15154.00 3313.00 302.00  6.00 392.00  1.00 516.00
537671.00 52833.00 141835.00 5214.00 601078.00 599.00 588.00 99145.00 46.00 21990.00
 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
17390.00 2462.00 8431.00 486.00 8863.00 16.00 16.00 75742.00  8.00 1515.00
 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
7001.00 333.00 3690.00 4911.00 2130.00  9.00  2.00 1197.00  8.00 10513.00
[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                         82.99      74.51      78.52      72939
1 (label_id: 1)                                         76.87      84.72      80.61      72939
-------------------
micro avg                                               79.62      79.62      79.62     145878
macro avg                                               79.93      79.62      79.56     145878
weighted avg                                            79.93      79.62      79.56     145878

-------------------
54348.00 11142.00
18591.00 61797.00
[INFO] - Epoch 2, global step 15764: val_loss reached 13.03634 (best 13.03634), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-02-12_19-14-52/checkpoints/Punctuation_with_Domain_discriminator---val_loss=13.04-epoch=2.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          97.04      95.93      96.48   15593759
! (label_id: 1)                                         26.18      30.27      28.08     131176
, (label_id: 2)                                         37.21      38.66      37.92     481613
- (label_id: 3)                                         26.28      31.16      28.51      44269
. (label_id: 4)                                         43.46      57.00      49.32     922442
: (label_id: 5)                                          0.00       0.00       0.00       2480
; (label_id: 6)                                          0.00       0.00       0.00        986
? (label_id: 7)                                         62.06      34.80      44.59     243336
— (label_id: 8)                                          0.00       0.00       0.00         81
… (label_id: 9)                                         34.95      14.72      20.71      80532
-------------------
micro avg                                               90.40      90.40      90.40   17500674
macro avg                                               32.72      30.25      30.56   17500674
weighted avg                                            91.06      90.40      90.61   17500674

-------------------
14959341.00 16968.00 151956.00 17591.00 191782.00 1556.00 334.00 43138.00 16.00 33463.00
16095.00 39711.00 25446.00 1535.00 54595.00 16.00 47.00 9960.00  4.00 4278.00
119910.00 25693.00 186170.00 1855.00 129885.00 76.00 63.00 25617.00 14.00 10999.00
31612.00 798.00 1312.00 13793.00 3506.00 244.00  7.00 536.00  2.00 673.00
438663.00 44152.00 100518.00 4189.00 525774.00 547.00 517.00 77855.00 28.00 17465.00
 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
22648.00 3172.00 9643.00 565.00 13889.00 33.00 15.00 84680.00 10.00 1803.00
 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
5490.00 682.00 6568.00 4741.00 3011.00  8.00  3.00 1550.00  7.00 11851.00
[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                         58.88      74.19      65.65      72939
1 (label_id: 1)                                         65.11      48.18      55.38      72939
-------------------
micro avg                                               61.18      61.18      61.18     145878
macro avg                                               62.00      61.18      60.52     145878
weighted avg                                            62.00      61.18      60.52     145878

-------------------
54111.00 37796.00
18828.00 35143.00
[INFO] - Epoch 3, global step 21019: val_loss reached 15.18966 (best 13.03634), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-02-12_19-14-52/checkpoints/Punctuation_with_Domain_discriminator---val_loss=15.19-epoch=3.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          98.05      94.34      96.16   15589848
! (label_id: 1)                                         23.17      30.69      26.40     132067
, (label_id: 2)                                         32.70      44.75      37.79     480971
- (label_id: 3)                                         23.63      34.60      28.08      44614
. (label_id: 4)                                         40.91      60.81      48.91     922579
: (label_id: 5)                                          0.00       0.00       0.00       2446
; (label_id: 6)                                          0.00       0.00       0.00        960
? (label_id: 7)                                         58.17      37.93      45.92     244526
— (label_id: 8)                                          0.00       0.00       0.00         69
… (label_id: 9)                                         23.68      20.53      21.99      81023
-------------------
micro avg                                               89.43      89.43      89.43   17499104
macro avg                                               30.03      32.37      30.53   17499104
weighted avg                                            91.57      89.43      90.30   17499104

-------------------
14707316.00 9041.00 101568.00 12781.00 117293.00 1108.00 209.00 24817.00  6.00 25145.00
38842.00 40529.00 23856.00 1966.00 55108.00 28.00 80.00 10252.00  2.00 4269.00
203127.00 32376.00 215253.00 3074.00 157418.00 184.00 77.00 32763.00 14.00 13995.00
43782.00 413.00 936.00 15436.00 3542.00 361.00  4.00 407.00  1.00 448.00
545637.00 44216.00 117425.00 4413.00 561060.00 699.00 560.00 78804.00 30.00 18732.00
 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
31800.00 3685.00 10871.00 538.00 17945.00 38.00 27.00 92754.00  4.00 1803.00
 5.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
19339.00 1807.00 11062.00 6406.00 10213.00 28.00  3.00 4729.00 12.00 16631.00
[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                         71.14      72.42      71.77      72939
1 (label_id: 1)                                         71.91      70.61      71.26      72939
-------------------
micro avg                                               71.52      71.52      71.52     145878
macro avg                                               71.53      71.52      71.52     145878
weighted avg                                            71.53      71.52      71.52     145878

-------------------
52824.00 21434.00
20115.00 51505.00
[INFO] - Epoch 4, global step 26274: val_loss reached 10.95131 (best 10.95131), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-02-12_19-14-52/checkpoints/Punctuation_with_Domain_discriminator---val_loss=10.95-epoch=4.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          91.79      99.56      95.52   15593568
! (label_id: 1)                                         37.06      10.66      16.56     131858
, (label_id: 2)                                         45.37      20.89      28.61     480872
- (label_id: 3)                                         55.97       0.17       0.34      44566
. (label_id: 4)                                         59.86      17.09      26.59     923462
: (label_id: 5)                                          0.00       0.00       0.00       2382
; (label_id: 6)                                          0.00       0.00       0.00       1005
? (label_id: 7)                                         80.43      14.19      24.13     243779
— (label_id: 8)                                          0.00       0.00       0.00         77
… (label_id: 9)                                         40.56      11.27      17.64      80824
-------------------
micro avg                                               90.51      90.51      90.51   17502392
macro avg                                               41.10      17.38      20.94   17502392
weighted avg                                            87.91      90.51      87.83   17502392

-------------------
15525010.00 87224.00 354030.00 38482.00 675089.00 2252.00 862.00 169600.00 58.00 61242.00
1157.00 14059.00 4932.00 372.00 13830.00  2.00  4.00 2357.00  1.00 1224.00
11569.00 15588.00 100440.00 615.00 72381.00  9.00 14.00 15521.00  5.00 5224.00
56.00  1.00  0.00 75.00  1.00  0.00  0.00  0.00  0.00  1.00
51578.00 13575.00 15747.00 771.00 157803.00 113.00 119.00 20412.00  7.00 3515.00
 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
1873.00 993.00 2403.00 184.00 2443.00  3.00  4.00 34595.00  3.00 510.00
 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
2325.00 418.00 3320.00 4067.00 1915.00  3.00  2.00 1294.00  3.00 9108.00
[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                         83.13      35.47      49.73      72939
1 (label_id: 1)                                         58.98      92.80      72.13      72939
-------------------
micro avg                                               64.14      64.14      64.14     145878
macro avg                                               71.06      64.14      60.93     145878
weighted avg                                            71.06      64.14      60.93     145878

-------------------
25873.00 5252.00
47066.00 67687.00
[INFO] - Epoch 5, global step 31529: val_loss reached 11.56726 (best 10.95131), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-02-12_19-14-52/checkpoints/Punctuation_with_Domain_discriminator---val_loss=11.57-epoch=5.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          97.10      96.73      96.91   15594783
! (label_id: 1)                                         26.03      34.01      29.49     130591
, (label_id: 2)                                         36.51      44.31      40.03     481352
- (label_id: 3)                                         28.42      32.41      30.29      44046
. (label_id: 4)                                         49.66      51.07      50.36     921748
: (label_id: 5)                                          0.00       0.00       0.00       2368
; (label_id: 6)                                          0.00       0.00       0.00        969
? (label_id: 7)                                         62.15      39.66      48.42     244359
— (label_id: 8)                                          0.00       0.00       0.00         77
… (label_id: 9)                                         27.15      19.08      22.41      80560
-------------------
micro avg                                               91.08      91.08      91.08   17500852
macro avg                                               32.70      31.73      31.79   17500852
weighted avg                                            91.40      91.08      91.19   17500852

-------------------
15084688.00 15259.00 147298.00 16422.00 197293.00 1535.00 340.00 41006.00 12.00 31565.00
15860.00 44415.00 26169.00 1407.00 66997.00 25.00 42.00 10913.00  1.00 4805.00
140870.00 27725.00 213270.00 2277.00 156344.00 129.00 106.00 30845.00 13.00 12569.00
28941.00 863.00 1674.00 14277.00 3377.00 161.00  2.00 453.00  1.00 482.00
289083.00 36831.00 72507.00 3113.00 470746.00 467.00 451.00 60772.00 31.00 13876.00
 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
 2.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
22093.00 4143.00 10862.00 528.00 19433.00 31.00 23.00 96911.00  9.00 1893.00
 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
13246.00 1355.00 9572.00 6022.00 7558.00 20.00  5.00 3459.00 10.00 15370.00
[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                         81.20      84.83      82.97      72939
1 (label_id: 1)                                         84.12      80.36      82.20      72939
-------------------
micro avg                                               82.59      82.59      82.59     145878
macro avg                                               82.66      82.59      82.58     145878
weighted avg                                            82.66      82.59      82.58     145878

-------------------
61871.00 14324.00
11068.00 58615.00
[INFO] - Epoch 6, global step 36784: val_loss reached 4.74845 (best 4.74845), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-02-12_19-14-52/checkpoints/Punctuation_with_Domain_discriminator---val_loss=4.75-epoch=6.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          97.41      96.28      96.84   15588559
! (label_id: 1)                                         27.28      33.75      30.17     131502
, (label_id: 2)                                         41.37      38.90      40.10     481656
- (label_id: 3)                                         28.61      33.05      30.67      44145
. (label_id: 4)                                         44.95      60.42      51.55     922262
: (label_id: 5)                                          0.00       0.00       0.00       2425
; (label_id: 6)                                          0.00       0.00       0.00        967
? (label_id: 7)                                         64.43      36.88      46.91     244604
— (label_id: 8)                                          0.00       0.00       0.00         55
… (label_id: 9)                                         32.17      17.56      22.72      80592
-------------------
micro avg                                               90.96      90.96      90.96   17496768
macro avg                                               33.62      31.68      31.90   17496768
weighted avg                                            91.62      90.96      91.16   17496768

-------------------
15007911.00 13555.00 140211.00 15922.00 160726.00 1486.00 277.00 36208.00 10.00 30305.00
14660.00 44381.00 25986.00 1612.00 60515.00 20.00 53.00 10649.00  3.00 4792.00
83905.00 24199.00 187365.00 1548.00 121409.00 69.00 46.00 24100.00 10.00 10233.00
29750.00 794.00 1564.00 14592.00 3181.00 109.00  2.00 460.00  1.00 549.00
424767.00 44224.00 108211.00 4465.00 557202.00 701.00 560.00 80545.00 20.00 18891.00
 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
19879.00 3483.00 9949.00 496.00 14274.00 26.00 25.00 90204.00  4.00 1667.00
 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
7687.00 866.00 8370.00 5510.00 4955.00 14.00  4.00 2438.00  7.00 14155.00
[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                         53.81      98.12      69.50      72939
1 (label_id: 1)                                         89.34      15.77      26.80      72939
-------------------
micro avg                                               56.94      56.94      56.94     145878
macro avg                                               71.57      56.94      48.15     145878
weighted avg                                            71.57      56.94      48.15     145878

-------------------
71567.00 61440.00
1372.00 11499.00
[INFO] - Epoch 7, global step 42039: val_loss reached 10.55844 (best 4.74845), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-02-12_19-14-52/checkpoints/Punctuation_with_Domain_discriminator---val_loss=10.56-epoch=7.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          97.07      97.04      97.05   15595430
! (label_id: 1)                                         22.99      42.55      29.85     131969
, (label_id: 2)                                         40.06      40.07      40.06     481215
- (label_id: 3)                                         29.72      30.99      30.34      43898
. (label_id: 4)                                         49.47      50.39      49.93     923479
: (label_id: 5)                                          0.00       0.00       0.00       2496
; (label_id: 6)                                          0.00       0.00       0.00        924
? (label_id: 7)                                         63.43      39.36      48.58     245290
— (label_id: 8)                                          0.00       0.00       0.00         89
… (label_id: 9)                                         28.94      18.33      22.44      81055
-------------------
micro avg                                               91.24      91.24      91.24   17505844
macro avg                                               33.17      31.87      31.83   17505844
weighted avg                                            91.46      91.24      91.28   17505844

-------------------
15133102.00 14587.00 153243.00 17067.00 197324.00 1676.00 306.00 40980.00 10.00 32086.00
24858.00 56147.00 40060.00 2436.00 95997.00 41.00 97.00 17489.00 15.00 7055.00
90755.00 22972.00 192829.00 1638.00 136815.00 80.00 64.00 25504.00 12.00 10702.00
24573.00 724.00 1615.00 13602.00 3707.00 207.00  7.00 610.00  3.00 722.00
290244.00 32918.00 73254.00 3087.00 465317.00 454.00 428.00 61033.00 29.00 13808.00
 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
20353.00 3805.00 11145.00 521.00 17964.00 24.00 19.00 96545.00  7.00 1824.00
 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
11545.00 816.00 9069.00 5547.00 6355.00 14.00  3.00 3129.00 13.00 14858.00
[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                         99.83      22.31      36.47      72939
1 (label_id: 1)                                         56.27      99.96      72.01      72939
-------------------
micro avg                                               61.14      61.14      61.14     145878
macro avg                                               78.05      61.14      54.24     145878
weighted avg                                            78.05      61.14      54.24     145878

-------------------
16271.00 27.00
56668.00 72912.00
[INFO] - Epoch 8, global step 47294: val_loss reached 10.89379 (best 4.74845), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-02-12_19-14-52/checkpoints/Punctuation_with_Domain_discriminator---val_loss=10.89-epoch=8.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          98.22      94.84      96.50   15591410
! (label_id: 1)                                         23.95      40.67      30.15     131931
, (label_id: 2)                                         43.01      35.73      39.03     481727
- (label_id: 3)                                         25.51      36.79      30.13      44198
. (label_id: 4)                                         40.69      66.32      50.44     922501
: (label_id: 5)                                          0.00       0.00       0.00       2371
; (label_id: 6)                                          0.00       0.00       0.00       1036
? (label_id: 7)                                         54.96      43.33      48.46     244078
— (label_id: 8)                                          0.00       0.00       0.00         71
… (label_id: 9)                                         26.00      19.54      22.31      80978
-------------------
micro avg                                               90.07      90.07      90.07   17500300
macro avg                                               31.23      33.72      31.70   17500300
weighted avg                                            91.96      90.07      90.79   17500300

-------------------
14786965.00 7765.00 99954.00 12722.00 102452.00 1242.00 235.00 20446.00  7.00 23814.00
25572.00 53650.00 38795.00 2061.00 83538.00 20.00 95.00 13868.00  8.00 6361.00
90675.00 17493.00 172132.00 1312.00 92736.00 51.00 34.00 17200.00  6.00 8603.00
37820.00 952.00 2095.00 16262.00 4703.00 262.00  9.00 705.00  1.00 949.00
588722.00 46965.00 142518.00 5510.00 611801.00 729.00 631.00 83393.00 34.00 23114.00
 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
42928.00 4227.00 15188.00 648.00 21291.00 43.00 29.00 105763.00  9.00 2312.00
 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
18728.00 879.00 11045.00 5683.00 5980.00 24.00  3.00 2703.00  6.00 15825.00
[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                         51.46      93.49      66.38      72939
1 (label_id: 1)                                         64.46      11.82      19.97      72939
-------------------
micro avg                                               52.65      52.65      52.65     145878
macro avg                                               57.96      52.65      43.18     145878
weighted avg                                            57.96      52.65      43.18     145878

-------------------
68188.00 64321.00
4751.00 8618.00
[INFO] - Epoch 9, step 52549: val_loss was not in top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          98.22      94.83      96.50   15591717
! (label_id: 1)                                         24.08      39.63      29.96     130786
, (label_id: 2)                                         39.10      39.33      39.21     482370
- (label_id: 3)                                         23.57      39.68      29.58      44598
. (label_id: 4)                                         42.09      65.21      51.16     923093
: (label_id: 5)                                          0.00       0.00       0.00       2420
; (label_id: 6)                                          0.00       0.00       0.00        948
? (label_id: 7)                                         59.51      41.49      48.89     244470
— (label_id: 8)                                          0.00       0.00       0.00         81
… (label_id: 9)                                         23.73      21.11      22.34      80366
-------------------
micro avg                                               90.08      90.08      90.08   17500848
macro avg                                               31.03      34.13      31.76   17500848
weighted avg                                            91.99      90.08      90.83   17500848

-------------------
14785707.00 7179.00 98657.00 11323.00 103714.00 1225.00 158.00 21469.00 10.00 23838.00
27076.00 51833.00 37088.00 2082.00 77749.00 26.00 87.00 13401.00  5.00 5937.00
134239.00 19324.00 189708.00 1697.00 109257.00 79.00 56.00 20986.00  7.00 9817.00
48353.00 829.00 2102.00 17698.00 4420.00 342.00  8.00 574.00  1.00 756.00
541104.00 46631.00 129957.00 5125.00 601949.00 696.00 612.00 82816.00 36.00 21160.00
 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
32932.00 3787.00 12230.00 539.00 17582.00 25.00 22.00 101439.00  9.00 1893.00
 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
22306.00 1203.00 12628.00 6134.00 8422.00 27.00  5.00 3785.00 13.00 16965.00
[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                         69.41      80.60      74.59      72939
1 (label_id: 1)                                         76.87      64.48      70.13      72939
-------------------
micro avg                                               72.54      72.54      72.54     145878
macro avg                                               73.14      72.54      72.36     145878
weighted avg                                            73.14      72.54      72.36     145878

-------------------
58792.00 25911.00
14147.00 47028.00
[INFO] - Epoch 10, global step 57804: val_loss reached 1.42583 (best 1.42583), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-02-12_19-14-52/checkpoints/Punctuation_with_Domain_discriminator---val_loss=1.43-epoch=10.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          97.35      96.92      97.14   15594830
! (label_id: 1)                                         25.74      37.59      30.55     131420
, (label_id: 2)                                         40.87      40.88      40.87     481980
- (label_id: 3)                                         33.55      29.31      31.29      44213
. (label_id: 4)                                         50.05      56.15      52.93     923128
: (label_id: 5)                                          0.00       0.00       0.00       2372
; (label_id: 6)                                          0.00       0.00       0.00        961
? (label_id: 7)                                         59.16      43.67      50.25     244547
— (label_id: 8)                                          0.00       0.00       0.00        104
… (label_id: 9)                                         30.28      18.55      23.01      80900
-------------------
micro avg                                               91.49      91.49      91.49   17504456
macro avg                                               33.70      32.31      32.60   17504456
weighted avg                                            91.74      91.49      91.57   17504456

-------------------
15115059.00 12216.00 141023.00 17437.00 173399.00 1666.00 288.00 34646.00 16.00 30361.00
18940.00 49396.00 30708.00 1786.00 73161.00 30.00 71.00 12294.00  5.00 5543.00
99964.00 23294.00 197010.00 1884.00 125870.00 66.00 62.00 23236.00 14.00 10679.00
20270.00 578.00 1102.00 12960.00 2738.00 91.00  3.00 359.00  1.00 525.00
302097.00 40388.00 88944.00 3818.00 518342.00 479.00 503.00 64641.00 39.00 16385.00
 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
28403.00 4694.00 13696.00 682.00 23771.00 29.00 31.00 106791.00 16.00 2399.00
 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
10097.00 854.00 9497.00 5646.00 5847.00 11.00  3.00 2580.00 13.00 15008.00
[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                         41.85      29.38      34.53      72939
1 (label_id: 1)                                         45.59      59.17      51.50      72939
-------------------
micro avg                                               44.28      44.28      44.28     145878
macro avg                                               43.72      44.28      43.01     145878
weighted avg                                            43.72      44.28      43.01     145878

-------------------
21432.00 29781.00
51507.00 43158.00
[INFO] - Epoch 11, global step 63059: val_loss reached 2.41300 (best 1.42583), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-02-12_19-14-52/checkpoints/Punctuation_with_Domain_discriminator---val_loss=2.41-epoch=11.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          97.07      97.32      97.19   15591873
! (label_id: 1)                                         26.18      38.00      31.00     131789
, (label_id: 2)                                         42.82      39.03      40.84     481674
- (label_id: 3)                                         32.45      30.83      31.62      44417
. (label_id: 4)                                         51.81      53.46      52.62     923721
: (label_id: 5)                                          0.00       0.00       0.00       2422
; (label_id: 6)                                          0.00       0.00       0.00       1006
? (label_id: 7)                                         57.38      45.38      50.68     243807
— (label_id: 8)                                          0.00       0.00       0.00         61
… (label_id: 9)                                         29.65      19.02      23.18      80523
-------------------
micro avg                                               91.68      91.68      91.68   17501292
macro avg                                               33.74      32.30      32.71   17501292
weighted avg                                            91.61      91.68      91.62   17501292

-------------------
15173509.00 14387.00 154434.00 17388.00 199049.00 1721.00 381.00 38658.00 13.00 31666.00
17137.00 50083.00 30642.00 1569.00 74329.00 20.00 56.00 12095.00  4.00 5344.00
79851.00 21766.00 188006.00 1675.00 117410.00 58.00 68.00 20739.00  5.00 9469.00
22355.00 678.00 1373.00 13693.00 3044.00 105.00  2.00 411.00  0.00 541.00
260179.00 38582.00 81747.00 3604.00 493808.00 458.00 458.00 58609.00 27.00 15591.00
 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
29082.00 5211.00 14735.00 714.00 29776.00 37.00 36.00 110642.00  6.00 2593.00
 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
9760.00 1082.00 10737.00 5774.00 6305.00 23.00  5.00 2653.00  6.00 15319.00
[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                         86.91      21.94      35.03      72939
1 (label_id: 1)                                         55.33      96.70      70.39      72939
-------------------
micro avg                                               59.32      59.32      59.32     145878
macro avg                                               71.12      59.32      52.71     145878
weighted avg                                            71.12      59.32      52.71     145878

-------------------
16000.00 2409.00
56939.00 70530.00
[INFO] - Epoch 12, global step 68314: val_loss reached 1.46759 (best 1.42583), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-02-12_19-14-52/checkpoints/Punctuation_with_Domain_discriminator---val_loss=1.47-epoch=12.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          97.34      97.00      97.17   15591908
! (label_id: 1)                                         25.47      39.27      30.90     130685
, (label_id: 2)                                         42.33      39.47      40.85     481540
- (label_id: 3)                                         31.44      33.03      32.21      44397
. (label_id: 4)                                         50.34      55.64      52.86     922617
: (label_id: 5)                                          0.00       0.00       0.00       2534
; (label_id: 6)                                          0.00       0.00       0.00        930
? (label_id: 7)                                         57.08      45.35      50.54     243862
— (label_id: 8)                                          0.00       0.00       0.00         65
… (label_id: 9)                                         29.46      18.87      23.00      80856
-------------------
micro avg                                               91.54      91.54      91.54   17499394
macro avg                                               33.35      32.86      32.75   17499394
weighted avg                                            91.75      91.54      91.61   17499394

-------------------
15123679.00 12214.00 143310.00 16008.00 175119.00 1727.00 304.00 34081.00 14.00 30410.00
19346.00 51319.00 31852.00 1697.00 78658.00 25.00 57.00 12781.00  4.00 5720.00
85662.00 21875.00 190061.00 1723.00 118315.00 75.00 72.00 21412.00  5.00 9816.00
25730.00 646.00 1407.00 14664.00 3050.00 126.00  3.00 428.00  0.00 594.00
295302.00 38618.00 89306.00 3824.00 513363.00 517.00 469.00 61994.00 24.00 16457.00
 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
31992.00 4982.00 14835.00 735.00 27929.00 40.00 24.00 110587.00 10.00 2603.00
 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
10197.00 1031.00 10769.00 5746.00 6183.00 24.00  1.00 2579.00  8.00 15256.00
[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                         71.94       2.45       4.73      72939
1 (label_id: 1)                                         50.38      99.05      66.79      72939
-------------------
micro avg                                               50.75      50.75      50.75     145878
macro avg                                               61.16      50.75      35.76     145878
weighted avg                                            61.16      50.75      35.76     145878

-------------------
1784.00 696.00
71155.00 72243.00
[INFO] - Epoch 13, step 73569: val_loss was not in top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          97.09      97.36      97.22   15597226
! (label_id: 1)                                         25.63      39.75      31.16     132590
, (label_id: 2)                                         42.62      39.40      40.95     481644
- (label_id: 3)                                         34.03      30.76      32.31      44322
. (label_id: 4)                                         51.84      53.45      52.63     923257
: (label_id: 5)                                          0.00       0.00       0.00       2342
; (label_id: 6)                                          0.00       0.00       0.00        985
? (label_id: 7)                                         60.32      43.10      50.28     244099
— (label_id: 8)                                          0.00       0.00       0.00         88
… (label_id: 9)                                         30.58      19.02      23.45      80482
-------------------
micro avg                                               91.71      91.71      91.71   17507036
macro avg                                               34.21      32.28      32.80   17507036
weighted avg                                            91.67      91.71      91.65   17507036

-------------------
15184971.00 14014.00 154132.00 17469.00 196410.00 1641.00 357.00 39030.00 16.00 31639.00
18872.00 52702.00 31873.00 1745.00 81378.00 29.00 62.00 13343.00  9.00 5620.00
78356.00 22507.00 189766.00 1729.00 120592.00 64.00 67.00 22358.00  9.00 9828.00
21010.00 555.00 1210.00 13634.00 2673.00 86.00  3.00 371.00  3.00 525.00
258970.00 37317.00 81280.00 3439.00 493464.00 478.00 465.00 61116.00 29.00 15341.00
 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
25956.00 4505.00 13012.00 614.00 22839.00 26.00 27.00 105203.00 10.00 2219.00
 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
9091.00 990.00 10371.00 5692.00 5901.00 18.00  4.00 2678.00 12.00 15310.00
[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                         63.84       1.68       3.27      72939
1 (label_id: 1)                                         50.18      99.05      66.62      72939
-------------------
micro avg                                               50.36      50.36      50.36     145878
macro avg                                               57.01      50.36      34.94     145878
weighted avg                                            57.01      50.36      34.94     145878

-------------------
1225.00 694.00
71714.00 72245.00
[INFO] - Epoch 14, step 78824: val_loss was not in top 3
[INFO] - Saving latest checkpoint...
[INFO] - Optimizer config = AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 1e-05
    weight_decay: 0.0
)
[INFO] - Scheduler "<core.optim.lr_scheduler.CosineAnnealing object at 0x7f986558b6a0>" 
will be used during training (effective maximum steps = 78825) - 
Parameters : 
(warmup_steps: null
warmup_ratio: 0.1
min_lr: 1.0e-10
last_epoch: -1
max_steps: 78825
)
[INFO] - 
  | Name                | Type                 | Params
-------------------------------------------------------------
0 | transformer         | ElectraModel         | 108 M 
1 | punct_classifier    | TokenClassifier      | 7.7 K 
2 | domain_classifier   | SequenceClassifier   | 3.1 K 
3 | punctuation_loss    | FocalDiceLoss        | 0     
4 | domain_loss         | CrossEntropyLoss     | 0     
5 | agg_loss            | AggregatorLoss       | 0     
6 | punct_class_report  | ClassificationReport | 0     
7 | domain_class_report | ClassificationReport | 0     
-------------------------------------------------------------
7.1 M     Trainable params
101 M     Non-trainable params
108 M     Total params
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          96.71      97.78      97.24      17162
! (label_id: 1)                                         16.79      37.93      23.28         58
, (label_id: 2)                                         48.28      34.21      40.04        532
- (label_id: 3)                                         27.42      62.96      38.20         27
. (label_id: 4)                                         58.51      54.86      56.63       1028
: (label_id: 5)                                          0.00       0.00       0.00          0
; (label_id: 6)                                          0.00       0.00       0.00          4
? (label_id: 7)                                         67.29      49.66      57.14        145
— (label_id: 8)                                          0.00       0.00       0.00          0
… (label_id: 9)                                         48.72      25.33      33.33         75
-------------------
micro avg                                               92.78      92.78      92.78      19031
macro avg                                               45.46      45.34      43.23      19031
weighted avg                                            92.52      92.78      92.56      19031

-------------------
16781.00 13.00 226.00 10.00 266.00  0.00  1.00 24.00  0.00 30.00
18.00 22.00 18.00  0.00 68.00  0.00  0.00  3.00  0.00  2.00
60.00  6.00 182.00  0.00 110.00  0.00  0.00 12.00  0.00  7.00
40.00  0.00  2.00 17.00  2.00  0.00  0.00  0.00  0.00  1.00
242.00 16.00 90.00  0.00 564.00  0.00  3.00 33.00  0.00 16.00
 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
17.00  1.00  6.00  0.00 11.00  0.00  0.00 72.00  0.00  0.00
 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
 4.00  0.00  8.00  0.00  7.00  0.00  0.00  1.00  0.00 19.00
[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                         50.00       1.25       2.44         80
1 (label_id: 1)                                         50.00      98.75      66.39         80
-------------------
micro avg                                               50.00      50.00      50.00        160
macro avg                                               50.00      50.00      34.41        160
weighted avg                                            50.00      50.00      34.41        160

-------------------
 1.00  1.00
79.00 79.00
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          97.39      97.17      97.28   15595410
! (label_id: 1)                                         28.19      34.91      31.19     132074
, (label_id: 2)                                         41.36      43.02      42.17     481066
- (label_id: 3)                                         33.96      33.33      33.64      44642
. (label_id: 4)                                         52.15      56.35      54.17     922110
: (label_id: 5)                                          0.00       0.00       0.00       2427
; (label_id: 6)                                          0.00       0.00       0.00        951
? (label_id: 7)                                         60.50      47.70      53.34     244079
— (label_id: 8)                                          0.00       0.00       0.00         81
… (label_id: 9)                                         31.48      18.31      23.15      80692
-------------------
micro avg                                               91.82      91.82      91.82   17503532
macro avg                                               34.50      33.08      33.49   17503532
weighted avg                                            91.94      91.82      91.86   17503532

-------------------
15153604.00 13605.00 143075.00 16589.00 167391.00 1700.00 303.00 33023.00 15.00 30861.00
12592.00 46106.00 24459.00 1227.00 64687.00 23.00 49.00 9648.00  5.00 4766.00
89886.00 26855.00 206948.00 2016.00 138223.00 80.00 78.00 24988.00  9.00 11297.00
22160.00 907.00 1680.00 14879.00 3008.00 91.00  3.00 449.00  2.00 638.00
279142.00 38770.00 81261.00 3511.00 519575.00 468.00 483.00 57239.00 31.00 15764.00
 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
29800.00 5008.00 13998.00 771.00 23761.00 33.00 32.00 116430.00 11.00 2595.00
 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
8226.00 823.00 9645.00 5649.00 5465.00 32.00  3.00 2302.00  8.00 14771.00
[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                          5.26       0.45       0.82      72939
1 (label_id: 1)                                         48.02      91.96      63.09      72939
-------------------
micro avg                                               46.20      46.20      46.20     145878
macro avg                                               26.64      46.20      31.96     145878
weighted avg                                            26.64      46.20      31.96     145878

-------------------
326.00 5866.00
72613.00 67073.00
[INFO] - Epoch 0, step 84079: val_loss was not in top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          97.92      95.26      96.57   15594360
! (label_id: 1)                                         17.91      35.19      23.74     131487
, (label_id: 2)                                         28.65      42.70      34.29     481266
- (label_id: 3)                                         14.54      30.94      19.78      44079
. (label_id: 4)                                         55.51      53.23      54.34     922224
: (label_id: 5)                                          0.00       0.00       0.00       2409
; (label_id: 6)                                          0.00       0.00       0.00        979
? (label_id: 7)                                         43.61      54.75      48.55     244473
— (label_id: 8)                                          0.00       0.00       0.00         80
… (label_id: 9)                                         20.27      17.51      18.79      80827
-------------------
micro avg                                               90.05      90.05      90.05   17502184
macro avg                                               27.84      32.96      29.61   17502184
weighted avg                                            91.83      90.05      90.85   17502184

-------------------
14855928.00 10170.00 111950.00 14205.00 130062.00 1066.00 295.00 22796.00  7.00 25164.00
82603.00 46272.00 34372.00 2186.00 76741.00 25.00 33.00 10866.00 15.00 5191.00
273561.00 30550.00 205493.00 3107.00 157176.00 296.00 66.00 31834.00  8.00 15231.00
70375.00 707.00 2806.00 13640.00 4828.00 314.00  8.00 610.00  1.00 535.00
205048.00 33726.00 94648.00 3428.00 490863.00 482.00 529.00 39792.00 25.00 15784.00
 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
84788.00 8065.00 23551.00 1335.00 50355.00 186.00 28.00 133843.00 14.00 4769.00
 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
22057.00 1997.00 8446.00 6178.00 12199.00 40.00 20.00 4732.00 10.00 14153.00
[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                          7.53       7.44       7.49      72939
1 (label_id: 1)                                          8.60       8.71       8.66      72939
-------------------
micro avg                                                8.08       8.08       8.08     145878
macro avg                                                8.07       8.08       8.07     145878
weighted avg                                             8.07       8.08       8.07     145878

-------------------
5425.00 66584.00
67514.00 6355.00
[INFO] - Epoch 1, step 89334: val_loss was not in top 3
                     67.52      64.69      66.08     922389
: (label_id: 5)                                         92.37      36.75      52.58       2305
; (label_id: 6)                                          0.00       0.00       0.00        978
? (label_id: 7)                                         68.69      63.73      66.12     244399
— (label_id: 8)                                          0.00       0.00       0.00         85
… (label_id: 9)                                         27.52      23.50      25.35      80604
-------------------
micro avg                                               93.89      93.89      93.89   17505722
macro avg                                               48.11      43.97      44.55   17505722
weighted avg                                            94.35      93.89      94.08   17505722

-------------------
15298322.00 4673.00 64320.00 10071.00 71003.00 564.00 200.00 16255.00  6.00 20530.00
14786.00 63450.00 31790.00 1407.00 84046.00 29.00 48.00 11254.00  8.00 5944.00
112986.00 18924.00 281518.00 2658.00 131486.00 274.00 132.00 20680.00 11.00 15612.00
15426.00 660.00 1435.00 20503.00 2214.00 98.00  7.00 390.00  2.00 1773.00
120182.00 37391.00 73297.00 3752.00 596722.00 416.00 549.00 36360.00 29.00 15042.00
59.00  0.00  4.00  7.00  0.00 847.00  0.00  0.00  0.00  0.00
 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
21798.00 5194.00 14541.00 744.00 25888.00 26.00 29.00 155764.00 14.00 2765.00
 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
14182.00 1525.00 14259.00 5098.00 11030.00 51.00 13.00 3696.00 15.00 18938.00
[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                         96.78      91.45      94.04      72939
1 (label_id: 1)                                         91.89      96.96      94.36      72939
-------------------
micro avg                                               94.20      94.20      94.20     145878
macro avg                                               94.34      94.20      94.20     145878
weighted avg                                            94.34      94.20      94.20     145878

-------------------
66701.00 2218.00
6238.00 70721.00
[INFO] - Epoch 2, global step 94589: val_loss reached 0.09552 (best 0.09403), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-02-11_12-45-53/checkpoints/Punctuation_with_Domain_discriminator---val_loss=0.10-epoch=2.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          98.83      98.14      98.48   15593759
! (label_id: 1)                                         30.27      47.67      37.03     131176
, (label_id: 2)                                         48.68      59.73      53.64     481613
- (label_id: 3)                                         50.15      46.57      48.29      44269
. (label_id: 4)                                         68.32      65.12      66.68     922442
: (label_id: 5)                                         93.77      38.23      54.31       2480
; (label_id: 6)                                          0.00       0.00       0.00        986
? (label_id: 7)                                         69.01      64.77      66.83     243336
— (label_id: 8)                                          0.00       0.00       0.00         81
… (label_id: 9)                                         27.92      23.88      25.74      80532
-------------------
micro avg                                               94.01      94.01      94.01   17500674
macro avg                                               48.69      44.41      45.10   17500674
weighted avg                                            94.46      94.01      94.20   17500674

-------------------
15303085.00 4770.00 61451.00 9982.00 68400.00 605.00 238.00 15734.00  8.00 20290.00
14036.00 62538.00 30156.00 1383.00 81967.00 25.00 43.00 10712.00  5.00 5744.00
112463.00 19206.00 287673.00 2758.00 131998.00 307.00 142.00 20471.00 11.00 15960.00
14428.00 571.00 1263.00 20614.00 2002.00 91.00  3.00 351.00  4.00 1780.00
114746.00 37274.00 72307.00 3730.00 600666.00 420.00 520.00 34742.00 27.00 14704.00
33.00  0.00 20.00 10.00  0.00 948.00  0.00  0.00  0.00  0.00
 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
21334.00 5195.00 14445.00 742.00 26155.00 29.00 28.00 157616.00 13.00 2823.00
 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
13634.00 1622.00 14298.00 5050.00 11254.00 55.00 12.00 3710.00 13.00 19231.00
[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                         96.43      91.93      94.13      72939
1 (label_id: 1)                                         92.29      96.59      94.39      72939
-------------------
micro avg                                               94.26      94.26      94.26     145878
macro avg                                               94.36      94.26      94.26     145878
weighted avg                                            94.36      94.26      94.26     145878

-------------------
67056.00 2486.00
5883.00 70453.00
[INFO] - Epoch 3, global step 99844: val_loss reached 0.08798 (best 0.08798), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-02-11_12-45-53/checkpoints/Punctuation_with_Domain_discriminator---val_loss=0.09-epoch=3.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          98.86      98.16      98.51   15589848
! (label_id: 1)                                         30.75      48.52      37.65     132067
, (label_id: 2)                                         49.25      60.06      54.12     480971
- (label_id: 3)                                         51.22      47.23      49.15      44614
. (label_id: 4)                                         68.64      65.71      67.14     922579
: (label_id: 5)                                         86.91      43.99      58.41       2446
; (label_id: 6)                                          0.00       0.00       0.00        960
? (label_id: 7)                                         69.69      65.06      67.30     244526
— (label_id: 8)                                          0.00       0.00       0.00         69
… (label_id: 9)                                         27.90      24.39      26.03      81023
-------------------
micro avg                                               94.08      94.08      94.08   17499104
macro avg                                               48.32      45.31      45.83   17499104
weighted avg                                            94.53      94.08      94.27   17499104

-------------------
15303627.00 4606.00 58844.00 9743.00 66384.00 437.00 193.00 15429.00  4.00 20117.00
14128.00 64084.00 30432.00 1460.00 81802.00 31.00 47.00 10749.00  5.00 5632.00
110447.00 18570.00 288887.00 2805.00 129310.00 303.00 135.00 20102.00 13.00 16042.00
14074.00 498.00 1231.00 21071.00 1905.00 74.00  6.00 335.00  2.00 1940.00
112204.00 37458.00 72958.00 3677.00 606246.00 448.00 531.00 34854.00 23.00 14806.00
37.00  0.00 102.00 20.00  2.00 1076.00  0.00  0.00  0.00  1.00
 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
21189.00 5122.00 14037.00 763.00 25308.00 30.00 35.00 159098.00  7.00 2721.00
 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
14142.00 1729.00 14480.00 5075.00 11622.00 47.00 13.00 3959.00 15.00 19764.00
[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                         96.39      92.17      94.23      72939
1 (label_id: 1)                                         92.50      96.55      94.48      72939
-------------------
micro avg                                               94.36      94.36      94.36     145878
macro avg                                               94.45      94.36      94.36     145878
weighted avg                                            94.45      94.36      94.36     145878

-------------------
67230.00 2517.00
5709.00 70422.00
[INFO] - Epoch 4, global step 105099: val_loss reached 0.07594 (best 0.07594), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-02-11_12-45-53/checkpoints/Punctuation_with_Domain_discriminator---val_loss=0.08-epoch=4.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          98.89      98.19      98.54   15593568
! (label_id: 1)                                         30.76      48.77      37.72     131858
, (label_id: 2)                                         49.62      60.58      54.55     480872
- (label_id: 3)                                         51.19      47.49      49.27      44566
. (label_id: 4)                                         69.00      65.91      67.42     923462
: (label_id: 5)                                         92.00      44.42      59.91       2382
; (label_id: 6)                                          0.00       0.00       0.00       1005
? (label_id: 7)                                         69.79      65.36      67.50     243779
— (label_id: 8)                                          0.00       0.00       0.00         77
… (label_id: 9)                                         27.99      24.33      26.03      80824
-------------------
micro avg                                               94.14      94.14      94.14   17502392
macro avg                                               48.92      45.51      46.10   17502392
weighted avg                                            94.59      94.14      94.33   17502392

-------------------
15311796.00 4537.00 56907.00 9548.00 64422.00 408.00 225.00 15186.00  9.00 19934.00
13944.00 64302.00 30021.00 1375.00 82795.00 22.00 45.00 10657.00  4.00 5907.00
109404.00 18757.00 291308.00 2874.00 128459.00 281.00 139.00 20059.00 13.00 15802.00
14082.00 552.00 1263.00 21166.00 1936.00 80.00  6.00 363.00  2.00 1896.00
110100.00 36853.00 72578.00 3699.00 608661.00 450.00 550.00 34334.00 30.00 14919.00
34.00  0.00 41.00 13.00  3.00 1058.00  0.00  0.00  0.00  1.00
 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
20522.00 5150.00 14226.00 783.00 25533.00 35.00 26.00 159334.00 12.00 2698.00
 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
13686.00 1707.00 14528.00 5108.00 11653.00 48.00 14.00 3846.00  7.00 19667.00
[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                         96.51      92.42      94.42      72939
1 (label_id: 1)                                         92.73      96.66      94.65      72939
-------------------
micro avg                                               94.54      94.54      94.54     145878
macro avg                                               94.62      94.54      94.53     145878
weighted avg                                            94.62      94.54      94.53     145878

-------------------
67408.00 2438.00
5531.00 70501.00
[INFO] - Epoch 5, global step 110354: val_loss reached 0.07319 (best 0.07319), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-02-11_12-45-53/checkpoints/Punctuation_with_Domain_discriminator---val_loss=0.07-epoch=5.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          98.91      98.22      98.57   15594783
! (label_id: 1)                                         30.76      48.51      37.65     130591
, (label_id: 2)                                         49.92      61.25      55.01     481352
- (label_id: 3)                                         51.90      48.17      49.97      44046
. (label_id: 4)                                         69.42      66.02      67.68     921748
: (label_id: 5)                                         87.88      45.31      59.79       2368
; (label_id: 6)                                          0.00       0.00       0.00        969
? (label_id: 7)                                         70.27      65.67      67.89     244359
— (label_id: 8)                                          0.00       0.00       0.00         77
… (label_id: 9)                                         28.02      24.71      26.26      80560
-------------------
micro avg                                               94.21      94.21      94.21   17500852
macro avg                                               48.71      45.79      46.28   17500852
weighted avg                                            94.65      94.21      94.39   17500852

-------------------
15317660.00 4380.00 55955.00 9354.00 63318.00 398.00 190.00 15031.00  5.00 19747.00
13987.00 63353.00 29483.00 1344.00 81640.00 24.00 40.00 10358.00  3.00 5736.00
108617.00 18715.00 294849.00 2685.00 129060.00 253.00 128.00 20353.00  7.00 15992.00
13603.00 502.00 1330.00 21217.00 1937.00 74.00  5.00 364.00  2.00 1847.00
106703.00 36774.00 71574.00 3623.00 608548.00 448.00 568.00 33784.00 35.00 14622.00
59.00  0.00 66.00 21.00  1.00 1073.00  0.00  0.00  0.00  1.00
 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
20223.00 5137.00 13689.00 736.00 25328.00 39.00 27.00 160469.00 13.00 2709.00
 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
13931.00 1730.00 14406.00 5066.00 11916.00 59.00 11.00 4000.00 12.00 19906.00
[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                         96.67      92.36      94.47      72939
1 (label_id: 1)                                         92.69      96.82      94.71      72939
-------------------
micro avg                                               94.59      94.59      94.59     145878
macro avg                                               94.68      94.59      94.59     145878
weighted avg                                            94.68      94.59      94.59     145878

-------------------
67368.00 2322.00
5571.00 70617.00
[INFO] - Epoch 6, global step 115609: val_loss reached 0.07592 (best 0.07319), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-02-11_12-45-53/checkpoints/Punctuation_with_Domain_discriminator---val_loss=0.08-epoch=6.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          98.90      98.27      98.58   15588559
! (label_id: 1)                                         31.29      48.45      38.02     131502
, (label_id: 2)                                         50.48      60.93      55.21     481656
- (label_id: 3)                                         51.77      48.60      50.14      44145
. (label_id: 4)                                         69.51      66.44      67.94     922262
: (label_id: 5)                                         86.75      45.36      59.57       2425
; (label_id: 6)                                          0.00       0.00       0.00        967
? (label_id: 7)                                         70.23      65.94      68.02     244604
— (label_id: 8)                                          0.00       0.00       0.00         55
… (label_id: 9)                                         28.76      24.48      26.45      80592
-------------------
micro avg                                               94.26      94.26      94.26   17496768
macro avg                                               48.77      45.85      46.39   17496768
weighted avg                                            94.66      94.26      94.42   17496768

-------------------
15318406.00 4602.00 56883.00 9374.00 64498.00 401.00 203.00 15140.00  5.00 19749.00
13652.00 63710.00 28641.00 1301.00 80418.00 26.00 45.00 10137.00  8.00 5700.00
104301.00 18679.00 293467.00 2719.00 125746.00 288.00 127.00 19964.00  7.00 16056.00
13980.00 503.00 1241.00 21456.00 1878.00 62.00  1.00 389.00  4.00 1928.00
105129.00 37133.00 73203.00 3651.00 612782.00 453.00 551.00 33916.00 13.00 14709.00
88.00  0.00 62.00 16.00  1.00 1100.00  0.00  0.00  0.00  1.00
 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
19908.00 5220.00 14193.00 714.00 25537.00 35.00 30.00 161293.00  9.00 2720.00
 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
13095.00 1655.00 13966.00 4914.00 11402.00 60.00 10.00 3765.00  9.00 19729.00
[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                         96.67      92.47      94.52      72939
1 (label_id: 1)                                         92.79      96.81      94.76      72939
-------------------
micro avg                                               94.64      94.64      94.64     145878
macro avg                                               94.73      94.64      94.64     145878
weighted avg                                            94.73      94.64      94.64     145878

-------------------
67449.00 2324.00
5490.00 70615.00
[INFO] - Epoch 7, global step 120864: val_loss reached 0.07287 (best 0.07287), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-02-11_12-45-53/checkpoints/Punctuation_with_Domain_discriminator---val_loss=0.07-epoch=7.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          98.91      98.29      98.60   15595430
! (label_id: 1)                                         31.51      47.61      37.93     131969
, (label_id: 2)                                         50.55      61.10      55.33     481215
- (label_id: 3)                                         52.20      48.19      50.11      43898
. (label_id: 4)                                         69.77      66.68      68.19     923479
: (label_id: 5)                                         80.38      52.04      63.18       2496
; (label_id: 6)                                          0.00       0.00       0.00        924
? (label_id: 7)                                         70.41      66.11      68.20     245290
— (label_id: 8)                                          0.00       0.00       0.00         89
… (label_id: 9)                                         28.21      24.68      26.33      81055
-------------------
micro avg                                               94.29      94.29      94.29   17505844
macro avg                                               48.19      46.47      46.79   17505844
weighted avg                                            94.68      94.29      94.46   17505844

-------------------
15329501.00 4701.00 56277.00 9384.00 63640.00 351.00 180.00 14908.00  3.00 19960.00
13215.00 62837.00 28301.00 1275.00 78245.00 22.00 40.00 9797.00 12.00 5650.00
103006.00 19029.00 294003.00 2717.00 126463.00 245.00 114.00 19981.00 12.00 16015.00
13280.00 519.00 1343.00 21154.00 1871.00 51.00  5.00 380.00  4.00 1920.00
102505.00 37849.00 72926.00 3614.00 615774.00 439.00 545.00 34140.00 27.00 14769.00
128.00  0.00 154.00 28.00  5.00 1299.00  0.00  0.00  0.00  2.00
 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
19993.00 5204.00 13919.00 738.00 25482.00 31.00 22.00 162167.00 15.00 2734.00
 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
13802.00 1830.00 14292.00 4988.00 11999.00 58.00 18.00 3917.00 16.00 20005.00
[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                         96.84      92.67      94.71      72939
1 (label_id: 1)                                         92.97      96.97      94.93      72939
-------------------
micro avg                                               94.82      94.82      94.82     145878
macro avg                                               94.90      94.82      94.82     145878
weighted avg                                            94.90      94.82      94.82     145878

-------------------
67593.00 2209.00
5346.00 70730.00
[INFO] - Epoch 8, global step 126119: val_loss reached 0.06787 (best 0.06787), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-02-11_12-45-53/checkpoints/Punctuation_with_Domain_discriminator---val_loss=0.07-epoch=8.ckpt" as top 3
