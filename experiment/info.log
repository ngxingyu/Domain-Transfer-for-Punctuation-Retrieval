[INFO] - Global seed set to 42
[INFO] - GPU available: True, used: True
[INFO] - TPU available: None, using: 0 TPU cores
[INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [2]
[INFO] - Using native 16bit precision.
[INFO] - shuffling train set
[INFO] - Global seed set to 42
[INFO] - initializing ddp: GLOBAL_RANK: 0, MEMBER: 1/1
[INFO] - Optimizer config = AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.01
    weight_decay: 0.0
)
[INFO] - Scheduler "<core.optim.lr_scheduler.CosineAnnealing object at 0x7f48ac0b0fd0>" 
will be used during training (effective maximum steps = 400) - 
Parameters : 
(warmup_steps: null
warmup_ratio: 0.1
min_lr: 1.0e-08
last_epoch: -1
max_steps: 400
)
[INFO] - 
  | Name                       | Type                 | Params
--------------------------------------------------------------------
0 | transformer                | ElectraModel         | 108 M 
1 | punct_classifier           | TokenClassifier      | 1.2 M 
2 | domain_classifier          | SequenceClassifier   | 1.5 K 
3 | punctuation_loss           | FocalDiceLoss        | 0     
4 | domain_loss                | CrossEntropyLoss     | 0     
5 | agg_loss                   | AggregatorLoss       | 0     
6 | punct_class_report         | ClassificationReport | 0     
7 | chunked_punct_class_report | ClassificationReport | 0     
8 | domain_class_report        | ClassificationReport | 0     
--------------------------------------------------------------------
1.2 M     Trainable params
108 M     Non-trainable params
110 M     Total params
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          87.42      10.15      18.19      16566
# (label_id: 1)                                          6.17       9.74       7.56       1458
, (label_id: 2)                                          5.31      35.87       9.25       1210
. (label_id: 3)                                          1.53       0.99       1.20       1008
? (label_id: 4)                                          0.49      43.90       0.98         82
-------------------
micro avg                                               11.34      11.34      11.34      20324
macro avg                                               20.19      20.13       7.44      20324
weighted avg                                            72.09      11.34      15.99      20324

-------------------
                       #           ,           .           ?
     1682.00        24.00       110.00       102.00         6.00
     1868.00       142.00       168.00       106.00        16.00
     6616.00       726.00       434.00       370.00        24.00
      506.00       128.00         8.00        10.00         0.00
     5894.00       438.00       490.00       420.00        36.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                          0.00       0.00       0.00          0
1 (label_id: 1)                                        100.00      98.85      99.42        174
-------------------
micro avg                                               98.85      98.85      98.85        174
macro avg                                               50.00      49.43      49.71        174
weighted avg                                           100.00      98.85      99.42        174

-------------------
           0           1
        0.00         2.00
        0.00       172.00
-------------------

[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          98.61      89.37      93.76     279905
# (label_id: 1)                                         86.13      97.13      91.30      28888
, (label_id: 2)                                         40.13      77.53      52.88      24187
. (label_id: 3)                                         58.01      62.79      60.31      18071
? (label_id: 4)                                          0.00       0.00       0.00       1490
-------------------
micro avg                                               87.45      87.45      87.45     352541
macro avg                                               56.58      65.36      59.65     352541
weighted avg                                            91.08      87.45      88.65     352541

-------------------
                       #           ,           .           ?
   250151.00       479.00      2572.00       422.00        50.00
     4468.00     28058.00        42.00         9.00         0.00
    21103.00        59.00     18751.00      6293.00       524.00
     4183.00       292.00      2822.00     11347.00       916.00
        0.00         0.00         0.00         0.00         0.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                          0.00       0.00       0.00          0
1 (label_id: 1)                                        100.00     100.00     100.00       2968
-------------------
micro avg                                              100.00     100.00     100.00       2968
macro avg                                               50.00      50.00      50.00       2968
weighted avg                                           100.00     100.00     100.00       2968

-------------------
           0           1
        0.00         0.00
        0.00      2968.00
-------------------

[INFO] - Epoch 0, global step 49: val_loss reached 0.64140 (best 0.64140), saving model to "/home/nxingyu/project/Punctuation_with_Domain_discriminator/2021-03-01_16-57-32/checkpoints/Punctuation_with_Domain_discriminator---val_loss=0.64-epoch=0.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          98.45      91.52      94.86     279905
# (label_id: 1)                                         83.23      98.17      90.08      28888
, (label_id: 2)                                         49.48      59.41      53.99      24187
. (label_id: 3)                                         51.46      83.24      63.61      18071
? (label_id: 4)                                         47.06       0.54       1.06       1490
-------------------
micro avg                                               89.05      89.05      89.05     352541
macro avg                                               65.94      66.57      60.72     352541
weighted avg                                            91.22      89.05      89.67     352541

-------------------
                       #           ,           .           ?
   256159.00       336.00      3352.00       298.00        35.00
     5591.00     28359.00        85.00        40.00         0.00
    11765.00        34.00     14369.00      2689.00       182.00
     6382.00       159.00      6381.00     15043.00      1265.00
        8.00         0.00         0.00         1.00         8.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                          0.00       0.00       0.00          0
1 (label_id: 1)                                        100.00     100.00     100.00       2968
-------------------
micro avg                                              100.00     100.00     100.00       2968
macro avg                                               50.00      50.00      50.00       2968
weighted avg                                           100.00     100.00     100.00       2968

-------------------
           0           1
        0.00         0.00
        0.00      2968.00
-------------------

[INFO] - Epoch 1, global step 99: val_loss reached 0.63818 (best 0.63818), saving model to "/home/nxingyu/project/Punctuation_with_Domain_discriminator/2021-03-01_16-57-32/checkpoints/Punctuation_with_Domain_discriminator---val_loss=0.64-epoch=1.ckpt" as top 3
