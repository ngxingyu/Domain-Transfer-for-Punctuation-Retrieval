[INFO] - GPU available: True, used: True
[INFO] - TPU available: None, using: 0 TPU cores
[INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
[INFO] - Using native 16bit precision.
[INFO] - shuffling train set
[INFO] - initializing ddp: GLOBAL_RANK: 0, MEMBER: 1/1
[INFO] - Optimizer config = AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.02
    weight_decay: 0.0
)
[INFO] - Scheduler "<core.optim.lr_scheduler.CosineAnnealing object at 0x7f8622566e80>" 
will be used during training (effective maximum steps = 3750) - 
Parameters : 
(warmup_steps: null
warmup_ratio: 0.1
min_lr: 1.0e-08
last_epoch: -1
max_steps: 3750
)
[INFO] - 
  | Name                       | Type                 | Params
--------------------------------------------------------------------
0 | transformer                | ElectraModel         | 108 M 
1 | punct_classifier           | TokenClassifier      | 6.9 K 
2 | domain_classifier          | SequenceClassifier   | 4.7 M 
3 | punctuation_loss           | LinearChainCRF       | 99    
4 | domain_loss                | CrossEntropyLoss     | 0     
5 | agg_loss                   | AggregatorLoss       | 0     
6 | punct_class_report         | ClassificationReport | 0     
7 | chunked_punct_class_report | ClassificationReport | 0     
8 | domain_class_report        | ClassificationReport | 0     
--------------------------------------------------------------------
4.7 M     Trainable params
108 M     Non-trainable params
113 M     Total params
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          55.42       0.10       0.20      89602
! (label_id: 1)                                          1.48       1.63       1.55        858
# (label_id: 2)                                         18.33       6.47       9.57      17576
, (label_id: 3)                                          3.20       1.88       2.37       7660
- (label_id: 4)                                          0.58       6.34       1.06        662
. (label_id: 5)                                          6.14      31.53      10.28      14950
: (label_id: 6)                                          0.00       0.00       0.00         10
? (label_id: 7)                                          1.68       1.42       1.54       2672
— (label_id: 8)                                          0.00       0.00       0.00          0
-------------------
micro avg                                                4.61       4.61       4.61     133990
macro avg                                               10.85       6.17       3.32     133990
weighted avg                                            40.38       4.61       2.72     133990

-------------------
                       !           #           ,           -           .           :           ?           —
       92.00         2.00        30.00         4.00         0.00        32.00         0.00         6.00         0.00
      550.00        14.00       112.00        70.00        10.00       172.00         0.00        20.00         0.00
     3552.00        58.00      1138.00       580.00        34.00       746.00         0.00       100.00         0.00
     3062.00        32.00       712.00       144.00        28.00       434.00         0.00        84.00         0.00
     3834.00        84.00       926.00       710.00        42.00      1384.00         0.00       280.00         0.00
    61182.00       188.00      7050.00      2474.00       194.00      4714.00         2.00       982.00         0.00
     1376.00         0.00      5720.00         4.00         2.00        32.00         0.00         2.00         0.00
     1064.00        66.00       286.00       348.00        70.00       384.00         0.00        38.00         0.00
    14890.00       414.00      1602.00      3326.00       282.00      7052.00         8.00      1160.00         0.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00     100.00     100.00       1072
-------------------
micro avg                                              100.00     100.00     100.00       1072
macro avg                                              100.00     100.00     100.00       1072
weighted avg                                           100.00     100.00     100.00       1072

-------------------
           0
     1072.00
-------------------

[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          95.66      97.53      96.59   32695556
! (label_id: 1)                                         46.72       0.80       1.57     594128
# (label_id: 2)                                         99.22      99.11      99.16    6532600
, (label_id: 3)                                         53.46      37.16      43.84    2688848
- (label_id: 4)                                         47.86      26.80      34.36     260520
. (label_id: 5)                                         60.75      78.33      68.43    5279872
: (label_id: 6)                                         75.05      38.90      51.24      14048
? (label_id: 7)                                         70.44      36.34      47.95    1306712
— (label_id: 8)                                          0.00       0.00       0.00         16
-------------------
micro avg                                               89.22      89.22      89.22   49372300
macro avg                                               61.02      46.11      49.24   49372300
weighted avg                                            88.59      89.22      88.27   49372300

-------------------
                       !           #           ,           -           .           :           ?           —
 31887728.00     40504.00     50096.00    551448.00    107368.00    558784.00      3416.00    134016.00         0.00
      496.00      4736.00         0.00      1240.00        40.00      3208.00         0.00       416.00         0.00
    41624.00       640.00   6474232.00      1728.00      2288.00      3824.00        40.00       520.00         0.00
   165912.00    112616.00       656.00    999112.00     14488.00    481320.00       608.00     94144.00         0.00
    46512.00      1880.00       480.00      6544.00     69808.00     19784.00       104.00       760.00         0.00
   503720.00    417608.00      6144.00   1076392.00     61456.00   4135944.00      4368.00    601960.00        16.00
      448.00         0.00         8.00       880.00       160.00       320.00      5464.00         0.00         0.00
    49048.00     16144.00       984.00     51504.00      4912.00     76688.00        48.00    474896.00         0.00
        0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00     100.00     100.00     393864
-------------------
micro avg                                              100.00     100.00     100.00     393864
macro avg                                              100.00     100.00     100.00     393864
weighted avg                                           100.00     100.00     100.00     393864

-------------------
           0
   393864.00
-------------------

[INFO] - Epoch 0, global step 624: val_loss reached 39.13414 (best 39.13414), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-02-21_15-37-04/checkpoints/Punctuation_with_Domain_discriminator---val_loss=39.13-epoch=0.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          95.69      97.59      96.63   32695556
! (label_id: 1)                                         49.22       0.85       1.67     594128
# (label_id: 2)                                         99.36      99.24      99.30    6532600
, (label_id: 3)                                         53.14      37.83      44.20    2688848
- (label_id: 4)                                         46.01      28.17      34.94     260520
. (label_id: 5)                                         61.05      78.02      68.50    5279872
: (label_id: 6)                                         72.72      42.20      53.41      14048
? (label_id: 7)                                         71.20      36.27      48.05    1306712
— (label_id: 8)                                          0.00       0.00       0.00         16
-------------------
micro avg                                               89.29      89.29      89.29   49372300
macro avg                                               60.93      46.68      49.63   49372300
weighted avg                                            88.68      89.29      88.35   49372300

-------------------
                       !           #           ,           -           .           :           ?           —
 31906840.00     39872.00     42424.00    551472.00    105208.00    560232.00      3056.00    133912.00         0.00
      480.00      5040.00         0.00      1248.00        32.00      3128.00         0.00       312.00         0.00
    32624.00       624.00   6482832.00      1800.00      2184.00      3680.00        48.00       544.00         0.00
   167432.00    118496.00       624.00   1017288.00     14344.00    497248.00       600.00     98264.00         0.00
    48600.00      3232.00       544.00     10168.00     73384.00     22304.00       136.00      1144.00         0.00
   491656.00    411104.00      5392.00   1056296.00     60656.00   4119144.00      4232.00    598624.00        16.00
      608.00         0.00         0.00       936.00       264.00       400.00      5928.00        16.00         0.00
    47296.00     15760.00       784.00     49640.00      4448.00     73736.00        48.00    473896.00         0.00
        0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00     100.00     100.00     393864
-------------------
micro avg                                              100.00     100.00     100.00     393864
macro avg                                              100.00     100.00     100.00     393864
weighted avg                                           100.00     100.00     100.00     393864

-------------------
           0
   393864.00
-------------------

[INFO] - Epoch 1, global step 1249: val_loss reached 38.60223 (best 38.60223), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-02-21_15-37-04/checkpoints/Punctuation_with_Domain_discriminator---val_loss=38.60-epoch=1.ckpt" as top 3
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    [INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          97.62      99.16      98.38   32597898
! (label_id: 1)                                         54.65       9.25      15.83     249790
# (label_id: 2)                                         98.98      92.63      95.70    2657770
, (label_id: 3)                                         63.36      54.46      58.58    1092581
- (label_id: 4)                                         55.67      44.63      49.54     101638
. (label_id: 5)                                         72.09      75.28      73.65    2193139
: (label_id: 6)                                         88.28      60.72      71.95       6848
? (label_id: 7)                                         76.07      67.94      71.78     547390
— (label_id: 8)                                          0.00       0.00       0.00        354
-------------------
micro avg                                               95.00      95.00      95.00   39447408
macro avg                                               67.41      56.01      59.49   39447408
weighted avg                                            94.66      95.00      94.70   39447408

-------------------
                       !           #           ,           -           .           :           ?           —
 32324414.00     17139.00    195052.00    212940.00     33520.00    282195.00      1162.00     47331.00        32.00
     1630.00     23117.00        10.00      4917.00       283.00     11176.00         1.00      1167.00         0.00
    24763.00        51.00   2461773.00       126.00       122.00       293.00         2.00        47.00         1.00
    88501.00     37724.00       188.00    595017.00      4616.00    183715.00       286.00     28976.00        27.00
    17851.00      1340.00        14.00      2999.00     45358.00     12974.00        95.00       833.00        12.00
   117633.00    158480.00       610.00    248319.00     15662.00   1650906.00      1098.00     97125.00       206.00
      154.00         7.00         0.00       111.00       116.00       155.00      4158.00         9.00         0.00
    22972.00     11932.00       123.00     28152.00      1961.00     51725.00        46.00    371902.00        76.00
        0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                         99.08      87.58      92.97     158827
1 (label_id: 1)                                         88.87      99.19      93.74     158827
-------------------
micro avg                                               93.38      93.38      93.38     317654
macro avg                                               93.97      93.38      93.36     317654
weighted avg                                            93.97      93.38      93.36     317654

-------------------
           0           1
   139098.00      1294.00
    19729.00    157533.00
-------------------

[INFO] - Epoch 1, global step 4999: val_loss reached 18.97545 (best 18.97545), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-02-20_22-21-25/checkpoints/Punctuation_with_Domain_discriminator---val_loss=18.98-epoch=1.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          97.63      99.18      98.40   32604048
! (label_id: 1)                                         52.97      12.27      19.92     247810
# (label_id: 2)                                         99.04      92.66      95.74    2654572
, (label_id: 3)                                         62.91      56.68      59.63    1091194
- (label_id: 4)                                         58.06      44.15      50.16     101035
. (label_id: 5)                                         73.30      74.39      73.84    2196152
: (label_id: 6)                                         87.81      57.30      69.34       6585
? (label_id: 7)                                         76.27      69.09      72.50     545024
— (label_id: 8)                                          0.00       0.00       0.00        326
-------------------
micro avg                                               95.07      95.07      95.07   39446748
macro avg                                               67.55      56.19      59.95   39446748
weighted avg                                            94.73      95.07      94.80   39446748

-------------------
                       !           #           ,           -           .           :           ?           —
 32335532.00     17308.00    193752.00    207430.00     31980.00    285644.00      1227.00     45961.00        21.00
     2098.00     30396.00        22.00      6503.00       441.00     16082.00         9.00      1831.00         3.00
    23273.00        47.00   2459766.00       122.00       112.00       270.00         0.00        68.00         0.00
    93735.00     38362.00       228.00    618513.00      5226.00    196668.00       340.00     30152.00        21.00
    18509.00      1039.00        12.00      2329.00     44609.00      9670.00        84.00       558.00        20.00
   109156.00    148686.00       690.00    228599.00     16669.00   1633776.00      1088.00     89888.00       189.00
      128.00         3.00         0.00       136.00       112.00       140.00      3773.00         5.00         0.00
    21590.00     11969.00       102.00     27562.00      1886.00     53902.00        64.00    376561.00        72.00
        0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                         99.18      87.08      92.74     158827
1 (label_id: 1)                                         88.49      99.28      93.58     158827
-------------------
micro avg                                               93.18      93.18      93.18     317654
macro avg                                               93.84      93.18      93.16     317654
weighted avg                                            93.84      93.18      93.16     317654

-------------------
           0           1
   138314.00      1137.00
    20513.00    157690.00
-------------------

[INFO] - Epoch 2, global step 5624: val_loss reached 18.89849 (best 18.89849), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-02-20_22-21-25/checkpoints/Punctuation_with_Domain_discriminator---val_loss=18.90-epoch=2.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          97.82      99.16      98.49   32600588
! (label_id: 1)                                         54.08      12.31      20.05     250346
# (label_id: 2)                                         98.93      93.62      96.20    2655305
, (label_id: 3)                                         60.33      61.30      60.81    1091409
- (label_id: 4)                                         61.37      42.81      50.43     101727
. (label_id: 5)                                         74.72      73.55      74.13    2194529
: (label_id: 6)                                         91.55      60.05      72.53       6804
? (label_id: 7)                                         77.73      69.22      73.23     545464
— (label_id: 8)                                          0.00       0.00       0.00        294
-------------------
micro avg                                               95.20      95.20      95.20   39446468
macro avg                                               68.50      56.89      60.65   39446468
weighted avg                                            94.92      95.20      94.96   39446468

-------------------
                       !           #           ,           -           .           :           ?           —
 32327616.00     15660.00    168579.00    193547.00     32248.00    265632.00      1117.00     42172.00        18.00
     1938.00     30812.00        18.00      5371.00       427.00     16440.00        10.00      1959.00         5.00
    26057.00        53.00   2485974.00       153.00       133.00       333.00         0.00        87.00         0.00
   107013.00     48488.00       191.00    668992.00      6078.00    241162.00       390.00     36458.00        25.00
    16238.00       805.00        13.00      1800.00     43546.00      8008.00        90.00       455.00         3.00
   100675.00    142883.00       433.00    196758.00     17347.00   1614009.00      1055.00     86758.00       179.00
      116.00         2.00         0.00        66.00        81.00       110.00      4086.00         2.00         0.00
    20910.00     11643.00        97.00     24722.00      1867.00     48835.00        56.00    377573.00        64.00
        0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                         99.00      88.74      93.59     158827
1 (label_id: 1)                                         89.80      99.10      94.22     158827
-------------------
micro avg                                               93.92      93.92      93.92     317654
macro avg                                               94.40      93.92      93.91     317654
weighted avg                                            94.40      93.92      93.91     317654

-------------------
           0           1
   140944.00      1424.00
    17883.00    157403.00
-------------------

[INFO] - Epoch 3, global step 6249: val_loss reached 18.10233 (best 18.10233), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-02-20_22-21-25/checkpoints/Punctuation_with_Domain_discriminator---val_loss=18.10-epoch=3.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          98.03      99.13      98.58   32604730
! (label_id: 1)                                         42.49      27.37      33.29     248124
# (label_id: 2)                                         98.69      94.81      96.71    2653528
, (label_id: 3)                                         62.01      60.83      61.41    1090510
- (label_id: 4)                                         61.24      44.75      51.71     101381
. (label_id: 5)                                         75.37      73.57      74.46    2196142
: (label_id: 6)                                         91.43      60.91      73.11       6757
? (label_id: 7)                                         78.98      68.59      73.42     547175
— (label_id: 8)                                          0.00       0.00       0.00        318
-------------------
micro avg                                               95.34      95.34      95.34   39448664
macro avg                                               67.58      58.89      62.52   39448664
weighted avg                                            95.10      95.34      95.19   39448664

-------------------
                       !           #           ,           -           .           :           ?           —
 32321456.00     14229.00    136908.00    182055.00     30079.00    244636.00      1074.00     41973.00        25.00
     6719.00     67912.00        36.00     20837.00      1173.00     57297.00        11.00      5855.00         6.00
    32561.00        57.00   2515797.00       163.00       116.00       383.00         1.00        78.00         0.00
   105519.00     36501.00       210.00    663322.00      5633.00    223830.00       329.00     34342.00        30.00
    16639.00       785.00        14.00      2162.00     45371.00      8532.00        81.00       498.00         8.00
   103126.00    118283.00       480.00    198563.00     17197.00   1615693.00      1098.00     89097.00       185.00
      124.00         0.00         0.00        66.00       105.00        88.00      4116.00         3.00         0.00
    18579.00     10357.00        83.00     23342.00      1707.00     45683.00        47.00    375329.00        64.00
        0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                         98.72      90.65      94.51     158827
1 (label_id: 1)                                         91.36      98.82      94.94     158827
-------------------
micro avg                                               94.73      94.73      94.73     317654
macro avg                                               95.04      94.73      94.73     317654
weighted avg                                            95.04      94.73      94.73     317654

-------------------
           0           1
   143975.00      1874.00
    14852.00    156953.00
-------------------

[INFO] - Epoch 4, global step 6874: val_loss reached 17.37220 (best 17.37220), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-02-20_22-21-25/checkpoints/Punctuation_with_Domain_discriminator---val_loss=17.37-epoch=4.ckpt" as top 3
