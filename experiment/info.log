[INFO] - Global seed set to 42
[INFO] - GPU available: True, used: True
[INFO] - TPU available: None, using: 0 TPU cores
[INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
[INFO] - Using native 16bit precision.
[INFO] - shuffling train set
[INFO] - Global seed set to 42
[INFO] - initializing ddp: GLOBAL_RANK: 0, MEMBER: 1/1
[INFO] - Optimizer config = AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.01
    weight_decay: 0.0
)
[INFO] - Scheduler "<core.optim.lr_scheduler.CosineAnnealing object at 0x7f7d32e0e250>" 
will be used during training (effective maximum steps = 79575) - 
Parameters : 
(warmup_steps: null
warmup_ratio: 0.1
min_lr: 1.0e-10
last_epoch: -1
max_steps: 79575
)
[INFO] - 
  | Name                | Type                 | Params
-------------------------------------------------------------
0 | transformer         | ElectraModel         | 13.5 M
1 | punct_classifier    | TokenClassifier      | 2.6 K 
2 | domain_classifier   | SequenceClassifier   | 513   
3 | punctuation_loss    | FocalDiceLoss        | 0     
4 | domain_loss         | CrossEntropyLoss     | 0     
5 | agg_loss            | AggregatorLoss       | 0     
6 | punct_class_report  | ClassificationReport | 0     
7 | domain_class_report | ClassificationReport | 0     
-------------------------------------------------------------
299 K     Trainable params
13.2 M    Non-trainable params
13.5 M    Total params
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          83.45      19.10      31.09       6072
! (label_id: 1)                                          0.00       0.00       0.00         48
, (label_id: 2)                                          5.25      30.51       8.96        472
- (label_id: 3)                                          1.52      50.00       2.95         28
. (label_id: 4)                                          4.38       1.16       1.83       1036
: (label_id: 5)                                          0.00       0.00       0.00          0
; (label_id: 6)                                          0.00       0.00       0.00          0
? (label_id: 7)                                          1.61      19.10       2.98        178
— (label_id: 8)                                          0.00       0.00       0.00          0
… (label_id: 9)                                          0.98       5.26       1.65         38
-------------------
micro avg                                               17.35      17.35      17.35       7872
macro avg                                               13.89      17.88       7.07       7872
weighted avg                                            65.31      17.35      24.85       7872

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00     100.00     100.00         74
-------------------
micro avg                                              100.00     100.00     100.00         74
macro avg                                              100.00     100.00     100.00         74
weighted avg                                           100.00     100.00     100.00         74

[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          95.80      93.08      94.42   11636630
! (label_id: 1)                                         18.72      51.70      27.49     255832
, (label_id: 2)                                         40.04      39.95      40.00     943878
- (label_id: 3)                                         38.76      32.68      35.46      88054
. (label_id: 4)                                         54.70      48.39      51.35    1815054
: (label_id: 5)                                         94.10      38.08      54.22       4270
; (label_id: 6)                                          0.00       0.00       0.00       1864
? (label_id: 7)                                         41.60      52.62      46.46     480728
— (label_id: 8)                                          0.00       0.00       0.00        308
… (label_id: 9)                                         20.95      18.53      19.67     155956
-------------------
micro avg                                               81.47      81.47      81.47   15382574
macro avg                                               40.47      37.50      36.91   15382574
weighted avg                                            83.45      81.47      82.27   15382574

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00     100.00     100.00     143540
-------------------
micro avg                                              100.00     100.00     100.00     143540
macro avg                                              100.00     100.00     100.00     143540
weighted avg                                           100.00     100.00     100.00     143540

[INFO] - Epoch 0, global step 5304: val_loss reached -0.01349 (best -0.01349), saving model to "/kaggle/working/ASR/Punctuation_with_Domain_discriminator/2021-02-10_04-39-17/checkpoints/Punctuation_with_Domain_discriminator---val_loss=-0.01-epoch=0.ckpt" as top 3
[INFO] - Saving latest checkpoint...
[INFO] - Epoch 1, global step 8723: val_loss reached -0.01349 (best -0.01349), saving model to "/kaggle/working/ASR/Punctuation_with_Domain_discriminator/2021-02-10_04-39-17/checkpoints/Punctuation_with_Domain_discriminator---val_loss=-0.01-epoch=1.ckpt" as top 3
[INFO] - Internal process exited
