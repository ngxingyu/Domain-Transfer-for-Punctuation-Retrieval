[INFO] - GPU available: True, used: False
[INFO] - TPU available: None, using: 0 TPU cores
[INFO] - shuffling train set
[INFO] - shuffling train set
[INFO] - Optimizer config = Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.001
    weight_decay: 0.0
)
[INFO] - Scheduler "<core.optim.lr_scheduler.WarmupAnnealing object at 0x7f3999fd0310>" 
will be used during training (effective maximum steps = 300) - 
Parameters : 
(warmup_steps: null
warmup_ratio: 0.1
last_epoch: -1
max_steps: 300
)
[INFO] - 
  | Name                | Type                 | Params
-------------------------------------------------------------
0 | transformer         | ElectraModel         | 108 M 
1 | punct_classifier    | TokenClassifier      | 7.7 K 
2 | domain_classifier   | SequenceClassifier   | 769   
3 | punctuation_loss    | LinearChainCRF       | 120   
4 | domain_loss         | CrossEntropyLoss     | 0     
5 | agg_loss            | AggregatorLoss       | 0     
6 | punct_class_report  | ClassificationReport | 0     
7 | domain_class_report | ClassificationReport | 0     
-------------------------------------------------------------
7.1 M     Trainable params
101 M     Non-trainable params
108 M     Total params
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          93.95      21.74      35.31       1357
! (label_id: 1)                                          0.00       0.00       0.00          2
, (label_id: 2)                                          7.89       2.73       4.05        110
- (label_id: 3)                                          0.00       0.00       0.00         16
. (label_id: 4)                                         10.00       4.88       6.56         82
: (label_id: 5)                                          0.00       0.00       0.00          3
; (label_id: 6)                                          0.00       0.00       0.00          0
? (label_id: 7)                                          0.48     100.00       0.95          4
— (label_id: 8)                                          0.00       0.00       0.00          0
… (label_id: 9)                                          0.00       0.00       0.00          0
-------------------
micro avg                                               19.44      19.44      19.44       1574
macro avg                                               16.05      18.48       6.70       1574
weighted avg                                            82.07      19.44      31.07       1574

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00     100.00     100.00         15
-------------------
micro avg                                              100.00     100.00     100.00         15
macro avg                                              100.00     100.00     100.00         15
weighted avg                                           100.00     100.00     100.00         15

[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                         100.00       3.36       6.50     186412
! (label_id: 1)                                          0.00       0.00       0.00        127
, (label_id: 2)                                          7.33      86.03      13.51      12422
- (label_id: 3)                                          2.93      87.13       5.67       1158
. (label_id: 4)                                         40.21      88.65      55.33      10466
: (label_id: 5)                                         30.81      18.51      23.12        308
; (label_id: 6)                                          0.00       0.00       0.00        111
? (label_id: 7)                                         26.11      76.64      38.95        856
— (label_id: 8)                                         12.50       1.31       2.36        383
… (label_id: 9)                                          0.00       0.00       0.00         78
-------------------
micro avg                                               13.17      13.17      13.17     212321
macro avg                                               21.99      36.16      14.54     212321
weighted avg                                            90.40      13.17       9.45     212321

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00     100.00     100.00       1853
-------------------
micro avg                                              100.00     100.00     100.00       1853
macro avg                                              100.00     100.00     100.00       1853
weighted avg                                           100.00     100.00     100.00       1853

[INFO] - Epoch 0, global step 99: val_loss reached 5.06416 (best 5.06416), saving model to "/home/nxingyu2/project/experiment/nemo_experiments/Punctuation_with_Domain_discriminator/2021-02-04_09-56-46/checkpoints/Punctuation_with_Domain_discriminator---val_loss=5.06-epoch=0.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                         100.00       3.26       6.31     183497
! (label_id: 1)                                          0.00       0.00       0.00        115
, (label_id: 2)                                          8.31      90.56      15.22      12368
- (label_id: 3)                                          1.94      88.22       3.79       1104
. (label_id: 4)                                         55.20      83.90      66.59      10284
: (label_id: 5)                                         21.54      29.45      24.88        275
; (label_id: 6)                                          0.00       0.00       0.00        124
? (label_id: 7)                                         33.81      74.97      46.61        815
— (label_id: 8)                                          7.87       3.65       4.98        384
… (label_id: 9)                                          0.00       0.00       0.00         60
-------------------
micro avg                                               13.15      13.15      13.15     209026
macro avg                                               22.87      37.40      16.84     209026
weighted avg                                            91.18      13.15       9.96     209026

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00     100.00     100.00       1823
-------------------
micro avg                                              100.00     100.00     100.00       1823
macro avg                                              100.00     100.00     100.00       1823
weighted avg                                           100.00     100.00     100.00       1823

[INFO] - Epoch 1, global step 199: val_loss reached 3.09216 (best 3.09216), saving model to "/home/nxingyu2/project/experiment/nemo_experiments/Punctuation_with_Domain_discriminator/2021-02-04_09-56-46/checkpoints/Punctuation_with_Domain_discriminator---val_loss=3.09-epoch=1.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          99.98       3.33       6.45     189236
! (label_id: 1)                                          9.76       2.99       4.57        134
, (label_id: 2)                                          8.17      88.33      14.95      12878
- (label_id: 3)                                          2.08      85.89       4.06       1127
. (label_id: 4)                                         45.50      87.76      59.93      10560
: (label_id: 5)                                         19.38      36.33      25.28        311
; (label_id: 6)                                          0.00       0.00       0.00        134
? (label_id: 7)                                         30.00      76.69      43.12        871
— (label_id: 8)                                          7.34       6.40       6.84        406
… (label_id: 9)                                          0.00       0.00       0.00         72
-------------------
micro avg                                               13.31      13.31      13.31     215729
macro avg                                               22.22      38.77      16.52     215729
weighted avg                                            90.60      13.31       9.73     215729

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00     100.00     100.00       1864
-------------------
micro avg                                              100.00     100.00     100.00       1864
macro avg                                              100.00     100.00     100.00       1864
weighted avg                                           100.00     100.00     100.00       1864

[INFO] - Epoch 2, global step 299: val_loss reached 2.72379 (best 2.72379), saving model to "/home/nxingyu2/project/experiment/nemo_experiments/Punctuation_with_Domain_discriminator/2021-02-04_09-56-46/checkpoints/Punctuation_with_Domain_discriminator---val_loss=2.72-epoch=2.ckpt" as top 3
[INFO] - Saving latest checkpoint...
[INFO] - GPU available: True, used: False
[INFO] - TPU available: None, using: 0 TPU cores
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          99.99       3.39       6.56     206673
! (label_id: 1)                                          4.76       2.11       2.92         95
, (label_id: 2)                                          7.95      88.46      14.59      13844
- (label_id: 3)                                          2.32      91.41       4.53       1234
. (label_id: 4)                                         45.50      85.95      59.50      12010
: (label_id: 5)                                         12.23      25.41      16.51        244
; (label_id: 6)                                          0.00       0.00       0.00         77
? (label_id: 7)                                         29.30      79.10      42.76        952
— (label_id: 8)                                         12.27       8.96      10.35        603
… (label_id: 9)                                          0.00       0.00       0.00         66
-------------------
micro avg                                               13.39      13.39      13.39     235798
macro avg                                               21.43      38.48      15.77     235798
weighted avg                                            90.60      13.39       9.88     235798

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00     100.00     100.00       2041
-------------------
micro avg                                              100.00     100.00     100.00       2041
macro avg                                              100.00     100.00     100.00       2041
weighted avg                                           100.00     100.00     100.00       2041

[INFO] - Internal process exited
