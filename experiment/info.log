[INFO] - GPU available: True, used: False
[INFO] - TPU available: None, using: 0 TPU cores
[INFO] - shuffling train set
[INFO] - Optimizer config = AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.001
    weight_decay: 0.0
)
[INFO] - Scheduler "<core.optim.lr_scheduler.WarmupAnnealing object at 0x7f6fe04809a0>" 
will be used during training (effective maximum steps = 60) - 
Parameters : 
(warmup_steps: null
warmup_ratio: 0.1
last_epoch: -1
max_steps: 60
)
[INFO] - 
  | Name                | Type                 | Params
-------------------------------------------------------------
0 | transformer         | ElectraModel         | 13.5 M
1 | punct_classifier    | TokenClassifier      | 2.6 K 
2 | domain_classifier   | SequenceClassifier   | 257   
3 | punctuation_loss    | LinearChainCRF       | 120   
4 | domain_loss         | CrossEntropyLoss     | 0     
5 | agg_loss            | AggregatorLoss       | 0     
6 | punct_class_report  | ClassificationReport | 0     
7 | domain_class_report | ClassificationReport | 0     
-------------------------------------------------------------
36.0 K    Trainable params
13.4 M    Non-trainable params
13.5 M    Total params
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                           0.00       0.00       0.00        208
! (label_id: 1)                                          0.00       0.00       0.00         13
, (label_id: 2)                                         47.49      35.70      40.76        689
- (label_id: 3)                                          9.43      25.86      13.82         58
. (label_id: 4)                                         29.17       1.22       2.35        572
: (label_id: 5)                                          0.00       0.00       0.00         10
; (label_id: 6)                                          0.00       0.00       0.00          6
? (label_id: 7)                                          3.01      43.48       5.63         46
— (label_id: 8)                                          0.00       0.00       0.00         35
… (label_id: 9)                                          0.00       0.00       0.00          4
-------------------
micro avg                                               17.55      17.55      17.55       1641
macro avg                                                8.91      10.63       6.26       1641
weighted avg                                            30.52      17.55      18.58       1641

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00     100.00     100.00         78
-------------------
micro avg                                              100.00     100.00     100.00         78
macro avg                                              100.00     100.00     100.00         78
weighted avg                                           100.00     100.00     100.00         78

[INFO] - Restored states from the checkpoint file at /home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-02-05_14-11-35/lr_find_temp_model.ckpt
[INFO] - Optimizer config = AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.005011872336272719
    weight_decay: 0.0
)
[INFO] - Scheduler "<core.optim.lr_scheduler.WarmupAnnealing object at 0x7f6fea043e20>" 
will be used during training (effective maximum steps = 200) - 
Parameters : 
(warmup_steps: null
warmup_ratio: 0.1
last_epoch: -1
max_steps: 200
)
[INFO] - 
  | Name                | Type                 | Params
-------------------------------------------------------------
0 | transformer         | ElectraModel         | 13.5 M
1 | punct_classifier    | TokenClassifier      | 2.6 K 
2 | domain_classifier   | SequenceClassifier   | 257   
3 | punctuation_loss    | LinearChainCRF       | 120   
4 | domain_loss         | CrossEntropyLoss     | 0     
5 | agg_loss            | AggregatorLoss       | 0     
6 | punct_class_report  | ClassificationReport | 0     
7 | domain_class_report | ClassificationReport | 0     
-------------------------------------------------------------
36.0 K    Trainable params
13.4 M    Non-trainable params
13.5 M    Total params
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          14.53      14.53      14.53        172
! (label_id: 1)                                          0.00       0.00       0.00          2
, (label_id: 2)                                         42.29      31.42      36.06        541
- (label_id: 3)                                          6.06       9.68       7.45         62
. (label_id: 4)                                         37.59      10.50      16.42        476
: (label_id: 5)                                          0.00       0.00       0.00         15
; (label_id: 6)                                          0.00       0.00       0.00         13
? (label_id: 7)                                          7.49      35.79      12.39         95
— (label_id: 8)                                          0.00       0.00       0.00         16
… (label_id: 9)                                          0.00       0.00       0.00          1
-------------------
micro avg                                               20.46      20.46      20.46       1393
macro avg                                               10.80      10.19       8.68       1393
weighted avg                                            31.84      20.46      22.58       1393

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00     100.00     100.00         86
-------------------
micro avg                                              100.00     100.00     100.00         86
macro avg                                              100.00     100.00     100.00         86
weighted avg                                           100.00     100.00     100.00         86

[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          81.80      50.49      62.44       4290
! (label_id: 1)                                          0.00       0.00       0.00        143
, (label_id: 2)                                         45.34      81.27      58.21      14594
- (label_id: 3)                                          4.87       9.47       6.43       1236
. (label_id: 4)                                         38.62      10.52      16.53      12066
: (label_id: 5)                                          0.00       0.00       0.00        354
; (label_id: 6)                                          0.00       0.00       0.00        176
? (label_id: 7)                                          0.00       0.00       0.00       1093
— (label_id: 8)                                          0.00       0.00       0.00        464
… (label_id: 9)                                          0.00       0.00       0.00         84
-------------------
micro avg                                               44.68      44.68      44.68      34500
macro avg                                               17.06      15.17      14.36      34500
weighted avg                                            43.03      44.68      38.40      34500

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00     100.00     100.00       2145
-------------------
micro avg                                              100.00     100.00     100.00       2145
macro avg                                              100.00     100.00     100.00       2145
weighted avg                                           100.00     100.00     100.00       2145

[INFO] - Epoch 1, global step 100: val_loss reached 4.50218 (best 4.50218), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-02-05_14-11-35/checkpoints/Punctuation_with_Domain_discriminator---val_loss=4.50-epoch=1.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          91.63      50.07      64.76       4242
! (label_id: 1)                                          0.00       0.00       0.00        138
, (label_id: 2)                                         45.24      77.75      57.20      14458
- (label_id: 3)                                          5.37      12.72       7.55       1266
. (label_id: 4)                                         38.30      12.28      18.59      11964
: (label_id: 5)                                          0.00       0.00       0.00        346
; (label_id: 6)                                          0.00       0.00       0.00        143
? (label_id: 7)                                          9.88       1.48       2.58       1080
— (label_id: 8)                                          0.00       0.00       0.00        447
… (label_id: 9)                                          0.00       0.00       0.00         84
-------------------
micro avg                                               43.93      43.93      43.93      34168
macro avg                                               19.04      15.43      15.07      34168
weighted avg                                            44.44      43.93      39.11      34168

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00     100.00     100.00       2121
-------------------
micro avg                                              100.00     100.00     100.00       2121
macro avg                                              100.00     100.00     100.00       2121
weighted avg                                           100.00     100.00     100.00       2121

[INFO] - Epoch 2, global step 200: val_loss reached -7.95181 (best -7.95181), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-02-05_14-11-35/checkpoints/Punctuation_with_Domain_discriminator---val_loss=-7.95-epoch=2.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          84.58      50.12      62.94       4290
! (label_id: 1)                                          0.00       0.00       0.00        136
, (label_id: 2)                                         45.68      77.00      57.34      14749
- (label_id: 3)                                          5.19      13.02       7.42       1290
. (label_id: 4)                                         39.26      11.96      18.33      12043
: (label_id: 5)                                          0.00       0.00       0.00        337
; (label_id: 6)                                          0.00       0.00       0.00        165
? (label_id: 7)                                         11.16       2.32       3.84       1036
— (label_id: 8)                                          0.00       0.00       0.00        426
… (label_id: 9)                                          0.00       0.00       0.00         63
-------------------
micro avg                                               43.83      43.83      43.83      34535
macro avg                                               18.59      15.44      14.99      34535
weighted avg                                            44.23      43.83      39.09      34535

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00     100.00     100.00       2145
-------------------
micro avg                                              100.00     100.00     100.00       2145
macro avg                                              100.00     100.00     100.00       2145
weighted avg                                           100.00     100.00     100.00       2145

[INFO] - Epoch 3, global step 300: val_loss reached -17.86337 (best -17.86337), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-02-05_14-11-35/checkpoints/Punctuation_with_Domain_discriminator---val_loss=-17.86-epoch=3.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                           0.00       0.00       0.00        208
! (label_id: 1)                                          0.00       0.00       0.00         13
, (label_id: 2)                                         47.49      35.70      40.76        689
- (label_id: 3)                                          9.43      25.86      13.82         58
. (label_id: 4)                                         29.17       1.22       2.35        572
: (label_id: 5)                                          0.00       0.00       0.00         10
; (label_id: 6)                                          0.00       0.00       0.00          6
? (label_id: 7)                                          3.01      43.48       5.63         46
— (label_id: 8)                                          0.00       0.00       0.00         35
… (label_id: 9)                                          0.00       0.00       0.00          4
-------------------
micro avg                                               17.55      17.55      17.55       1641
macro avg                                                8.91      10.63       6.26       1641
weighted avg                                            30.52      17.55      18.58       1641

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00     100.00     100.00       2562
-------------------
micro avg                                              100.00     100.00     100.00       2562
macro avg                                              100.00     100.00     100.00       2562
weighted avg                                           100.00     100.00     100.00       2562

[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          83.83     100.00      91.20       5614
! (label_id: 1)                                          0.00       0.00       0.00        108
, (label_id: 2)                                         51.26       9.44      15.95      19530
- (label_id: 3)                                         12.30      77.15      21.22       1746
. (label_id: 4)                                         49.54       8.69      14.79      17976
: (label_id: 5)                                          4.22       1.86       2.58        376
; (label_id: 6)                                          0.00       0.00       0.00        170
? (label_id: 7)                                          4.07      67.21       7.68       1418
— (label_id: 8)                                          6.72       1.41       2.33       1206
… (label_id: 9)                                          0.00       0.00       0.00         89
-------------------
micro avg                                               23.52      23.52      23.52      48233
macro avg                                               21.19      26.58      15.57      48233
weighted avg                                            49.74      23.52      23.66      48233

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00     100.00     100.00       2807
-------------------
micro avg                                              100.00     100.00     100.00       2807
macro avg                                              100.00     100.00     100.00       2807
weighted avg                                           100.00     100.00     100.00       2807

[INFO] - Optimizer config = AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.005011872336272719
    weight_decay: 0.0
)
[INFO] - Scheduler "<core.optim.lr_scheduler.WarmupAnnealing object at 0x7f6fea0bb2e0>" 
will be used during training (effective maximum steps = 60) - 
Parameters : 
(warmup_steps: null
warmup_ratio: 0.1
last_epoch: -1
max_steps: 60
)
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          80.62     100.00      89.27        208
! (label_id: 1)                                          0.00       0.00       0.00         13
, (label_id: 2)                                         50.89       8.27      14.23        689
- (label_id: 3)                                          9.87      65.52      17.16         58
. (label_id: 4)                                         47.37      11.01      17.87        572
: (label_id: 5)                                          0.00       0.00       0.00         10
; (label_id: 6)                                          0.00       0.00       0.00          6
? (label_id: 7)                                          2.70      43.48       5.08         46
— (label_id: 8)                                         20.00       2.86       5.00         35
… (label_id: 9)                                          0.00       0.00       0.00          4
-------------------
micro avg                                               23.58      23.58      23.58       1641
macro avg                                               21.14      23.11      14.86       1641
weighted avg                                            48.95      23.58      24.38       1641

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00     100.00     100.00        104
-------------------
micro avg                                              100.00     100.00     100.00        104
macro avg                                              100.00     100.00     100.00        104
weighted avg                                           100.00     100.00     100.00        104

[INFO] - Optimizer config = AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.001
    weight_decay: 0.0
)
[INFO] - Scheduler "<core.optim.lr_scheduler.WarmupAnnealing object at 0x7f6fea12d4c0>" 
will be used during training (effective maximum steps = 200) - 
Parameters : 
(warmup_steps: null
warmup_ratio: 0.1
last_epoch: -1
max_steps: 200
)
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          80.62     100.00      89.27        208
! (label_id: 1)                                          0.00       0.00       0.00         13
, (label_id: 2)                                         50.89       8.27      14.23        689
- (label_id: 3)                                          9.87      65.52      17.16         58
. (label_id: 4)                                         47.37      11.01      17.87        572
: (label_id: 5)                                          0.00       0.00       0.00         10
; (label_id: 6)                                          0.00       0.00       0.00          6
? (label_id: 7)                                          2.70      43.48       5.08         46
— (label_id: 8)                                         20.00       2.86       5.00         35
… (label_id: 9)                                          0.00       0.00       0.00          4
-------------------
micro avg                                               23.58      23.58      23.58       1641
macro avg                                               21.14      23.11      14.86       1641
weighted avg                                            48.95      23.58      24.38       1641

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00     100.00     100.00        104
-------------------
micro avg                                              100.00     100.00     100.00        104
macro avg                                              100.00     100.00     100.00        104
weighted avg                                           100.00     100.00     100.00        104

[INFO] - Optimizer config = AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.001
    weight_decay: 0.0
)
[INFO] - Scheduler "<core.optim.lr_scheduler.WarmupAnnealing object at 0x7f6fe04808b0>" 
will be used during training (effective maximum steps = 60) - 
Parameters : 
(warmup_steps: null
warmup_ratio: 0.1
last_epoch: -1
max_steps: 60
)
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                           0.00       0.00       0.00        208
! (label_id: 1)                                          0.00       0.00       0.00         13
, (label_id: 2)                                         28.36      19.88      23.38        689
- (label_id: 3)                                          0.00       0.00       0.00         58
. (label_id: 4)                                         40.50      81.99      54.22        572
: (label_id: 5)                                          0.00       0.00       0.00         10
; (label_id: 6)                                          0.00       0.00       0.00          6
? (label_id: 7)                                          0.00       0.00       0.00         46
— (label_id: 8)                                          0.00       0.00       0.00         35
… (label_id: 9)                                          0.00       0.00       0.00          4
-------------------
micro avg                                               36.93      36.93      36.93       1641
macro avg                                                6.89      10.19       7.76       1641
weighted avg                                            26.03      36.93      28.72       1641

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00     100.00     100.00        104
-------------------
micro avg                                              100.00     100.00     100.00        104
macro avg                                              100.00     100.00     100.00        104
weighted avg                                           100.00     100.00     100.00        104

[INFO] - Optimizer config = AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.001
    weight_decay: 0.0
)
[INFO] - Scheduler "<core.optim.lr_scheduler.WarmupAnnealing object at 0x7f6fea090af0>" 
will be used during training (effective maximum steps = 200) - 
Parameters : 
(warmup_steps: null
warmup_ratio: 0.1
last_epoch: -1
max_steps: 200
)
[INFO] - Internal process exited
