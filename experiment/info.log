[INFO] - Global seed set to 42
[INFO] - GPU available: True, used: True
[INFO] - TPU available: None, using: 0 TPU cores
[INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [1]
[INFO] - Using native 16bit precision.
[INFO] - shuffling train set
[INFO] - Global seed set to 42
[INFO] - initializing ddp: GLOBAL_RANK: 0, MEMBER: 1/1
[INFO] - Optimizer config = AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.001
    weight_decay: 0.0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.01
    weight_decay: 0.0
)
[INFO] - Scheduler "<core.optim.lr_scheduler.CosineAnnealing object at 0x7f77ec0abf40>" 
will be used during training (effective maximum steps = 1384) - 
Parameters : 
(warmup_steps: null
warmup_ratio: 0.1
min_lr: 1.0e-08
last_epoch: -1
max_steps: 1384
)
[INFO] - 
  | Name                       | Type                 | Params
--------------------------------------------------------------------
0 | transformer                | ElectraModel         | 108 M 
1 | punct_classifier           | TokenClassifier      | 593 K 
2 | domain_classifier          | SequenceClassifier   | 1.5 K 
3 | punctuation_loss           | FocalDiceLoss        | 0     
4 | domain_loss                | FocalDiceLoss        | 0     
5 | agg_loss                   | AggregatorLoss       | 0     
6 | punct_class_report         | ClassificationReport | 0     
7 | chunked_punct_class_report | ClassificationReport | 0     
8 | domain_class_report        | ClassificationReport | 0     
--------------------------------------------------------------------
595 K     Trainable params
108 M     Non-trainable params
109 M     Total params
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          95.06      32.87      48.85      12170
, (label_id: 1)                                          5.76       5.90       5.83        848
. (label_id: 2)                                          1.77       7.26       2.84        716
? (label_id: 3)                                          0.45      59.09       0.90         44
-------------------
micro avg                                               29.96      29.96      29.96      13778
macro avg                                               25.76      26.28      14.60      13778
weighted avg                                            84.41      29.96      43.65      13778

-------------------
                       ,           .           ?
     4000.00       124.00        68.00        16.00
      780.00        50.00        38.00         0.00
     2842.00        44.00        52.00         2.00
     4548.00       630.00       558.00        26.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00     100.00     100.00        138
-------------------
micro avg                                              100.00     100.00     100.00        138
macro avg                                              100.00     100.00     100.00        138
weighted avg                                           100.00     100.00     100.00        138

-------------------
           0
      138.00
-------------------

[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          96.82      93.17      94.96      17839
, (label_id: 1)                                         38.41      45.35      41.59       1290
. (label_id: 2)                                         46.83      45.57      46.19       1117
? (label_id: 3)                                          9.22      61.45      16.04         83
-------------------
micro avg                                               87.39      87.39      87.39      20329
macro avg                                               47.82      61.38      49.69      20329
weighted avg                                            90.01      87.39      88.57      20329

-------------------
                       ,           .           ?
    16620.00       402.00       141.00         3.00
      757.00       585.00       172.00         9.00
      346.00       212.00       509.00        20.00
      116.00        91.00       295.00        51.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00     100.00     100.00        202
-------------------
micro avg                                              100.00     100.00     100.00        202
macro avg                                              100.00     100.00     100.00        202
weighted avg                                           100.00     100.00     100.00        202

-------------------
           0
      202.00
-------------------

[INFO] - Epoch 0, global step 172: val_loss reached 0.51961 (best 0.51961), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-19_17-09-46/checkpoints/Punctuation_with_Domain_discriminator---val_loss=0.52-epoch=0.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          96.91      91.14      93.93      17839
, (label_id: 1)                                         30.85      58.84      40.48       1290
. (label_id: 2)                                         47.13      24.98      32.65       1117
? (label_id: 3)                                         11.40      68.67      19.55         83
-------------------
micro avg                                               85.36      85.36      85.36      20329
macro avg                                               46.57      60.91      46.65      20329
weighted avg                                            89.63      85.36      86.87      20329

-------------------
                       ,           .           ?
    16258.00       368.00       146.00         5.00
     1307.00       759.00       382.00        12.00
      208.00        96.00       279.00         9.00
       66.00        67.00       310.00        57.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00     100.00     100.00        202
-------------------
micro avg                                              100.00     100.00     100.00        202
macro avg                                              100.00     100.00     100.00        202
weighted avg                                           100.00     100.00     100.00        202

-------------------
           0
      202.00
-------------------

[INFO] - Epoch 1, global step 345: val_loss reached 0.50806 (best 0.50806), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-19_17-09-46/checkpoints/Punctuation_with_Domain_discriminator---val_loss=0.51-epoch=1.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          97.17      91.72      94.37      17839
, (label_id: 1)                                         34.68      46.51      39.74       1290
. (label_id: 2)                                         43.14      42.52      42.83       1117
? (label_id: 3)                                          8.48      67.47      15.07         83
-------------------
micro avg                                               86.05      86.05      86.05      20329
macro avg                                               45.87      62.06      48.00      20329
weighted avg                                            89.88      86.05      87.75      20329

-------------------
                       ,           .           ?
    16362.00       359.00       116.00         1.00
      988.00       600.00       133.00         9.00
      387.00       222.00       475.00        17.00
      102.00       109.00       393.00        56.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00     100.00     100.00        202
-------------------
micro avg                                              100.00     100.00     100.00        202
macro avg                                              100.00     100.00     100.00        202
weighted avg                                           100.00     100.00     100.00        202

-------------------
           0
      202.00
-------------------

[INFO] - Epoch 2, global step 518: val_loss reached 0.51807 (best 0.50806), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-19_17-09-46/checkpoints/Punctuation_with_Domain_discriminator---val_loss=0.52-epoch=2.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          96.83      92.44      94.58      17839
, (label_id: 1)                                         36.08      41.78      38.72       1290
. (label_id: 2)                                         43.98      55.60      49.11       1117
? (label_id: 3)                                         13.99      66.27      23.11         83
-------------------
micro avg                                               87.09      87.09      87.09      20329
macro avg                                               47.72      64.02      51.38      20329
weighted avg                                            89.73      87.09      88.25      20329

-------------------
                       ,           .           ?
    16490.00       404.00       133.00         3.00
      811.00       539.00       140.00         4.00
      482.00       288.00       621.00        21.00
       56.00        59.00       223.00        55.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00     100.00     100.00        202
-------------------
micro avg                                              100.00     100.00     100.00        202
macro avg                                              100.00     100.00     100.00        202
weighted avg                                           100.00     100.00     100.00        202

-------------------
           0
      202.00
-------------------

[INFO] - Epoch 3, global step 691: val_loss reached 0.50333 (best 0.50333), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-19_17-09-46/checkpoints/Punctuation_with_Domain_discriminator---val_loss=0.50-epoch=3.ckpt" as top 3
[INFO] - Saving latest checkpoint...
[INFO] - Global seed set to 42
[INFO] - Optimizer config = AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0001
    weight_decay: 0.0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.001
    weight_decay: 0.0
)
[INFO] - Scheduler "<core.optim.lr_scheduler.CosineAnnealing object at 0x7f77bea26130>" 
will be used during training (effective maximum steps = 1384) - 
Parameters : 
(warmup_steps: null
warmup_ratio: 0.1
min_lr: 1.0e-08
last_epoch: -1
max_steps: 1384
)
[INFO] - 
  | Name                       | Type                 | Params
--------------------------------------------------------------------
0 | transformer                | ElectraModel         | 108 M 
1 | punct_classifier           | TokenClassifier      | 593 K 
2 | domain_classifier          | SequenceClassifier   | 1.5 K 
3 | punctuation_loss           | FocalDiceLoss        | 0     
4 | domain_loss                | FocalDiceLoss        | 0     
5 | agg_loss                   | AggregatorLoss       | 0     
6 | punct_class_report         | ClassificationReport | 0     
7 | chunked_punct_class_report | ClassificationReport | 0     
8 | domain_class_report        | ClassificationReport | 0     
--------------------------------------------------------------------
7.7 M     Trainable params
101 M     Non-trainable params
109 M     Total params
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          96.95      92.46      94.65      12170
, (label_id: 1)                                         36.78      43.63      39.91        848
. (label_id: 2)                                         43.00      58.38      49.53        716
? (label_id: 3)                                         13.40      59.09      21.85         44
-------------------
micro avg                                               87.57      87.57      87.57      13778
macro avg                                               47.53      63.39      51.48      13778
weighted avg                                            90.18      87.57      88.70      13778

-------------------
                       ,           .           ?
    11252.00       264.00        88.00         2.00
      540.00       370.00        94.00         2.00
      344.00       196.00       418.00        14.00
       34.00        18.00       116.00        26.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00     100.00     100.00        138
-------------------
micro avg                                              100.00     100.00     100.00        138
macro avg                                              100.00     100.00     100.00        138
weighted avg                                           100.00     100.00     100.00        138

-------------------
           0
      138.00
-------------------

[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          96.83      92.44      94.58      17839
, (label_id: 1)                                         36.08      41.78      38.72       1290
. (label_id: 2)                                         43.98      55.60      49.11       1117
? (label_id: 3)                                         13.99      66.27      23.11         83
-------------------
micro avg                                               87.09      87.09      87.09      20329
macro avg                                               47.72      64.02      51.38      20329
weighted avg                                            89.73      87.09      88.25      20329

-------------------
                       ,           .           ?
    16490.00       404.00       133.00         3.00
      811.00       539.00       140.00         4.00
      482.00       288.00       621.00        21.00
       56.00        59.00       223.00        55.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00     100.00     100.00        202
-------------------
micro avg                                              100.00     100.00     100.00        202
macro avg                                              100.00     100.00     100.00        202
weighted avg                                           100.00     100.00     100.00        202

-------------------
           0
      202.00
-------------------

[INFO] - Epoch 0, global step 692: val_loss reached 0.50333 (best 0.50333), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-19_17-09-46/checkpoints/Punctuation_with_Domain_discriminator---val_loss=0.50-epoch=0.ckpt" as top 3
[INFO] - GPU available: True, used: True
[INFO] - TPU available: None, using: 0 TPU cores
[INFO] - Using environment variable NODE_RANK for node rank (0).
[INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [1]
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          96.06      93.22      94.62      23356
, (label_id: 1)                                         46.66      44.27      45.43       2304
. (label_id: 2)                                         44.78      49.39      46.97       1632
? (label_id: 3)                                          9.89      68.52      17.29        108
-------------------
micro avg                                               86.39      86.39      86.39      27400
macro avg                                               49.35      63.85      51.08      27400
weighted avg                                            88.51      86.39      87.34      27400

-------------------
                       ,           .           ?
    21772.00       686.00       198.00        10.00
      954.00      1020.00       206.00         6.00
      524.00       452.00       806.00        18.00
      106.00       146.00       422.00        74.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00     100.00     100.00        268
-------------------
micro avg                                              100.00     100.00     100.00        268
macro avg                                              100.00     100.00     100.00        268
weighted avg                                           100.00     100.00     100.00        268

-------------------
           0
      268.00
-------------------

[INFO] - saving to /home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-19_17-09-46/test-ted-10.txt
[INFO] - Internal process exited
