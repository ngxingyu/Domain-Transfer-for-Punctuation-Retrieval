[INFO] - Global seed set to 42
[INFO] - GPU available: True, used: True
[INFO] - TPU available: None, using: 0 TPU cores
[INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
[INFO] - Using native 16bit precision.
[INFO] - shuffling train set
[INFO] - Global seed set to 42
[INFO] - initializing ddp: GLOBAL_RANK: 0, MEMBER: 1/1
[INFO] - Optimizer config = AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.001
    weight_decay: 0.0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.01
    weight_decay: 0.0
)
[INFO] - Scheduler "<core.optim.lr_scheduler.CosineAnnealing object at 0x7f99b1256d00>" 
will be used during training (effective maximum steps = 696) - 
Parameters : 
(warmup_steps: null
warmup_ratio: 0.1
min_lr: 1.0e-08
last_epoch: -1
max_steps: 696
)
[INFO] - 
  | Name                       | Type                 | Params
--------------------------------------------------------------------
0 | transformer                | ElectraModel         | 108 M 
1 | punct_classifier           | TokenClassifier      | 593 K 
2 | domain_classifier          | SequenceClassifier   | 1.5 K 
3 | punctuation_loss           | FocalDiceLoss        | 0     
4 | domain_loss                | FocalDiceLoss        | 0     
5 | agg_loss                   | AggregatorLoss       | 0     
6 | punct_class_report         | ClassificationReport | 0     
7 | chunked_punct_class_report | ClassificationReport | 0     
8 | domain_class_report        | ClassificationReport | 0     
--------------------------------------------------------------------
595 K     Trainable params
108 M     Non-trainable params
109 M     Total params
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          91.30       0.36       0.71      23522
, (label_id: 1)                                         18.66       8.69      11.86       1726
. (label_id: 2)                                          4.62      62.98       8.61       1518
? (label_id: 3)                                          0.38      19.23       0.74        104
-------------------
micro avg                                                4.50       4.50       4.50      26870
macro avg                                               28.74      22.81       5.48      26870
weighted avg                                            81.39       4.50       1.87      26870

-------------------
                       ,           .           ?
       84.00         4.00         4.00         0.00
      544.00       150.00       104.00         6.00
    18580.00      1084.00       956.00        78.00
     4314.00       488.00       454.00        20.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00     100.00     100.00        266
-------------------
micro avg                                              100.00     100.00     100.00        266
macro avg                                              100.00     100.00     100.00        266
weighted avg                                           100.00     100.00     100.00        266

-------------------
           0
      266.00
-------------------

[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          98.10      93.31      95.65      23522
, (label_id: 1)                                         42.65      61.53      50.38       1726
. (label_id: 2)                                         65.43      64.82      65.12       1518
? (label_id: 3)                                         12.30      59.62      20.39        104
-------------------
micro avg                                               89.53      89.53      89.53      26870
macro avg                                               54.62      69.82      57.89      26870
weighted avg                                            92.36      89.53      90.72      26870

-------------------
                       ,           .           ?
    21948.00       348.00        72.00         4.00
     1132.00      1062.00       284.00        12.00
      238.00       256.00       984.00        26.00
      204.00        60.00       178.00        62.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00     100.00     100.00        266
-------------------
micro avg                                              100.00     100.00     100.00        266
macro avg                                              100.00     100.00     100.00        266
weighted avg                                           100.00     100.00     100.00        266

-------------------
           0
      266.00
-------------------

[INFO] - Epoch 0, global step 86: val_loss reached 0.22343 (best 0.22343), saving model to "/home/nxingyu/project/Punctuation_with_Domain_discriminator/2021-03-22_17-05-09/checkpoints/Punctuation_with_Domain_discriminator---val_loss=0.22-epoch=0.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          98.76      93.04      95.81      23522
, (label_id: 1)                                         43.01      64.54      51.62       1726
. (label_id: 2)                                         59.23      71.01      64.59       1518
? (label_id: 3)                                         19.21      55.77      28.57        104
-------------------
micro avg                                               89.82      89.82      89.82      26870
macro avg                                               55.05      71.09      60.15      26870
weighted avg                                            92.64      89.82      90.95      26870

-------------------
                       ,           .           ?
    21884.00       238.00        32.00         4.00
     1224.00      1114.00       238.00        14.00
      380.00       334.00      1078.00        28.00
       34.00        40.00       170.00        58.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00     100.00     100.00        266
-------------------
micro avg                                              100.00     100.00     100.00        266
macro avg                                              100.00     100.00     100.00        266
weighted avg                                           100.00     100.00     100.00        266

-------------------
           0
      266.00
-------------------

[INFO] - Epoch 1, global step 173: val_loss reached 0.22107 (best 0.22107), saving model to "/home/nxingyu/project/Punctuation_with_Domain_discriminator/2021-03-22_17-05-09/checkpoints/Punctuation_with_Domain_discriminator---val_loss=0.22-epoch=1.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          98.79      92.54      95.57      23522
, (label_id: 1)                                         41.65      69.64      52.12       1726
. (label_id: 2)                                         66.54      69.70      68.08       1518
? (label_id: 3)                                         17.22      59.62      26.72        104
-------------------
micro avg                                               89.65      89.65      89.65      26870
macro avg                                               56.05      72.87      60.62      26870
weighted avg                                            92.98      89.65      90.96      26870

-------------------
                       ,           .           ?
    21768.00       224.00        38.00         4.00
     1402.00      1202.00       266.00        16.00
      264.00       246.00      1058.00        22.00
       88.00        54.00       156.00        62.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00     100.00     100.00        266
-------------------
micro avg                                              100.00     100.00     100.00        266
macro avg                                              100.00     100.00     100.00        266
weighted avg                                           100.00     100.00     100.00        266

-------------------
           0
      266.00
-------------------

[INFO] - Epoch 2, global step 260: val_loss reached 0.21748 (best 0.21748), saving model to "/home/nxingyu/project/Punctuation_with_Domain_discriminator/2021-03-22_17-05-09/checkpoints/Punctuation_with_Domain_discriminator---val_loss=0.22-epoch=2.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          99.42      88.56      93.68      23522
, (label_id: 1)                                         34.20      74.74      46.93       1726
. (label_id: 2)                                         61.43      78.26      68.83       151[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          97.52      88.98      93.05     115368
, (label_id: 1)                                         58.35      75.88      65.97      26620
. (label_id: 2)                                         76.60      91.89      83.55       2664
? (label_id: 3)                                         54.65      58.83      56.66      12068
- (label_id: 4)                                         26.64      52.14      35.27        560
… (label_id: 5)                                         23.43      24.39      23.90       2936
-------------------
micro avg                                               83.27      83.27      83.27     160216
macro avg                                               56.20      65.35      59.73     160216
weighted avg                                            85.83      83.27      84.19     160216

-------------------
                       ,           .           ?           -           …
   102652.00      1948.00        64.00       388.00        12.00       196.00
    10256.00     20200.00        84.00      2964.00        92.00      1020.00
      440.00       220.00      2448.00        60.00        12.00        16.00
     1736.00      3016.00        48.00      7100.00       152.00       940.00
       84.00       276.00         0.00       396.00       292.00        48.00
      200.00       960.00        20.00      1160.00         0.00       716.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00       1.70       3.35       1644
1 (label_id: 1)                                          0.00       0.00       0.00          0
2 (label_id: 2)                                          0.00       0.00       0.00          0
-------------------
micro avg                                                1.70       1.70       1.70       1644
macro avg                                               33.33       0.57       1.12       1644
weighted avg                                           100.00       1.70       3.35       1644

-------------------
           0           1           2
       28.00         0.00         0.00
        8.00         0.00         0.00
     1608.00         0.00         0.00
-------------------

[INFO] - Epoch 2, global step 749: val_loss reached 1.19650 (best 1.19230), saving model to "/home/nxingyu/project/Punctuation_with_Domain_discriminator/2021-03-22_16-38-47/checkpoints/Punctuation_with_Domain_discriminator---val_loss=1.20-epoch=2.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          96.81      91.28      93.96     115368
, (label_id: 1)                                         62.81      72.52      67.32      26620
. (label_id: 2)                                         79.47      90.69      84.71       2664
? (label_id: 3)                                         52.23      58.24      55.07      12068
- (label_id: 4)                                         20.59      60.00      30.66        560
… (label_id: 5)                                         24.73      21.66      23.09       2936
-------------------
micro avg                                               84.28      84.28      84.28     160216
macro avg                                               56.11      65.73      59.14     160216
weighted avg                                            85.93      84.28      84.93     160216

-------------------
                       ,           .           ?           -           …
   105312.00      2532.00       120.00       532.00        16.00       272.00
     7536.00     19304.00        84.00      2804.00        56.00       948.00
      324.00       196.00      2416.00        84.00         8.00        12.00
     1828.00      3444.00        20.00      7028.00       140.00       996.00
      120.00       468.00         0.00       636.00       336.00        72.00
      248.00       676.00        24.00       984.00         4.00       636.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00       1.95       3.82       1644
1 (label_id: 1)                                          0.00       0.00       0.00          0
2 (label_id: 2)                                          0.00       0.00       0.00          0
-------------------
micro avg                                                1.95       1.95       1.95       1644
macro avg                                               33.33       0.65       1.27       1644
weighted avg                                           100.00       1.95       3.82       1644

-------------------
           0           1           2
       32.00         0.00         0.00
       12.00         0.00         0.00
     1600.00         0.00         0.00
-------------------

[INFO] - Epoch 3, step 999: val_loss was not in top 3
    26870
macro avg                                               55.19      73.37      60.96      26870
weighted avg                                            92.80      86.95      89.04      26870

-------------------
                       ,           .           ?
    20832.00       114.00         6.00         2.00
     2226.00      1290.00       232.00        24.00
      424.00       298.00      1188.00        24.00
       40.00        24.00        92.00        54.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00     100.00     100.00        266
-------------------
micro avg                                              100.00     100.00     100.00        266
macro avg                                              100.00     100.00     100.00        266
weighted avg                                           100.00     100.00     100.00        266

-------------------
           0
      266.00
-------------------

[INFO] - Epoch 0, global step 348: val_loss reached 0.21947 (best 0.21748), saving model to "/home/nxingyu/project/Punctuation_with_Domain_discriminator/2021-03-22_17-05-09/checkpoints/Punctuation_with_Domain_discriminator---val_loss=0.22-epoch=0.ckpt" as top 3
[INFO] - Global seed set to 42
[INFO] - Optimizer config = AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0001
    weight_decay: 0.0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.001
    weight_decay: 0.0
)
[INFO] - Scheduler "<core.optim.lr_scheduler.CosineAnnealing object at 0x7f99d7f7ddc0>" 
will be used during training (effective maximum steps = 696) - 
Parameters : 
(warmup_steps: null
warmup_ratio: 0.1
min_lr: 1.0e-08
last_epoch: -1
max_steps: 696
)
[INFO] - 
  | Name                       | Type                 | Params
--------------------------------------------------------------------
0 | transformer                | ElectraModel         | 108 M 
1 | punct_classifier           | TokenClassifier      | 593 K 
2 | domain_classifier          | SequenceClassifier   | 1.5 K 
3 | punctuation_loss           | FocalDiceLoss        | 0     
4 | domain_loss                | FocalDiceLoss        | 0     
5 | agg_loss                   | AggregatorLoss       | 0     
6 | punct_class_report         | ClassificationReport | 0     
7 | chunked_punct_class_report | ClassificationReport | 0     
8 | domain_class_report        | ClassificationReport | 0     
--------------------------------------------------------------------
14.8 M    Trainable params
94.7 M    Non-trainable params
109 M     Total params
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          99.42      88.56      93.68      23522
, (label_id: 1)                                         34.20      74.74      46.93       1726
. (label_id: 2)                                         61.43      78.26      68.83       1518
? (label_id: 3)                                         25.71      51.92      34.39        104
-------------------
micro avg                                               86.95      86.95      86.95      26870
macro avg                                               55.19      73.37      60.96      26870
weighted avg                                            92.80      86.95      89.04      26870

-------------------
                       ,           .           ?
    20832.00       114.00         6.00         2.00
     2226.00      1290.00       232.00        24.00
      424.00       298.00      1188.00        24.00
       40.00        24.00        92.00        54.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00     100.00     100.00        266
-------------------
micro avg                                              100.00     100.00     100.00        266
macro avg                                              100.00     100.00     100.00        266
weighted avg                                           100.00     100.00     100.00        266

-------------------
           0
      266.00
-------------------

[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          99.42      88.56      93.68      23522
, (label_id: 1)                                         34.20      74.74      46.93       1726
. (label_id: 2)                                         61.43      78.26      68.83       1518
? (label_id: 3)                                         25.71      51.92      34.39        104
-------------------
micro avg                                               86.95      86.95      86.95      26870
macro avg                                               55.19      73.37      60.96      26870
weighted avg                                            92.80      86.95      89.04      26870

-------------------
                       ,           .           ?
    20832.00       114.00         6.00         2.00
     2226.00      1290.00       232.00        24.00
      424.00       298.00      1188.00        24.00
       40.00        24.00        92.00        54.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00     100.00     100.00        266
-------------------
micro avg                                              100.00     100.00     100.00        266
macro avg                                              100.00     100.00     100.00        266
weighted avg                                           100.00     100.00     100.00        266

-------------------
           0
      266.00
-------------------

[INFO] - GPU available: True, used: True
[INFO] - TPU available: None, using: 0 TPU cores
[INFO] - Using environment variable NODE_RANK for node rank (0).
[INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          98.91      89.66      94.06      35136
, (label_id: 1)                                         41.35      69.62      51.88       3387
. (label_id: 2)                                         57.10      72.83      64.01       2451
? (label_id: 3)                                         18.12      52.94      27.00        153
-------------------
micro avg                                               86.87      86.87      86.87      41127
macro avg                                               53.87      71.26      59.24      41127
weighted avg                                            91.38      86.87      88.54      41127

-------------------
                       ,           .           ?
    31503.00       297.00        39.00        12.00
     2904.00      2358.00       417.00        24.00
      642.00       663.00      1785.00        36.00
       87.00        69.00       210.00        81.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00     100.00     100.00        402
-------------------
micro avg                                              100.00     100.00     100.00        402
macro avg                                              100.00     100.00     100.00        402
weighted avg                                           100.00     100.00     100.00        402

-------------------
           0
      402.00
-------------------

[INFO] - saving to /home/nxingyu/project/Punctuation_with_Domain_discriminator/2021-03-22_17-05-09/test-ted-9.txt
[INFO] - Internal process exited
