[INFO] - GPU available: True, used: False
[INFO] - TPU available: None, using: 0 TPU cores
[INFO] - shuffling train set
[INFO] - Optimizer config = AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.001
    weight_decay: 0.0
)
[INFO] - Scheduler "<core.optim.lr_scheduler.WarmupAnnealing object at 0x7f1b0f3334c0>" 
will be used during training (effective maximum steps = 60) - 
Parameters : 
(warmup_steps: null
warmup_ratio: 0.1
last_epoch: -1
max_steps: 60
)
[INFO] - 
  | Name                | Type                 | Params
-------------------------------------------------------------
0 | transformer         | ElectraModel         | 13.5 M
1 | punct_classifier    | TokenClassifier      | 2.6 K 
2 | domain_classifier   | SequenceClassifier   | 257   
3 | punctuation_loss    | FocalDiceLoss        | 0     
4 | domain_loss         | CrossEntropyLoss     | 0     
5 | agg_loss            | AggregatorLoss       | 0     
6 | punct_class_report  | ClassificationReport | 0     
7 | domain_class_report | ClassificationReport | 0     
-------------------------------------------------------------
825 K     Trainable params
12.7 M    Non-trainable params
13.5 M    Total params
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          17.26      96.74      29.30        184
! (label_id: 1)                                          0.00       0.00       0.00          4
, (label_id: 2)                                         58.62       2.86       5.46        594
- (label_id: 3)                                          7.14       8.47       7.75         59
. (label_id: 4)                                         48.80      15.46      23.48        524
: (label_id: 5)                                          1.12       5.56       1.87         18
; (label_id: 6)                                          0.00       0.00       0.00         13
? (label_id: 7)                                         14.89       7.37       9.86         95
— (label_id: 8)                                          0.00       0.00       0.00         12
… (label_id: 9)                                          0.00       0.00       0.00          0
-------------------
micro avg                                               19.23      19.23      19.23       1503
macro avg                                               16.43      15.16       8.64       1503
weighted avg                                            43.53      19.23      14.88       1503

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00     100.00     100.00         92
-------------------
micro avg                                              100.00     100.00     100.00         92
macro avg                                              100.00     100.00     100.00         92
weighted avg                                           100.00     100.00     100.00         92

[INFO] - Restored states from the checkpoint file at /home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-02-05_10-48-12/lr_find_temp_model.ckpt
[INFO] - Optimizer config = AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.003162277660168378
    weight_decay: 0.0
)
[INFO] - Scheduler "<core.optim.lr_scheduler.WarmupAnnealing object at 0x7f1b00306f10>" 
will be used during training (effective maximum steps = 800) - 
Parameters : 
(warmup_steps: null
warmup_ratio: 0.1
last_epoch: -1
max_steps: 800
)
[INFO] - 
  | Name                | Type                 | Params
-------------------------------------------------------------
0 | transformer         | ElectraModel         | 13.5 M
1 | punct_classifier    | TokenClassifier      | 2.6 K 
2 | domain_classifier   | SequenceClassifier   | 257   
3 | punctuation_loss    | FocalDiceLoss        | 0     
4 | domain_loss         | CrossEntropyLoss     | 0     
5 | agg_loss            | AggregatorLoss       | 0     
6 | punct_class_report  | ClassificationReport | 0     
7 | domain_class_report | ClassificationReport | 0     
-------------------------------------------------------------
825 K     Trainable params
12.7 M    Non-trainable params
13.5 M    Total params
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          17.82      95.16      30.03        124
! (label_id: 1)                                          0.00       0.00       0.00          3
, (label_id: 2)                                         70.59       3.01       5.77        399
- (label_id: 3)                                          2.56       3.23       2.86         31
. (label_id: 4)                                         48.76      17.40      25.65        339
: (label_id: 5)                                          1.79       9.09       2.99         11
; (label_id: 6)                                          0.00       0.00       0.00          1
? (label_id: 7)                                         15.62       7.58      10.20         66
— (label_id: 8)                                          0.00       0.00       0.00         11
… (label_id: 9)                                          0.00       0.00       0.00          0
-------------------
micro avg                                               19.90      19.90      19.90        985
macro avg                                               17.46      15.05       8.61        985
weighted avg                                            48.77      19.90      15.75        985

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00     100.00     100.00         62
-------------------
micro avg                                              100.00     100.00     100.00         62
macro avg                                              100.00     100.00     100.00         62
weighted avg                                           100.00     100.00     100.00         62

[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                         100.00       0.05       0.09       4284
! (label_id: 1)                                          0.00       0.00       0.00        151
, (label_id: 2)                                         44.08      77.25      56.13      14795
- (label_id: 3)                                         65.97      71.00      68.39       1286
. (label_id: 4)                                         55.76       5.49       9.99      12169
: (label_id: 5)                                         16.64      34.86      22.53        350
; (label_id: 6)                                          3.61       8.48       5.06        165
? (label_id: 7)                                         18.27      69.05      28.90       1021
— (label_id: 8)                                          2.51       7.36       3.74        421
… (label_id: 9)                                          0.00       0.00       0.00         85
-------------------
micro avg                                               39.98      39.98      39.98      34727
macro avg                                               30.68      27.35      19.48      34727
weighted avg                                            53.85      39.98      31.11      34727

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00     100.00     100.00       2142
-------------------
micro avg                                              100.00     100.00     100.00       2142
macro avg                                              100.00     100.00     100.00       2142
weighted avg                                           100.00     100.00     100.00       2142

[INFO] - Epoch 1, global step 100: val_loss reached 0.71243 (best 0.71243), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-02-05_10-48-12/checkpoints/Punctuation_with_Domain_discriminator---val_loss=0.71-epoch=1.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                           0.00       0.00       0.00       4044
! (label_id: 1)                                          0.00       0.00       0.00        145
, (label_id: 2)                                         43.32      43.32      43.32      13833
- (label_id: 3)                                         59.53      75.81      66.69       1174
. (label_id: 4)                                         51.13      53.22      52.15      11588
: (label_id: 5)                                         32.11      24.69      27.92        320
; (label_id: 6)                                          3.27      10.76       5.01        158
? (label_id: 7)                                         22.43      67.01      33.61       1067
— (label_id: 8)                                          3.45      11.46       5.30        445
… (label_id: 9)                                          0.00       0.00       0.00         74
-------------------
micro avg                                               42.35      42.35      42.35      32848
macro avg                                               21.52      28.63      23.40      32848
weighted avg                                            39.51      42.35      40.48      32848

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00     100.00     100.00       2022
-------------------
micro avg                                              100.00     100.00     100.00       2022
macro avg                                              100.00     100.00     100.00       2022
weighted avg                                           100.00     100.00     100.00       2022

[INFO] - Epoch 2, global step 200: val_loss reached 0.60420 (best 0.60420), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-02-05_10-48-12/checkpoints/Punctuation_with_Domain_discriminator---val_loss=0.60-epoch=2.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          84.44       0.89       1.75       4292
! (label_id: 1)                                          7.41       9.02       8.14        133
, (label_id: 2)                                         43.74      44.01      43.88      14694
- (label_id: 3)                                         52.78      80.86      63.87       1327
. (label_id: 4)                                         52.94      50.45      51.66      12213
: (label_id: 5)                                         18.73      39.23      25.36        339
; (label_id: 6)                                          3.05      21.52       5.35        158
? (label_id: 7)                                         27.21      55.73      36.57       1055
— (label_id: 8)                                          3.02      13.20       4.92        485
… (label_id: 9)                                          0.00       0.00       0.00         68
-------------------
micro avg                                               41.91      41.91      41.91      34764
macro avg                                               29.33      31.49      24.15      34764
weighted avg                                            50.62      41.91      40.83      34764

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00     100.00     100.00       2146
-------------------
micro avg                                              100.00     100.00     100.00       2146
macro avg                                              100.00     100.00     100.00       2146
weighted avg                                           100.00     100.00     100.00       2146

[INFO] - Epoch 3, global step 300: val_loss reached 0.54977 (best 0.54977), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-02-05_10-48-12/checkpoints/Punctuation_with_Domain_discriminator---val_loss=0.55-epoch=3.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          53.66       2.71       5.15       4066
! (label_id: 1)                                         10.99       6.90       8.47        145
, (label_id: 2)                                         43.36      35.48      39.02      14051
- (label_id: 3)                                         63.28      71.71      67.23       1276
. (label_id: 4)                                         50.84      73.36      60.06      11507
: (label_id: 5)                                         23.79      39.88      29.80        321
; (label_id: 6)                                          3.17       2.67       2.90        150
? (label_id: 7)                                         44.77      47.00      45.86        983
— (label_id: 8)                                          2.80      10.36       4.41        386
… (label_id: 9)                                          0.00       0.00       0.00         83
-------------------
micro avg                                               45.79      45.79      45.79      32968
macro avg                                               29.67      29.01      26.29      32968
weighted avg                                            46.95      45.79      42.59      32968

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00     100.00     100.00       2033
-------------------
micro avg                                              100.00     100.00     100.00       2033
macro avg                                              100.00     100.00     100.00       2033
weighted avg                                           100.00     100.00     100.00       2033

[INFO] - Epoch 4, global step 400: val_loss reached 0.58447 (best 0.54977), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-02-05_10-48-12/checkpoints/Punctuation_with_Domain_discriminator---val_loss=0.58-epoch=4.ckpt" as top 3
