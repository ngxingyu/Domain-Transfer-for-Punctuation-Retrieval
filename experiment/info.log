[INFO] - Global seed set to 42
[INFO] - GPU available: True, used: True
[INFO] - TPU available: None, using: 0 TPU cores
[INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [1]
[INFO] - Using native 16bit precision.
[INFO] - shuffling train set
[INFO] - Global seed set to 42
[INFO] - initializing ddp: GLOBAL_RANK: 0, MEMBER: 1/1
[INFO] - Optimizer config = AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.01
    weight_decay: 0.0
)
[INFO] - Scheduler "<core.optim.lr_scheduler.CosineAnnealing object at 0x7f92ca312ee0>" 
will be used during training (effective maximum steps = 5000) - 
Parameters : 
(warmup_steps: null
warmup_ratio: 0.1
min_lr: 1.0e-08
last_epoch: -1
max_steps: 5000
)
[INFO] - 
  | Name                       | Type                 | Params
--------------------------------------------------------------------
0 | transformer                | ElectraModel         | 108 M 
1 | punct_classifier           | TokenClassifier      | 594 K 
2 | domain_classifier          | SequenceClassifier   | 3.1 K 
3 | punctuation_loss           | FocalDiceLoss        | 0     
4 | domain_loss                | CrossEntropyLoss     | 0     
5 | agg_loss                   | AggregatorLoss       | 0     
6 | punct_class_report         | ClassificationReport | 0     
7 | chunked_punct_class_report | ClassificationReport | 0     
8 | domain_class_report        | ClassificationReport | 0     
--------------------------------------------------------------------
597 K     Trainable params
108 M     Non-trainable params
109 M     Total params
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          69.13       5.68      10.49      29671
# (label_id: 1)                                         21.21      27.91      24.10       3934
, (label_id: 2)                                          7.50      58.70      13.30       2392
. (label_id: 3)                                          7.88      16.94      10.76       3264
? (label_id: 4)                                          0.32       4.69       0.59        426
-------------------
micro avg                                               11.99      11.99      11.99      39687
macro avg                                               21.21      22.78      11.85      39687
weighted avg                                            54.89      11.99      11.92      39687

-------------------
                       #           ,           .           ?
     1684.00        30.00       266.00       380.00        76.00
     3647.00      1098.00       192.00       212.00        28.00
    13749.00      1486.00      1404.00      1861.00       221.00
     5096.00       949.00       340.00       553.00        81.00
     5495.00       371.00       190.00       258.00        20.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                          0.00       0.00       0.00        168
1 (label_id: 1)                                         49.70      98.81      66.14        168
-------------------
micro avg                                               49.40      49.40      49.40        336
macro avg                                               24.85      49.40      33.07        336
weighted avg                                            24.85      49.40      33.07        336

-------------------
           0           1
        0.00         2.00
      168.00       166.00
-------------------

[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          98.69      91.57      95.00   10255008
# (label_id: 1)                                         86.80      98.99      92.50    1539872
, (label_id: 2)                                         46.80      65.97      54.76     874716
. (label_id: 3)                                         67.77      64.73      66.22    1315904
? (label_id: 4)                                         36.14      72.05      48.14     225791
-------------------
micro avg                                               88.00      88.00      88.00   14211291
macro avg                                               67.24      78.66      71.32   14211291
weighted avg                                            90.35      88.00      88.84   14211291

-------------------
                       #           ,           .           ?
  9390481.00      8187.00     68731.00     42471.00      5367.00
   222312.00   1524389.00      4072.00      4511.00       847.00
   393347.00      1284.00    577065.00    246499.00     14745.00
   191461.00      5238.00    166202.00    851826.00     42144.00
    57407.00       774.00     58646.00    170597.00    162688.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                         83.86      98.29      90.50      60334
1 (label_id: 1)                                         97.94      81.08      88.72      60334
-------------------
micro avg                                               89.69      89.69      89.69     120668
macro avg                                               90.90      89.69      89.61     120668
weighted avg                                            90.90      89.69      89.61     120668

-------------------
           0           1
    59303.00     11413.00
     1031.00     48921.00
-------------------

[INFO] - Epoch 0, global step 624: val_loss reached 0.48038 (best 0.48038), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-02_15-54-50/checkpoints/Punctuation_with_Domain_discriminator---val_loss=0.48-epoch=0.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          98.66      92.40      95.43   10253795
# (label_id: 1)                                         90.32      98.65      94.30    1540339
, (label_id: 2)                                         46.68      69.02      55.70     875581
. (label_id: 3)                                         69.85      69.23      69.54    1316219
? (label_id: 4)                                         45.98      66.64      54.41     225274
-------------------
micro avg                                               89.08      89.08      89.08   14211208
macro avg                                               70.30      79.19      73.87   14211208
weighted avg                                            91.05      89.08      89.81   14211208

-------------------
                       #           ,           .           ?
  9474433.00     14976.00     64818.00     42465.00      6736.00
   159947.00   1519499.00      1575.00      1148.00       139.00
   408429.00      1176.00    604321.00    261630.00     18910.00
   171995.00      4170.00    167804.00    911178.00     49373.00
    38991.00       518.00     37063.00     99798.00    150116.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                         85.67      98.11      91.47      60334
1 (label_id: 1)                                         97.79      83.59      90.13      60334
-------------------
micro avg                                               90.85      90.85      90.85     120668
macro avg                                               91.73      90.85      90.80     120668
weighted avg                                            91.73      90.85      90.80     120668

-------------------
           0           1
    59196.00      9902.00
     1138.00     50432.00
-------------------

[INFO] - Epoch 1, global step 1249: val_loss reached 0.46798 (best 0.46798), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-02_15-54-50/checkpoints/Punctuation_with_Domain_discriminator---val_loss=0.47-epoch=1.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          99.01      91.36      95.03   10253939
# (label_id: 1)                                         90.45      99.03      94.55    1540725
, (label_id: 2)                                         44.56      71.68      54.96     875444
. (label_id: 3)                                         70.16      61.79      65.71    1318421
? (label_id: 4)                                         34.72      76.27      47.72     225981
-------------------
micro avg                                               88.00      88.00      88.00   14214510
macro avg                                               67.78      80.03      71.59   14214510
weighted avg                                            91.03      88.00      89.04   14214510

-------------------
                       #           ,           .           ?
  9368254.00      5802.00     50546.00     32945.00      4240.00
   158939.00   1525824.00      1004.00      1027.00       131.00
   483130.00      1503.00    627496.00    278763.00     17269.00
   174337.00      6645.00    133560.00    814711.00     31979.00
    69279.00       951.00     62838.00    190975.00    172362.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                         84.49      98.51      90.96      60334
1 (label_id: 1)                                         98.21      81.92      89.33      60334
-------------------
micro avg                                               90.21      90.21      90.21     120668
macro avg                                               91.35      90.21      90.14     120668
weighted avg                                            91.35      90.21      90.14     120668

-------------------
           0           1
    59434.00     10911.00
      900.00     49423.00
-------------------

[INFO] - Epoch 2, global step 1874: val_loss reached 0.47173 (best 0.46798), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-02_15-54-50/checkpoints/Punctuation_with_Domain_discriminator---val_loss=0.47-epoch=2.ckpt" as top 3
