[INFO] - Global seed set to 42
[INFO] - GPU available: True, used: True
[INFO] - TPU available: None, using: 0 TPU cores
[INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
[INFO] - Using native 16bit precision.
[INFO] - shuffling train set
[INFO] - Global seed set to 42
[INFO] - initializing ddp: GLOBAL_RANK: 0, MEMBER: 1/1
[INFO] - Optimizer config = AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.01
    weight_decay: 0.0
)
[INFO] - Scheduler "<core.optim.lr_scheduler.CosineAnnealing object at 0x7f9aa5c70c40>" 
will be used during training (effective maximum steps = 504) - 
Parameters : 
(warmup_steps: null
warmup_ratio: 0.1
min_lr: 1.0e-08
last_epoch: -1
max_steps: 504
)
[INFO] - 
  | Name                       | Type                 | Params
--------------------------------------------------------------------
0 | transformer                | ElectraModel         | 108 M 
1 | punct_classifier           | TokenClassifier      | 1.2 M 
2 | domain_classifier          | SequenceClassifier   | 1.5 K 
3 | punctuation_loss           | FocalDiceLoss        | 0     
4 | domain_loss                | CrossEntropyLoss     | 0     
5 | agg_loss                   | AggregatorLoss       | 0     
6 | punct_class_report         | ClassificationReport | 0     
7 | chunked_punct_class_report | ClassificationReport | 0     
8 | domain_class_report        | ClassificationReport | 0     
--------------------------------------------------------------------
1.2 M     Trainable params
108 M     Non-trainable params
110 M     Total params
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          58.26       5.25       9.64       7120
# (label_id: 1)                                          7.53      69.29      13.58        814
, (label_id: 2)                                          2.92       2.52       2.70        556
. (label_id: 3)                                          2.15       0.89       1.26        450
? (label_id: 4)                                          0.00       0.00       0.00         16
-------------------
micro avg                                               10.67      10.67      10.67       8956
macro avg                                               14.17      15.59       5.43       8956
weighted avg                                            47.29      10.67       9.13       8956

-------------------
                       #           ,           .           ?
      374.00       112.00        86.00        66.00         4.00
     6100.00       564.00       440.00       378.00        12.00
      414.00        50.00        14.00         2.00         0.00
      114.00        52.00        16.00         4.00         0.00
      118.00        36.00         0.00         0.00         0.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00     100.00     100.00        128
-------------------
micro avg                                              100.00     100.00     100.00        128
macro avg                                              100.00     100.00     100.00        128
weighted avg                                           100.00     100.00     100.00        128

-------------------
           0
      128.00
-------------------

[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                           0.00       0.00       0.00     609522
# (label_id: 1)                                         14.66      91.96      25.29      63514
, (label_id: 2)                                         13.45      95.67      23.58      49760
. (label_id: 3)                                         65.60       3.65       6.91      41730
? (label_id: 4)                                          6.45      26.09      10.35       3250
-------------------
micro avg                                               14.12      14.12      14.12     767776
macro avg                                               20.03      43.47      13.23     767776
weighted avg                                             5.68      14.12       4.04     767776

-------------------
                       #           ,           .           ?
        0.00         0.00         0.00         0.00         0.00
   337502.00     58408.00      1680.00       658.00        92.00
   270972.00      5090.00     47606.00     28182.00      2122.00
      320.00         2.00       288.00      1522.00       188.00
      728.00        14.00       186.00     11368.00       848.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00     100.00     100.00      11546
-------------------
micro avg                                              100.00     100.00     100.00      11546
macro avg                                              100.00     100.00     100.00      11546
weighted avg                                           100.00     100.00     100.00      11546

-------------------
           0
    11546.00
-------------------

[INFO] - Epoch 0, global step 62: val_loss reached 0.29001 (best 0.29001), saving model to "/home/nxingyu/project/Punctuation_with_Domain_discriminator/2021-03-08_14-28-24/checkpoints/Punctuation_with_Domain_discriminator---val_loss=0.29-epoch=0.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                           0.00       0.00       0.00     609522
# (label_id: 1)                                         10.58      92.81      18.99      63514
, (label_id: 2)                                         35.72      18.15      24.07      49760
. (label_id: 3)                                          0.00       0.00       0.00      41730
? (label_id: 4)                                          1.69      96.18       3.32       3250
-------------------
micro avg                                                9.26       9.26       9.26     767776
macro avg                                                9.60      41.43       9.28     767776
weighted avg                                             3.20       9.26       3.14     767776

-------------------
                       #           ,           .           ?
        0.00         0.00         0.00         0.00         0.00
   485760.00     58950.00     10870.00      1720.00        92.00
    15008.00        62.00      9032.00      1152.00        32.00
        0.00         0.00         0.00         0.00         0.00
   108754.00      4502.00     29858.00     38858.00      3126.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00     100.00     100.00      11546
-------------------
micro avg                                              100.00     100.00     100.00      11546
macro avg                                              100.00     100.00     100.00      11546
weighted avg                                           100.00     100.00     100.00      11546

-------------------
           0
    11546.00
-------------------

[INFO] - Epoch 1, global step 125: val_loss reached 0.31849 (best 0.29001), saving model to "/home/nxingyu/project/Punctuation_with_Domain_discriminator/2021-03-08_14-28-24/checkpoints/Punctuation_with_Domain_discriminator---val_loss=0.32-epoch=1.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                           0.00       0.00       0.00     609522
# (label_id: 1)                                         12.69      97.78      22.47      63514
, (label_id: 2)                                         16.54      92.58      28.07      49760
. (label_id: 3)                                          0.00       0.00       0.00      41730
? (label_id: 4)                                          0.00       0.00       0.00       3250
-------------------
micro avg                                               14.09      14.09      14.09     767776
macro avg                                                5.85      38.07      10.11     767776
weighted avg                                             2.12      14.09       3.68     767776

-------------------
                       #           ,           .           ?
        0.00         0.00         0.00         0.00         0.00
   421874.00     62104.00      3690.00      1456.00       152.00
   187648.00      1410.00     46070.00     40274.00      3098.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00     100.00     100.00      11546
-------------------
micro avg                                              100.00     100.00     100.00      11546
macro avg                                              100.00     100.00     100.00      11546
weighted avg                                           100.00     100.00     100.00      11546

-------------------
           0
    11546.00
-------------------

[INFO] - Epoch 2, global step 188: val_loss reached 0.32332 (best 0.29001), saving model to "/home/nxingyu/project/Punctuation_with_Domain_discriminator/2021-03-08_14-28-24/checkpoints/Punctuation_with_Domain_discriminator---val_loss=0.32-epoch=2.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                           0.00       0.00       0.00     609522
# (label_id: 1)                                          8.95      99.96      16.43      63514
, (label_id: 2)                                         35.06      41.09      37.83      49760
. (label_id: 3)                                          0.00       0.00       0.00      41730
? (label_id: 4)                                          0.00       0.00       0.00       3250
-------------------
micro avg                                               10.93      10.93      10.93     767776
macro avg                                                8.80      28.21      10.85     767776
weighted avg                                             3.01      10.93       3.81     767776

-------------------
                       #           ,           .           ?
        0.00         0.00         0.00         0.00         0.00
   591902.00     63486.00     29316.00     22738.00      2020.00
    17620.00        28.00     20444.00     18992.00      1230.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00     100.00     100.00      11546
-------------------
micro avg                                              100.00     100.00     100.00      11546
macro avg                                              100.00     100.00     100.00      11546
weighted avg                                           100.00     100.00     100.00      11546

-------------------
           0
    11546.00
-------------------

[INFO] - Epoch 3, step 251: val_loss was not in top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                           0.00       0.00       0.00     609522
# (label_id: 1)                                         13.85      95.67      24.19      63514
, (label_id: 2)                                         14.35      94.85      24.92      49760
. (label_id: 3)                                          0.00       0.00       0.00      41730
? (label_id: 4)                                          0.00       0.00       0.00       3250
-------------------
micro avg                                               14.06      14.06      14.06     767776
macro avg                                                5.64      38.10       9.82     767776
weighted avg                                             2.08      14.06       3.62     767776

-------------------
                       #           ,           .           ?
        0.00         0.00         0.00         0.00         0.00
   373050.00     60764.00      2562.00      2022.00       402.00
   236472.00      2750.00     47198.00     39708.00      2848.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00     100.00     100.00      11546
-------------------
micro avg                                              100.00     100.00     100.00      11546
macro avg                                              100.00     100.00     100.00      11546
weighted avg                                           100.00     100.00     100.00      11546

-------------------
           0
    11546.00
-------------------

[INFO] - Epoch 4, step 314: val_loss was not in top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                           0.00       0.00       0.00     609522
# (label_id: 1)                                         10.25      99.53      18.59      63514
, (label_id: 2)                                         24.76      75.23      37.25      49760
. (label_id: 3)                                          0.00       0.00       0.00      41730
? (label_id: 4)                                          0.00       0.00       0.00       3250
-------------------
micro avg                                               13.11      13.11      13.11     767776
macro avg                                                7.00      34.95      11.17     767776
weighted avg                                             2.45      13.11       3.95     767776

-------------------
                       #           ,           .           ?
        0.00         0.00         0.00         0.00         0.00
   529092.00     63218.00     12324.00     10670.00      1252.00
    80430.00       296.00     37436.00     31060.00      1998.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00     100.00     100.00      11546
-------------------
micro avg                                              100.00     100.00     100.00      11546
macro avg                                              100.00     100.00     100.00      11546
weighted avg                                           100.00     100.00     100.00      11546

-------------------
           0
    11546.00
-------------------

[INFO] - Epoch 5, step 377: val_loss was not in top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                           0.00       0.00       0.00     609522
# (label_id: 1)                                         10.71      99.21      19.33      63514
, (label_id: 2)                                         22.40      80.68      35.07      49760
. (label_id: 3)                                          0.00       0.00       0.00      41730
? (label_id: 4)                                          0.00       0.00       0.00       3250
-------------------
micro avg                                               13.44      13.44      13.44     767776
macro avg                                                6.62      35.98      10.88     767776
weighted avg                                             2.34      13.44       3.87     767776

-------------------
                       #           ,           .           ?
        0.00         0.00         0.00         0.00         0.00
   506182.00     63012.00      9612.00      8698.00      1078.00
   103340.00       502.00     40148.00     33032.00      2172.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                        100.00     100.00     100.00      11546
-------------------
micro avg                                              100.00     100.00     100.00      11546
macro avg                                              100.00     100.00     100.00      11546
weighted avg                                           100.00     100.00     100.00      11546

-------------------
           0
    11546.00
-------------------

[INFO] - Epoch 6, step 440: val_loss was not in top 3
[INFO] - Saving latest checkpoint...
[INFO] - Epoch 7, step 459: val_loss was not in top 3
[INFO] - Internal process exited
