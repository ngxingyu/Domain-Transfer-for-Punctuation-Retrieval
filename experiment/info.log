[INFO] - Global seed set to 42
[INFO] - GPU available: True, used: True
[INFO] - TPU available: None, using: 0 TPU cores
[INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [1]
[INFO] - Using native 16bit precision.
[INFO] - shuffling train set
[INFO] - Global seed set to 42
[INFO] - initializing ddp: GLOBAL_RANK: 0, MEMBER: 1/1
[INFO] - Optimizer config = AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.01
    weight_decay: 0.0
)
[INFO] - Scheduler "<core.optim.lr_scheduler.CosineAnnealing object at 0x7f6d33474d60>" 
will be used during training (effective maximum steps = 104) - 
Parameters : 
(warmup_steps: null
warmup_ratio: 0.1
min_lr: 1.0e-08
last_epoch: -1
max_steps: 104
)
[INFO] - 
  | Name                       | Type                 | Params
--------------------------------------------------------------------
0 | transformer                | ElectraModel         | 108 M 
1 | punct_classifier           | TokenClassifier      | 3.8 K 
2 | domain_classifier          | SequenceClassifier   | 1.5 K 
3 | punctuation_loss           | LinearChainCRF       | 35    
4 | domain_loss                | CrossEntropyLoss     | 0     
5 | agg_loss                   | AggregatorLoss       | 0     
6 | punct_class_report         | ClassificationReport | 0     
7 | chunked_punct_class_report | ClassificationReport | 0     
8 | domain_class_report        | ClassificationReport | 0     
--------------------------------------------------------------------
5.4 K     Trainable params
108 M     Non-trainable params
108 M     Total params
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          60.00       0.72       1.43      16566
# (label_id: 1)                                          0.00       0.00       0.00       1458
, (label_id: 2)                                          5.91      86.94      11.07       1210
. (label_id: 3)                                          0.00       0.00       0.00       1008
? (label_id: 4)                                          0.53      14.63       1.02         82
-------------------
micro avg                                                5.83       5.83       5.83      20324
macro avg                                               13.29      20.46       2.70      20324
weighted avg                                            49.26       5.83       1.83      20324

-------------------
                       #           ,           .           ?
      120.00        34.00        16.00        28.00         2.00
       16.00         0.00         2.00        12.00         0.00
    14720.00      1112.00      1052.00       852.00        68.00
        6.00         0.00         2.00         0.00         0.00
     1704.00       312.00       138.00       116.00        12.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                          0.00       0.00       0.00          0
1 (label_id: 1)                                        100.00      33.33      50.00        174
-------------------
micro avg                                               33.33      33.33      33.33        174
macro avg                                               50.00      16.67      25.00        174
weighted avg                                           100.00      33.33      50.00        174

-------------------
           0           1
        0.00       116.00
        0.00        58.00
-------------------

[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          80.97      99.92      89.45     279905
# (label_id: 1)                                         98.08      23.85      38.37      28888
, (label_id: 2)                                          0.00       0.00       0.00      24187
. (label_id: 3)                                          0.00       0.00       0.00      18071
? (label_id: 4)                                          0.00       0.00       0.00       1490
-------------------
micro avg                                               81.29      81.29      81.29     352541
macro avg                                               35.81      24.75      25.56     352541
weighted avg                                            72.33      81.29      74.17     352541

-------------------
                       #           ,           .           ?
   279673.00     21989.00     24171.00     18071.00      1490.00
      135.00      6890.00         0.00         0.00         0.00
       24.00         0.00         0.00         0.00         0.00
        0.00         1.00         0.00         0.00         0.00
       73.00         8.00        16.00         0.00         0.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                          0.00       0.00       0.00          0
1 (label_id: 1)                                        100.00     100.00     100.00       2968
-------------------
micro avg                                              100.00     100.00     100.00       2968
macro avg                                               50.00      50.00      50.00       2968
weighted avg                                           100.00     100.00     100.00       2968

-------------------
           0           1
        0.00         0.00
        0.00      2968.00
-------------------

[INFO] - Epoch 0, global step 12: val_loss reached 124.04999 (best 124.04999), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-01_21-33-33/checkpoints/Punctuation_with_Domain_discriminator---val_loss=124.05-epoch=0.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          83.44      99.41      90.73     279905
# (label_id: 1)                                         90.89      60.01      72.29      28888
, (label_id: 2)                                          0.00       0.00       0.00      24187
. (label_id: 3)                                          0.00       0.00       0.00      18071
? (label_id: 4)                                          0.00       0.00       0.00       1490
-------------------
micro avg                                               83.85      83.85      83.85     352541
macro avg                                               34.87      31.88      32.60     352541
weighted avg                                            73.70      83.85      77.96     352541

-------------------
                       #           ,           .           ?
   278253.00     11553.00     24110.00     18063.00      1490.00
     1652.00     17335.00        77.00         8.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                          0.00       0.00       0.00          0
1 (label_id: 1)                                        100.00     100.00     100.00       2968
-------------------
micro avg                                              100.00     100.00     100.00       2968
macro avg                                               50.00      50.00      50.00       2968
weighted avg                                           100.00     100.00     100.00       2968

-------------------
           0           1
        0.00         0.00
        0.00      2968.00
-------------------

[INFO] - Epoch 1, global step 25: val_loss reached 108.24886 (best 108.24886), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-01_21-33-33/checkpoints/Punctuation_with_Domain_discriminator---val_loss=108.25-epoch=1.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          83.23      99.86      90.79     279905
# (label_id: 1)                                         97.42      56.30      71.36      28888
, (label_id: 2)                                          0.00       0.00       0.00      24187
. (label_id: 3)                                          0.00       0.00       0.00      18071
? (label_id: 4)                                          0.00       0.00       0.00       1490
-------------------
micro avg                                               83.90      83.90      83.90     352541
macro avg                                               36.13      31.23      32.43     352541
weighted avg                                            74.06      83.90      77.93     352541

-------------------
                       #           ,           .           ?
   279519.00     12624.00     24142.00     18071.00      1490.00
      386.00     16264.00        45.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                          0.00       0.00       0.00          0
1 (label_id: 1)                                        100.00     100.00     100.00       2968
-------------------
micro avg                                              100.00     100.00     100.00       2968
macro avg                                               50.00      50.00      50.00       2968
weighted avg                                           100.00     100.00     100.00       2968

-------------------
           0           1
        0.00         0.00
        0.00      2968.00
-------------------

[INFO] - Epoch 2, global step 38: val_loss reached 97.27077 (best 97.27077), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-01_21-33-33/checkpoints/Punctuation_with_Domain_discriminator---val_loss=97.27-epoch=2.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          83.36      99.92      90.90     279905
# (label_id: 1)                                         98.25      57.93      72.89      28888
, (label_id: 2)                                          0.00       0.00       0.00      24187
. (label_id: 3)                                          0.00       0.00       0.00      18071
? (label_id: 4)                                          0.00       0.00       0.00       1490
-------------------
micro avg                                               84.08      84.08      84.08     352541
macro avg                                               36.32      31.57      32.76     352541
weighted avg                                            74.24      84.08      78.14     352541

-------------------
                       #           ,           .           ?
   279695.00     12152.00     24126.00     18044.00      1490.00
      210.00     16736.00        61.00        27.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                          0.00       0.00       0.00          0
1 (label_id: 1)                                        100.00     100.00     100.00       2968
-------------------
micro avg                                              100.00     100.00     100.00       2968
macro avg                                               50.00      50.00      50.00       2968
weighted avg                                           100.00     100.00     100.00       2968

-------------------
           0           1
        0.00         0.00
        0.00      2968.00
-------------------

[INFO] - Epoch 3, global step 51: val_loss reached 90.53589 (best 90.53589), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-01_21-33-33/checkpoints/Punctuation_with_Domain_discriminator---val_loss=90.54-epoch=3.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          83.34      99.96      90.89     279905
# (label_id: 1)                                         98.71      57.47      72.64      28888
, (label_id: 2)                                          0.00       0.00       0.00      24187
. (label_id: 3)                                          0.00       0.00       0.00      18071
? (label_id: 4)                                          0.00       0.00       0.00       1490
-------------------
micro avg                                               84.07      84.07      84.07     352541
macro avg                                               36.41      31.48      32.71     352541
weighted avg                                            74.26      84.07      78.12     352541

-------------------
                       #           ,           .           ?
   279784.00     12287.00     24126.00     18036.00      1490.00
      121.00     16601.00        61.00        35.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                          0.00       0.00       0.00          0
1 (label_id: 1)                                        100.00     100.00     100.00       2968
-------------------
micro avg                                              100.00     100.00     100.00       2968
macro avg                                               50.00      50.00      50.00       2968
weighted avg                                           100.00     100.00     100.00       2968

-------------------
           0           1
        0.00         0.00
        0.00      2968.00
-------------------

[INFO] - Epoch 4, global step 64: val_loss reached 86.89617 (best 86.89617), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-01_21-33-33/checkpoints/Punctuation_with_Domain_discriminator---val_loss=86.90-epoch=4.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          83.30      99.94      90.86     279905
# (label_id: 1)                                         98.41      56.92      72.12      28888
, (label_id: 2)                                          0.00       0.00       0.00      24187
. (label_id: 3)                                          0.00       0.00       0.00      18071
? (label_id: 4)                                          0.00       0.00       0.00       1490
-------------------
micro avg                                               84.01      84.01      84.01     352541
macro avg                                               36.34      31.37      32.60     352541
weighted avg                                            74.20      84.01      78.05     352541

-------------------
                       #           ,           .           ?
   279736.00     12445.00     24126.00     18036.00      1490.00
      169.00     16443.00        61.00        35.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                          0.00       0.00       0.00          0
1 (label_id: 1)                                        100.00     100.00     100.00       2968
-------------------
micro avg                                              100.00     100.00     100.00       2968
macro avg                                               50.00      50.00      50.00       2968
weighted avg                                           100.00     100.00     100.00       2968

-------------------
           0           1
        0.00         0.00
        0.00      2968.00
-------------------

[INFO] - Epoch 5, global step 77: val_loss reached 85.16472 (best 85.16472), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-01_21-33-33/checkpoints/Punctuation_with_Domain_discriminator---val_loss=85.16-epoch=5.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          83.25      99.94      90.83     279905
# (label_id: 1)                                         98.39      56.24      71.57      28888
, (label_id: 2)                                          0.00       0.00       0.00      24187
. (label_id: 3)                                          0.00       0.00       0.00      18071
? (label_id: 4)                                          0.00       0.00       0.00       1490
-------------------
micro avg                                               83.96      83.96      83.96     352541
macro avg                                               36.33      31.24      32.48     352541
weighted avg                                            74.16      83.96      77.98     352541

-------------------
                       #           ,           .           ?
   279735.00     12641.00     24126.00     18036.00      1490.00
      170.00     16247.00        61.00        35.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                          0.00       0.00       0.00          0
1 (label_id: 1)                                        100.00     100.00     100.00       2968
-------------------
micro avg                                              100.00     100.00     100.00       2968
macro avg                                               50.00      50.00      50.00       2968
weighted avg                                           100.00     100.00     100.00       2968

-------------------
           0           1
        0.00         0.00
        0.00      2968.00
-------------------

[INFO] - Epoch 6, global step 90: val_loss reached 84.53021 (best 84.53021), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-01_21-33-33/checkpoints/Punctuation_with_Domain_discriminator---val_loss=84.53-epoch=6.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          83.24      99.94      90.83     279905
# (label_id: 1)                                         98.38      56.19      71.53      28888
, (label_id: 2)                                          0.00       0.00       0.00      24187
. (label_id: 3)                                          0.00       0.00       0.00      18071
? (label_id: 4)                                          0.00       0.00       0.00       1490
-------------------
micro avg                                               83.95      83.95      83.95     352541
macro avg                                               36.32      31.23      32.47     352541
weighted avg                                            74.15      83.95      77.98     352541

-------------------
                       #           ,           .           ?
   279735.00     12656.00     24124.00     18036.00      1490.00
      170.00     16232.00        63.00        35.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                          0.00       0.00       0.00          0
1 (label_id: 1)                                        100.00     100.00     100.00       2968
-------------------
micro avg                                              100.00     100.00     100.00       2968
macro avg                                               50.00      50.00      50.00       2968
weighted avg                                           100.00     100.00     100.00       2968

-------------------
           0           1
        0.00         0.00
        0.00      2968.00
-------------------

[INFO] - Epoch 7, global step 103: val_loss reached 84.43227 (best 84.43227), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-01_21-33-33/checkpoints/Punctuation_with_Domain_discriminator---val_loss=84.43-epoch=7.ckpt" as top 3
[INFO] - Saving latest checkpoint...
[INFO] - Global seed set to 42
[INFO] - Optimizer config = AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.001
    weight_decay: 0.0
)
[INFO] - Scheduler "<core.optim.lr_scheduler.CosineAnnealing object at 0x7f49f5b88520>" 
will be used during training (effective maximum steps = 104) - 
Parameters : 
(warmup_steps: null
warmup_ratio: 0.1
min_lr: 1.0e-08
last_epoch: -1
max_steps: 104
)
[INFO] - 
  | Name                       | Type                 | Params
--------------------------------------------------------------------
0 | transformer                | ElectraModel         | 108 M 
1 | punct_classifier           | TokenClassifier      | 3.8 K 
2 | domain_classifier          | SequenceClassifier   | 3.1 K 
3 | punctuation_loss           | LinearChainCRF       | 35    
4 | domain_loss                | CrossEntropyLoss     | 0     
5 | agg_loss                   | AggregatorLoss       | 0     
6 | punct_class_report         | ClassificationReport | 0     
7 | chunked_punct_class_report | ClassificationReport | 0     
8 | domain_class_report        | ClassificationReport | 0     
--------------------------------------------------------------------
7.1 M     Trainable params
101 M     Non-trainable params
108 M     Total params
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          84.74      99.96      91.72      16566
# (label_id: 1)                                         98.72      52.95      68.93       1458
, (label_id: 2)                                          0.00       0.00       0.00       1210
. (label_id: 3)                                          0.00       0.00       0.00       1008
? (label_id: 4)                                          0.00       0.00       0.00         82
-------------------
micro avg                                               85.28      85.28      85.28      20324
macro avg                                               36.69      30.58      32.13      20324
weighted avg                                            76.15      85.28      79.71      20324

-------------------
                       #           ,           .           ?
    16560.00       686.00      1208.00      1006.00        82.00
        6.00       772.00         2.00         2.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                          0.00       0.00       0.00          0
1 (label_id: 1)                                        100.00     100.00     100.00        174
-------------------
micro avg                                              100.00     100.00     100.00        174
macro avg                                               50.00      50.00      50.00        174
weighted avg                                           100.00     100.00     100.00        174

-------------------
           0           1
        0.00         0.00
        0.00       174.00
-------------------

[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          83.25      99.94      90.83     279905
# (label_id: 1)                                         98.38      56.24      71.57      28888
, (label_id: 2)                                          0.00       0.00       0.00      24187
. (label_id: 3)                                          0.00       0.00       0.00      18071
? (label_id: 4)                                          0.00       0.00       0.00       1490
-------------------
micro avg                                               83.96      83.96      83.96     352541
macro avg                                               36.33      31.24      32.48     352541
weighted avg                                            74.16      83.96      77.98     352541

-------------------
                       #           ,           .           ?
   279735.00     12640.00     24124.00     18036.00      1490.00
      170.00     16248.00        63.00        35.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                          0.00       0.00       0.00          0
1 (label_id: 1)                                        100.00     100.00     100.00       2968
-------------------
micro avg                                              100.00     100.00     100.00       2968
macro avg                                               50.00      50.00      50.00       2968
weighted avg                                           100.00     100.00     100.00       2968

-------------------
           0           1
        0.00         0.00
        0.00      2968.00
-------------------

[INFO] - Epoch 0, global step 116: val_loss reached 84.43176 (best 84.43176), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-01_21-33-33/checkpoints/Punctuation_with_Domain_discriminator---val_loss=84.43-epoch=0.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          83.25      99.94      90.83     279905
# (label_id: 1)                                         98.38      56.24      71.57      28888
, (label_id: 2)                                          0.00       0.00       0.00      24187
. (label_id: 3)                                          0.00       0.00       0.00      18071
? (label_id: 4)                                          0.00       0.00       0.00       1490
-------------------
micro avg                                               83.96      83.96      83.96     352541
macro avg                                               36.33      31.24      32.48     352541
weighted avg                                            74.16      83.96      77.98     352541

-------------------
                       #           ,           .           ?
   279735.00     12640.00     24124.00     18036.00      1490.00
      170.00     16248.00        63.00        35.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                          0.00       0.00       0.00          0
1 (label_id: 1)                                        100.00     100.00     100.00       2968
-------------------
micro avg                                              100.00     100.00     100.00       2968
macro avg                                               50.00      50.00      50.00       2968
weighted avg                                           100.00     100.00     100.00       2968

-------------------
           0           1
        0.00         0.00
        0.00      2968.00
-------------------

[INFO] - Epoch 1, global step 129: val_loss reached 84.43138 (best 84.43138), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-01_21-33-33/checkpoints/Punctuation_with_Domain_discriminator---val_loss=84.43-epoch=1.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          83.25      99.94      90.83     279905
# (label_id: 1)                                         98.38      56.24      71.57      28888
, (label_id: 2)                                          0.00       0.00       0.00      24187
. (label_id: 3)                                          0.00       0.00       0.00      18071
? (label_id: 4)                                          0.00       0.00       0.00       1490
-------------------
micro avg                                               83.96      83.96      83.96     352541
macro avg                                               36.33      31.24      32.48     352541
weighted avg                                            74.16      83.96      77.98     352541

-------------------
                       #           ,           .           ?
   279735.00     12640.00     24124.00     18036.00      1490.00
      170.00     16248.00        63.00        35.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                          0.00       0.00       0.00          0
1 (label_id: 1)                                        100.00     100.00     100.00       2968
-------------------
micro avg                                              100.00     100.00     100.00       2968
macro avg                                               50.00      50.00      50.00       2968
weighted avg                                           100.00     100.00     100.00       2968

-------------------
           0           1
        0.00         0.00
        0.00      2968.00
-------------------

[INFO] - Epoch 2, global step 142: val_loss reached 84.43092 (best 84.43092), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-01_21-33-33/checkpoints/Punctuation_with_Domain_discriminator---val_loss=84.43-epoch=2.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          83.25      99.94      90.83     279905
# (label_id: 1)                                         98.38      56.24      71.57      28888
, (label_id: 2)                                          0.00       0.00       0.00      24187
. (label_id: 3)                                          0.00       0.00       0.00      18071
? (label_id: 4)                                          0.00       0.00       0.00       1490
-------------------
micro avg                                               83.96      83.96      83.96     352541
macro avg                                               36.33      31.24      32.48     352541
weighted avg                                            74.16      83.96      77.98     352541

-------------------
                       #           ,           .           ?
   279735.00     12640.00     24124.00     18036.00      1490.00
      170.00     16248.00        63.00        35.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                          0.00       0.00       0.00          0
1 (label_id: 1)                                        100.00     100.00     100.00       2968
-------------------
micro avg                                              100.00     100.00     100.00       2968
macro avg                                               50.00      50.00      50.00       2968
weighted avg                                           100.00     100.00     100.00       2968

-------------------
           0           1
        0.00         0.00
        0.00      2968.00
-------------------

[INFO] - Epoch 3, global step 155: val_loss reached 84.43053 (best 84.43053), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-01_21-33-33/checkpoints/Punctuation_with_Domain_discriminator---val_loss=84.43-epoch=3.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          83.25      99.94      90.83     279905
# (label_id: 1)                                         98.38      56.24      71.57      28888
, (label_id: 2)                                          0.00       0.00       0.00      24187
. (label_id: 3)                                          0.00       0.00       0.00      18071
? (label_id: 4)                                          0.00       0.00       0.00       1490
-------------------
micro avg                                               83.96      83.96      83.96     352541
macro avg                                               36.33      31.24      32.48     352541
weighted avg                                            74.16      83.96      77.98     352541

-------------------
                       #           ,           .           ?
   279735.00     12640.00     24124.00     18036.00      1490.00
      170.00     16248.00        63.00        35.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                          0.00       0.00       0.00          0
1 (label_id: 1)                                        100.00     100.00     100.00       2968
-------------------
micro avg                                              100.00     100.00     100.00       2968
macro avg                                               50.00      50.00      50.00       2968
weighted avg                                           100.00     100.00     100.00       2968

-------------------
           0           1
        0.00         0.00
        0.00      2968.00
-------------------

[INFO] - Epoch 4, global step 168: val_loss reached 84.43011 (best 84.43011), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-01_21-33-33/checkpoints/Punctuation_with_Domain_discriminator---val_loss=84.43-epoch=4.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          83.25      99.94      90.83     279905
# (label_id: 1)                                         98.38      56.24      71.57      28888
, (label_id: 2)                                          0.00       0.00       0.00      24187
. (label_id: 3)                                          0.00       0.00       0.00      18071
? (label_id: 4)                                          0.00       0.00       0.00       1490
-------------------
micro avg                                               83.96      83.96      83.96     352541
macro avg                                               36.33      31.24      32.48     352541
weighted avg                                            74.16      83.96      77.98     352541

-------------------
                       #           ,           .           ?
   279735.00     12640.00     24124.00     18036.00      1490.00
      170.00     16248.00        63.00        35.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                          0.00       0.00       0.00          0
1 (label_id: 1)                                        100.00     100.00     100.00       2968
-------------------
micro avg                                              100.00     100.00     100.00       2968
macro avg                                               50.00      50.00      50.00       2968
weighted avg                                           100.00     100.00     100.00       2968

-------------------
           0           1
        0.00         0.00
        0.00      2968.00
-------------------

[INFO] - Epoch 5, global step 181: val_loss reached 84.42976 (best 84.42976), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-01_21-33-33/checkpoints/Punctuation_with_Domain_discriminator---val_loss=84.43-epoch=5.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          83.25      99.94      90.83     279905
# (label_id: 1)                                         98.38      56.24      71.57      28888
, (label_id: 2)                                          0.00       0.00       0.00      24187
. (label_id: 3)                                          0.00       0.00       0.00      18071
? (label_id: 4)                                          0.00       0.00       0.00       1490
-------------------
micro avg                                               83.96      83.96      83.96     352541
macro avg                                               36.33      31.24      32.48     352541
weighted avg                                            74.16      83.96      77.98     352541

-------------------
                       #           ,           .           ?
   279735.00     12640.00     24124.00     18036.00      1490.00
      170.00     16248.00        63.00        35.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                          0.00       0.00       0.00          0
1 (label_id: 1)                                        100.00     100.00     100.00       2968
-------------------
micro avg                                              100.00     100.00     100.00       2968
macro avg                                               50.00      50.00      50.00       2968
weighted avg                                           100.00     100.00     100.00       2968

-------------------
           0           1
        0.00         0.00
        0.00      2968.00
-------------------

[INFO] - Epoch 6, global step 194: val_loss reached 84.42931 (best 84.42931), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-01_21-33-33/checkpoints/Punctuation_with_Domain_discriminator---val_loss=84.43-epoch=6.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          83.25      99.94      90.83     279905
# (label_id: 1)                                         98.38      56.24      71.57      28888
, (label_id: 2)                                          0.00       0.00       0.00      24187
. (label_id: 3)                                          0.00       0.00       0.00      18071
? (label_id: 4)                                          0.00       0.00       0.00       1490
-------------------
micro avg                                               83.96      83.96      83.96     352541
macro avg                                               36.33      31.24      32.48     352541
weighted avg                                            74.16      83.96      77.98     352541

-------------------
                       #           ,           .           ?
   279735.00     12640.00     24124.00     18036.00      1490.00
      170.00     16248.00        63.00        35.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                          0.00       0.00       0.00          0
1 (label_id: 1)                                        100.00     100.00     100.00       2968
-------------------
micro avg                                              100.00     100.00     100.00       2968
macro avg                                               50.00      50.00      50.00       2968
weighted avg                                           100.00     100.00     100.00       2968

-------------------
           0           1
        0.00         0.00
        0.00      2968.00
-------------------

[INFO] - Epoch 7, global step 207: val_loss reached 84.42889 (best 84.42889), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-01_21-33-33/checkpoints/Punctuation_with_Domain_discriminator---val_loss=84.43-epoch=7.ckpt" as top 3
[INFO] - Global seed set to 42
[INFO] - Optimizer config = AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0001
    weight_decay: 0.0
)
[INFO] - Scheduler "<core.optim.lr_scheduler.CosineAnnealing object at 0x7f49f5bf2d30>" 
will be used during training (effective maximum steps = 104) - 
Parameters : 
(warmup_steps: null
warmup_ratio: 0.1
min_lr: 1.0e-08
last_epoch: -1
max_steps: 104
)
[INFO] - 
  | Name                       | Type                 | Params
--------------------------------------------------------------------
0 | transformer                | ElectraModel         | 108 M 
1 | punct_classifier           | TokenClassifier      | 3.8 K 
2 | domain_classifier          | SequenceClassifier   | 3.1 K 
3 | punctuation_loss           | LinearChainCRF       | 35    
4 | domain_loss                | CrossEntropyLoss     | 0     
5 | agg_loss                   | AggregatorLoss       | 0     
6 | punct_class_report         | ClassificationReport | 0     
7 | chunked_punct_class_report | ClassificationReport | 0     
8 | domain_class_report        | ClassificationReport | 0     
--------------------------------------------------------------------
14.2 M    Trainable params
94.7 M    Non-trainable params
108 M     Total params
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          84.74      99.96      91.72      16566
# (label_id: 1)                                         98.72      52.95      68.93       1458
, (label_id: 2)                                          0.00       0.00       0.00       1210
. (label_id: 3)                                          0.00       0.00       0.00       1008
? (label_id: 4)                                          0.00       0.00       0.00         82
-------------------
micro avg                                               85.28      85.28      85.28      20324
macro avg                                               36.69      30.58      32.13      20324
weighted avg                                            76.15      85.28      79.71      20324

-------------------
                       #           ,           .           ?
    16560.00       686.00      1208.00      1006.00        82.00
        6.00       772.00         2.00         2.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                          0.00       0.00       0.00          0
1 (label_id: 1)                                        100.00     100.00     100.00        174
-------------------
micro avg                                              100.00     100.00     100.00        174
macro avg                                               50.00      50.00      50.00        174
weighted avg                                           100.00     100.00     100.00        174

-------------------
           0           1
        0.00         0.00
        0.00       174.00
-------------------

[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          83.25      99.94      90.83     279905
# (label_id: 1)                                         98.38      56.24      71.57      28888
, (label_id: 2)                                          0.00       0.00       0.00      24187
. (label_id: 3)                                          0.00       0.00       0.00      18071
? (label_id: 4)                                          0.00       0.00       0.00       1490
-------------------
micro avg                                               83.96      83.96      83.96     352541
macro avg                                               36.33      31.24      32.48     352541
weighted avg                                            74.16      83.96      77.98     352541

-------------------
                       #           ,           .           ?
   279735.00     12640.00     24124.00     18036.00      1490.00
      170.00     16248.00        63.00        35.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                          0.00       0.00       0.00          0
1 (label_id: 1)                                        100.00     100.00     100.00       2968
-------------------
micro avg                                              100.00     100.00     100.00       2968
macro avg                                               50.00      50.00      50.00       2968
weighted avg                                           100.00     100.00     100.00       2968

-------------------
           0           1
        0.00         0.00
        0.00      2968.00
-------------------

[INFO] - Epoch 0, global step 220: val_loss reached 84.42802 (best 84.42802), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-01_21-33-33/checkpoints/Punctuation_with_Domain_discriminator---val_loss=84.43-epoch=0.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          83.25      99.94      90.83     279905
# (label_id: 1)                                         98.38      56.24      71.57      28888
, (label_id: 2)                                          0.00       0.00       0.00      24187
. (label_id: 3)                                          0.00       0.00       0.00      18071
? (label_id: 4)                                          0.00       0.00       0.00       1490
-------------------
micro avg                                               83.96      83.96      83.96     352541
macro avg                                               36.33      31.24      32.48     352541
weighted avg                                            74.16      83.96      77.98     352541

-------------------
                       #           ,           .           ?
   279735.00     12640.00     24124.00     18036.00      1490.00
      170.00     16248.00        63.00        35.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                          0.00       0.00       0.00          0
1 (label_id: 1)                                        100.00     100.00     100.00       2968
-------------------
micro avg                                              100.00     100.00     100.00       2968
macro avg                                               50.00      50.00      50.00       2968
weighted avg                                           100.00     100.00     100.00       2968

-------------------
           0           1
        0.00         0.00
        0.00      2968.00
-------------------

[INFO] - Epoch 1, global step 233: val_loss reached 84.42709 (best 84.42709), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-01_21-33-33/checkpoints/Punctuation_with_Domain_discriminator---val_loss=84.43-epoch=1.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          83.25      99.94      90.83     279905
# (label_id: 1)                                         98.38      56.24      71.57      28888
, (label_id: 2)                                          0.00       0.00       0.00      24187
. (label_id: 3)                                          0.00       0.00       0.00      18071
? (label_id: 4)                                          0.00       0.00       0.00       1490
-------------------
micro avg                                               83.96      83.96      83.96     352541
macro avg                                               36.33      31.24      32.48     352541
weighted avg                                            74.16      83.96      77.98     352541

-------------------
                       #           ,           .           ?
   279735.00     12640.00     24124.00     18036.00      1490.00
      170.00     16248.00        63.00        35.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                          0.00       0.00       0.00          0
1 (label_id: 1)                                        100.00     100.00     100.00       2968
-------------------
micro avg                                              100.00     100.00     100.00       2968
macro avg                                               50.00      50.00      50.00       2968
weighted avg                                           100.00     100.00     100.00       2968

-------------------
           0           1
        0.00         0.00
        0.00      2968.00
-------------------

[INFO] - Epoch 2, global step 246: val_loss reached 84.42627 (best 84.42627), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-01_21-33-33/checkpoints/Punctuation_with_Domain_discriminator---val_loss=84.43-epoch=2.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          83.25      99.94      90.83     279905
# (label_id: 1)                                         98.38      56.24      71.57      28888
, (label_id: 2)                                          0.00       0.00       0.00      24187
. (label_id: 3)                                          0.00       0.00       0.00      18071
? (label_id: 4)                                          0.00       0.00       0.00       1490
-------------------
micro avg                                               83.96      83.96      83.96     352541
macro avg                                               36.33      31.24      32.48     352541
weighted avg                                            74.16      83.96      77.98     352541

-------------------
                       #           ,           .           ?
   279735.00     12640.00     24124.00     18036.00      1490.00
      170.00     16248.00        63.00        35.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                          0.00       0.00       0.00          0
1 (label_id: 1)                                        100.00     100.00     100.00       2968
-------------------
micro avg                                              100.00     100.00     100.00       2968
macro avg                                               50.00      50.00      50.00       2968
weighted avg                                           100.00     100.00     100.00       2968

-------------------
           0           1
        0.00         0.00
        0.00      2968.00
-------------------

[INFO] - Epoch 3, global step 259: val_loss reached 84.42544 (best 84.42544), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-01_21-33-33/checkpoints/Punctuation_with_Domain_discriminator---val_loss=84.43-epoch=3.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          83.25      99.94      90.83     279905
# (label_id: 1)                                         98.38      56.24      71.57      28888
, (label_id: 2)                                          0.00       0.00       0.00      24187
. (label_id: 3)                                          0.00       0.00       0.00      18071
? (label_id: 4)                                          0.00       0.00       0.00       1490
-------------------
micro avg                                               83.96      83.96      83.96     352541
macro avg                                               36.33      31.24      32.48     352541
weighted avg                                            74.16      83.96      77.98     352541

-------------------
                       #           ,           .           ?
   279735.00     12640.00     24124.00     18036.00      1490.00
      170.00     16248.00        63.00        35.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                          0.00       0.00       0.00          0
1 (label_id: 1)                                        100.00     100.00     100.00       2968
-------------------
micro avg                                              100.00     100.00     100.00       2968
macro avg                                               50.00      50.00      50.00       2968
weighted avg                                           100.00     100.00     100.00       2968

-------------------
           0           1
        0.00         0.00
        0.00      2968.00
-------------------

[INFO] - Epoch 4, global step 272: val_loss reached 84.42443 (best 84.42443), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-01_21-33-33/checkpoints/Punctuation_with_Domain_discriminator---val_loss=84.42-epoch=4.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          83.25      99.94      90.83     279905
# (label_id: 1)                                         98.38      56.25      71.58      28888
, (label_id: 2)                                          0.00       0.00       0.00      24187
. (label_id: 3)                                          0.00       0.00       0.00      18071
? (label_id: 4)                                          0.00       0.00       0.00       1490
-------------------
micro avg                                               83.96      83.96      83.96     352541
macro avg                                               36.33      31.24      32.48     352541
weighted avg                                            74.16      83.96      77.98     352541

-------------------
                       #           ,           .           ?
   279735.00     12638.00     24124.00     18036.00      1490.00
      170.00     16250.00        63.00        35.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                          0.00       0.00       0.00          0
1 (label_id: 1)                                        100.00     100.00     100.00       2968
-------------------
micro avg                                              100.00     100.00     100.00       2968
macro avg                                               50.00      50.00      50.00       2968
weighted avg                                           100.00     100.00     100.00       2968

-------------------
           0           1
        0.00         0.00
        0.00      2968.00
-------------------

[INFO] - Epoch 5, global step 285: val_loss reached 84.42360 (best 84.42360), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-01_21-33-33/checkpoints/Punctuation_with_Domain_discriminator---val_loss=84.42-epoch=5.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          83.25      99.94      90.83     279905
# (label_id: 1)                                         98.38      56.25      71.58      28888
, (label_id: 2)                                          0.00       0.00       0.00      24187
. (label_id: 3)                                          0.00       0.00       0.00      18071
? (label_id: 4)                                          0.00       0.00       0.00       1490
-------------------
micro avg                                               83.96      83.96      83.96     352541
macro avg                                               36.33      31.24      32.48     352541
weighted avg                                            74.16      83.96      77.98     352541

-------------------
                       #           ,           .           ?
   279735.00     12638.00     24124.00     18036.00      1490.00
      170.00     16250.00        63.00        35.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                          0.00       0.00       0.00          0
1 (label_id: 1)                                        100.00     100.00     100.00       2968
-------------------
micro avg                                              100.00     100.00     100.00       2968
macro avg                                               50.00      50.00      50.00       2968
weighted avg                                           100.00     100.00     100.00       2968

-------------------
           0           1
        0.00         0.00
        0.00      2968.00
-------------------

[INFO] - Epoch 6, global step 298: val_loss reached 84.42275 (best 84.42275), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-01_21-33-33/checkpoints/Punctuation_with_Domain_discriminator---val_loss=84.42-epoch=6.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          83.25      99.94      90.83     279905
# (label_id: 1)                                         98.38      56.25      71.58      28888
, (label_id: 2)                                          0.00       0.00       0.00      24187
. (label_id: 3)                                          0.00       0.00       0.00      18071
? (label_id: 4)                                          0.00       0.00       0.00       1490
-------------------
micro avg                                               83.96      83.96      83.96     352541
macro avg                                               36.33      31.24      32.48     352541
weighted avg                                            74.16      83.96      77.98     352541

-------------------
                       #           ,           .           ?
   279735.00     12638.00     24124.00     18036.00      1490.00
      170.00     16250.00        63.00        35.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                          0.00       0.00       0.00          0
1 (label_id: 1)                                        100.00     100.00     100.00       2968
-------------------
micro avg                                              100.00     100.00     100.00       2968
macro avg                                               50.00      50.00      50.00       2968
weighted avg                                           100.00     100.00     100.00       2968

-------------------
           0           1
        0.00         0.00
        0.00      2968.00
-------------------

[INFO] - Epoch 7, global step 311: val_loss reached 84.42195 (best 84.42195), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-01_21-33-33/checkpoints/Punctuation_with_Domain_discriminator---val_loss=84.42-epoch=7.ckpt" as top 3
[INFO] - Global seed set to 42
[INFO] - Optimizer config = AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0001
    weight_decay: 0.0
)
[INFO] - Scheduler "<core.optim.lr_scheduler.CosineAnnealing object at 0x7f4a4c64f070>" 
will be used during training (effective maximum steps = 104) - 
Parameters : 
(warmup_steps: null
warmup_ratio: 0.1
min_lr: 1.0e-08
last_epoch: -1
max_steps: 104
)
[INFO] - 
  | Name                       | Type                 | Params
--------------------------------------------------------------------
0 | transformer                | ElectraModel         | 108 M 
1 | punct_classifier           | TokenClassifier      | 3.8 K 
2 | domain_classifier          | SequenceClassifier   | 3.1 K 
3 | punctuation_loss           | LinearChainCRF       | 35    
4 | domain_loss                | CrossEntropyLoss     | 0     
5 | agg_loss                   | AggregatorLoss       | 0     
6 | punct_class_report         | ClassificationReport | 0     
7 | chunked_punct_class_report | ClassificationReport | 0     
8 | domain_class_report        | ClassificationReport | 0     
--------------------------------------------------------------------
21.3 M    Trainable params
87.6 M    Non-trainable params
108 M     Total params
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          84.74      99.96      91.72      16566
# (label_id: 1)                                         98.72      52.95      68.93       1458
, (label_id: 2)                                          0.00       0.00       0.00       1210
. (label_id: 3)                                          0.00       0.00       0.00       1008
? (label_id: 4)                                          0.00       0.00       0.00         82
-------------------
micro avg                                               85.28      85.28      85.28      20324
macro avg                                               36.69      30.58      32.13      20324
weighted avg                                            76.15      85.28      79.71      20324

-------------------
                       #           ,           .           ?
    16560.00       686.00      1208.00      1006.00        82.00
        6.00       772.00         2.00         2.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                          0.00       0.00       0.00          0
1 (label_id: 1)                                        100.00     100.00     100.00        174
-------------------
micro avg                                              100.00     100.00     100.00        174
macro avg                                               50.00      50.00      50.00        174
weighted avg                                           100.00     100.00     100.00        174

-------------------
           0           1
        0.00         0.00
        0.00       174.00
-------------------

[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          83.25      99.94      90.83     279905
# (label_id: 1)                                         98.38      56.25      71.58      28888
, (label_id: 2)                                          0.00       0.00       0.00      24187
. (label_id: 3)                                          0.00       0.00       0.00      18071
? (label_id: 4)                                          0.00       0.00       0.00       1490
-------------------
micro avg                                               83.96      83.96      83.96     352541
macro avg                                               36.33      31.24      32.48     352541
weighted avg                                            74.16      83.96      77.98     352541

-------------------
                       #           ,           .           ?
   279735.00     12638.00     24124.00     18036.00      1490.00
      170.00     16250.00        63.00        35.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                          0.00       0.00       0.00          0
1 (label_id: 1)                                        100.00     100.00     100.00       2968
-------------------
micro avg                                              100.00     100.00     100.00       2968
macro avg                                               50.00      50.00      50.00       2968
weighted avg                                           100.00     100.00     100.00       2968

-------------------
           0           1
        0.00         0.00
        0.00      2968.00
-------------------

[INFO] - Epoch 0, global step 324: val_loss reached 84.42070 (best 84.42070), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-01_21-33-33/checkpoints/Punctuation_with_Domain_discriminator---val_loss=84.42-epoch=0.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          83.25      99.94      90.83     279905
# (label_id: 1)                                         98.38      56.25      71.58      28888
, (label_id: 2)                                          0.00       0.00       0.00      24187
. (label_id: 3)                                          0.00       0.00       0.00      18071
? (label_id: 4)                                          0.00       0.00       0.00       1490
-------------------
micro avg                                               83.96      83.96      83.96     352541
macro avg                                               36.33      31.24      32.48     352541
weighted avg                                            74.16      83.96      77.98     352541

-------------------
                       #           ,           .           ?
   279735.00     12638.00     24124.00     18036.00      1490.00
      170.00     16250.00        63.00        35.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                          0.00       0.00       0.00          0
1 (label_id: 1)                                        100.00     100.00     100.00       2968
-------------------
micro avg                                              100.00     100.00     100.00       2968
macro avg                                               50.00      50.00      50.00       2968
weighted avg                                           100.00     100.00     100.00       2968

-------------------
           0           1
        0.00         0.00
        0.00      2968.00
-------------------

[INFO] - Epoch 1, global step 337: val_loss reached 84.41957 (best 84.41957), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-01_21-33-33/checkpoints/Punctuation_with_Domain_discriminator---val_loss=84.42-epoch=1.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          83.25      99.94      90.83     279905
# (label_id: 1)                                         98.38      56.25      71.58      28888
, (label_id: 2)                                          0.00       0.00       0.00      24187
. (label_id: 3)                                          0.00       0.00       0.00      18071
? (label_id: 4)                                          0.00       0.00       0.00       1490
-------------------
micro avg                                               83.96      83.96      83.96     352541
macro avg                                               36.33      31.24      32.48     352541
weighted avg                                            74.16      83.96      77.98     352541

-------------------
                       #           ,           .           ?
   279735.00     12638.00     24124.00     18036.00      1490.00
      170.00     16250.00        63.00        35.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                          0.00       0.00       0.00          0
1 (label_id: 1)                                        100.00     100.00     100.00       2968
-------------------
micro avg                                              100.00     100.00     100.00       2968
macro avg                                               50.00      50.00      50.00       2968
weighted avg                                           100.00     100.00     100.00       2968

-------------------
           0           1
        0.00         0.00
        0.00      2968.00
-------------------

[INFO] - Epoch 2, global step 350: val_loss reached 84.41832 (best 84.41832), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-01_21-33-33/checkpoints/Punctuation_with_Domain_discriminator---val_loss=84.42-epoch=2.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          83.25      99.94      90.83     279905
# (label_id: 1)                                         98.38      56.25      71.58      28888
, (label_id: 2)                                          0.00       0.00       0.00      24187
. (label_id: 3)                                          0.00       0.00       0.00      18071
? (label_id: 4)                                          0.00       0.00       0.00       1490
-------------------
micro avg                                               83.96      83.96      83.96     352541
macro avg                                               36.33      31.24      32.48     352541
weighted avg                                            74.16      83.96      77.98     352541

-------------------
                       #           ,           .           ?
   279735.00     12638.00     24124.00     18036.00      1490.00
      170.00     16250.00        63.00        35.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                          0.00       0.00       0.00          0
1 (label_id: 1)                                        100.00     100.00     100.00       2968
-------------------
micro avg                                              100.00     100.00     100.00       2968
macro avg                                               50.00      50.00      50.00       2968
weighted avg                                           100.00     100.00     100.00       2968

-------------------
           0           1
        0.00         0.00
        0.00      2968.00
-------------------

[INFO] - Epoch 3, global step 363: val_loss reached 84.41717 (best 84.41717), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-01_21-33-33/checkpoints/Punctuation_with_Domain_discriminator---val_loss=84.42-epoch=3.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          83.25      99.94      90.83     279905
# (label_id: 1)                                         98.38      56.25      71.58      28888
, (label_id: 2)                                          0.00       0.00       0.00      24187
. (label_id: 3)                                          0.00       0.00       0.00      18071
? (label_id: 4)                                          0.00       0.00       0.00       1490
-------------------
micro avg                                               83.96      83.96      83.96     352541
macro avg                                               36.33      31.24      32.48     352541
weighted avg                                            74.16      83.96      77.98     352541

-------------------
                       #           ,           .           ?
   279735.00     12638.00     24124.00     18036.00      1490.00
      170.00     16250.00        63.00        35.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                          0.00       0.00       0.00          0
1 (label_id: 1)                                        100.00     100.00     100.00       2968
-------------------
micro avg                                              100.00     100.00     100.00       2968
macro avg                                               50.00      50.00      50.00       2968
weighted avg                                           100.00     100.00     100.00       2968

-------------------
           0           1
        0.00         0.00
        0.00      2968.00
-------------------

[INFO] - Epoch 4, global step 376: val_loss reached 84.41608 (best 84.41608), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-01_21-33-33/checkpoints/Punctuation_with_Domain_discriminator---val_loss=84.42-epoch=4.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          83.25      99.94      90.83     279905
# (label_id: 1)                                         98.38      56.25      71.58      28888
, (label_id: 2)                                          0.00       0.00       0.00      24187
. (label_id: 3)                                          0.00       0.00       0.00      18071
? (label_id: 4)                                          0.00       0.00       0.00       1490
-------------------
micro avg                                               83.96      83.96      83.96     352541
macro avg                                               36.33      31.24      32.48     352541
weighted avg                                            74.16      83.96      77.98     352541

-------------------
                       #           ,           .           ?
   279735.00     12638.00     24124.00     18036.00      1490.00
      170.00     16250.00        63.00        35.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                          0.00       0.00       0.00          0
1 (label_id: 1)                                        100.00     100.00     100.00       2968
-------------------
micro avg                                              100.00     100.00     100.00       2968
macro avg                                               50.00      50.00      50.00       2968
weighted avg                                           100.00     100.00     100.00       2968

-------------------
           0           1
        0.00         0.00
        0.00      2968.00
-------------------

[INFO] - Epoch 5, global step 389: val_loss reached 84.41490 (best 84.41490), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-01_21-33-33/checkpoints/Punctuation_with_Domain_discriminator---val_loss=84.41-epoch=5.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          83.25      99.94      90.83     279905
# (label_id: 1)                                         98.38      56.25      71.58      28888
, (label_id: 2)                                          0.00       0.00       0.00      24187
. (label_id: 3)                                          0.00       0.00       0.00      18071
? (label_id: 4)                                          0.00       0.00       0.00       1490
-------------------
micro avg                                               83.96      83.96      83.96     352541
macro avg                                               36.33      31.24      32.48     352541
weighted avg                                            74.16      83.96      77.98     352541

-------------------
                       #           ,           .           ?
   279735.00     12638.00     24124.00     18036.00      1490.00
      170.00     16250.00        63.00        35.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                          0.00       0.00       0.00          0
1 (label_id: 1)                                        100.00     100.00     100.00       2968
-------------------
micro avg                                              100.00     100.00     100.00       2968
macro avg                                               50.00      50.00      50.00       2968
weighted avg                                           100.00     100.00     100.00       2968

-------------------
           0           1
        0.00         0.00
        0.00      2968.00
-------------------

[INFO] - Epoch 6, global step 402: val_loss reached 84.41369 (best 84.41369), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-01_21-33-33/checkpoints/Punctuation_with_Domain_discriminator---val_loss=84.41-epoch=6.ckpt" as top 3
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          83.25      99.94      90.84     279905
# (label_id: 1)                                         98.38      56.31      71.62      28888
, (label_id: 2)                                          0.00       0.00       0.00      24187
. (label_id: 3)                                          0.00       0.00       0.00      18071
? (label_id: 4)                                          0.00       0.00       0.00       1490
-------------------
micro avg                                               83.96      83.96      83.96     352541
macro avg                                               36.33      31.25      32.49     352541
weighted avg                                            74.16      83.96      77.99     352541

-------------------
                       #           ,           .           ?
   279735.00     12622.00     24124.00     18036.00      1490.00
      170.00     16266.00        63.00        35.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                          0.00       0.00       0.00          0
1 (label_id: 1)                                        100.00     100.00     100.00       2968
-------------------
micro avg                                              100.00     100.00     100.00       2968
macro avg                                               50.00      50.00      50.00       2968
weighted avg                                           100.00     100.00     100.00       2968

-------------------
           0           1
        0.00         0.00
        0.00      2968.00
-------------------

[INFO] - Epoch 7, global step 415: val_loss reached 84.41257 (best 84.41257), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-01_21-33-33/checkpoints/Punctuation_with_Domain_discriminator---val_loss=84.41-epoch=7.ckpt" as top 3
[INFO] - GPU available: True, used: True
[INFO] - TPU available: None, using: 0 TPU cores
[INFO] - Using environment variable NODE_RANK for node rank (0).
[INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
[INFO] - Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          82.88      99.95      90.62     340743
# (label_id: 1)                                         98.76      57.86      72.97      35925
, (label_id: 2)                                          0.00       0.00       0.00      28478
. (label_id: 3)                                          0.00       0.00       0.00      24981
? (label_id: 4)                                          0.00       0.00       0.00       1869
-------------------
micro avg                                               83.65      83.65      83.65     431996
macro avg                                               36.33      31.56      32.72     431996
weighted avg                                            73.58      83.65      77.54     431996

-------------------
                       #           ,           .           ?
   340577.00     15137.00     28437.00     24935.00      1861.00
      166.00     20788.00        41.00        46.00         8.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
-------------------

[INFO] - Chunked Punctuation report: 
label                                                precision    recall       f1           support   
 (label_id: 0)                                          82.71      99.94      90.51     170805
# (label_id: 1)                                         98.67      58.55      73.49      18619
, (label_id: 2)                                          0.00       0.00       0.00      14415
. (label_id: 3)                                          0.00       0.00       0.00      12723
? (label_id: 4)                                          0.00       0.00       0.00        881
-------------------
micro avg                                               83.52      83.52      83.52     217443
macro avg                                               36.28      31.70      32.80     217443
weighted avg                                            73.42      83.52      77.39     217443

-------------------
                       #           ,           .           ?
   170708.00      7717.00     14383.00     12705.00       881.00
       97.00     10902.00        32.00        18.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
        0.00         0.00         0.00         0.00         0.00
-------------------

[INFO] - Domain report: 
label                                                precision    recall       f1           support   
0 (label_id: 0)                                          0.00       0.00       0.00          0
1 (label_id: 1)                                        100.00     100.00     100.00       3595
-------------------
micro avg                                              100.00     100.00     100.00       3595
macro avg                                               50.00      50.00      50.00       3595
weighted avg                                           100.00     100.00     100.00       3595

-------------------
           0           1
        0.00         0.00
        0.00      3595.00
-------------------

[INFO] - saving to /home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-01_21-33-33/test-ted-8.txt
[INFO] - Internal process exited
