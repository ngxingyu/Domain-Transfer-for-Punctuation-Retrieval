Global seed set to 42
GPU available: True, used: True
TPU available: None, using: 0 TPU cores
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Using native 16bit precision.
Global seed set to 42
initializing ddp: GLOBAL_RANK: 0, MEMBER: 1/1

  | Name                | Type                 | Params
-------------------------------------------------------------
0 | transformer         | ElectraModel         | 108 M 
1 | punct_classifier    | TokenClassifier      | 1.2 M 
2 | domain_classifier   | SequenceClassifier   | 3.1 K 
3 | punctuation_loss    | FocalDiceLoss        | 0     
4 | bilstm              | LSTM                 | 7.1 M 
5 | domain_loss         | CrossEntropyLoss     | 0     
6 | agg_loss            | AggregatorLoss       | 0     
7 | punct_class_report  | ClassificationReport | 0     
8 | domain_class_report | ClassificationReport | 0     
-------------------------------------------------------------
8.3 M     Trainable params
108 M     Non-trainable params
117 M     Total params
Epoch 0, global step 2626: val_loss reached 20.46924 (best 20.46924), saving model to "/home/nxingyu/project/Punctuation_with_Domain_discriminator/2021-02-16_16-54-27/checkpoints/Punctuation_with_Domain_discriminator---val_loss=20.47-epoch=0.ckpt" as top 3
Epoch 1, global step 5253: val_loss reached 14.17872 (best 14.17872), saving model to "/home/nxingyu/project/Punctuation_with_Domain_discriminator/2021-02-16_16-54-27/checkpoints/Punctuation_with_Domain_discriminator---val_loss=14.18-epoch=1.ckpt" as top 3
Epoch 2, global step 7880: val_loss reached 4.17692 (best 4.17692), saving model to "/home/nxingyu/project/Punctuation_with_Domain_discriminator/2021-02-16_16-54-27/checkpoints/Punctuation_with_Domain_discriminator---val_loss=4.18-epoch=2.ckpt" as top 3
Epoch 3, global step 10507: val_loss reached 5.65265 (best 4.17692), saving model to "/home/nxingyu/project/Punctuation_with_Domain_discriminator/2021-02-16_16-54-27/checkpoints/Punctuation_with_Domain_discriminator---val_loss=5.65-epoch=3.ckpt" as top 3
Epoch 4, step 13134: val_loss was not in top 3
Epoch 5, global step 15761: val_loss reached 9.80509 (best 4.17692), saving model to "/home/nxingyu/project/Punctuation_with_Domain_discriminator/2021-02-16_16-54-27/checkpoints/Punctuation_with_Domain_discriminator---val_loss=9.81-epoch=5.ckpt" as top 3
Epoch 6, global step 18388: val_loss reached 9.53892 (best 4.17692), saving model to "/home/nxingyu/project/Punctuation_with_Domain_discriminator/2021-02-16_16-54-27/checkpoints/Punctuation_with_Domain_discriminator---val_loss=9.54-epoch=6.ckpt" as top 3
Epoch 7, step 21015: val_loss was not in top 3
Epoch 8, step 23642: val_loss was not in top 3
Epoch 9, step 26269: val_loss was not in top 3
Epoch 10, global step 28896: val_loss reached 7.32525 (best 4.17692), saving model to "/home/nxingyu/project/Punctuation_with_Domain_discriminator/2021-02-16_16-54-27/checkpoints/Punctuation_with_Domain_discriminator---val_loss=7.33-epoch=10.ckpt" as top 3
Epoch 11, global step 31523: val_loss reached 5.84272 (best 4.17692), saving model to "/home/nxingyu/project/Punctuation_with_Domain_discriminator/2021-02-16_16-54-27/checkpoints/Punctuation_with_Domain_discriminator---val_loss=5.84-epoch=11.ckpt" as top 3
Epoch 12, global step 34150: val_loss reached 5.36715 (best 4.17692), saving model to "/home/nxingyu/project/Punctuation_with_Domain_discriminator/2021-02-16_16-54-27/checkpoints/Punctuation_with_Domain_discriminator---val_loss=5.37-epoch=12.ckpt" as top 3
Epoch 13, global step 36777: val_loss reached 4.04203 (best 4.04203), saving model to "/home/nxingyu/project/Punctuation_with_Domain_discriminator/2021-02-16_16-54-27/checkpoints/Punctuation_with_Domain_discriminator---val_loss=4.04-epoch=13.ckpt" as top 3
Epoch 14, global step 39404: val_loss reached 2.37999 (best 2.37999), saving model to "/home/nxingyu/project/Punctuation_with_Domain_discriminator/2021-02-16_16-54-27/checkpoints/Punctuation_with_Domain_discriminator---val_loss=2.38-epoch=14.ckpt" as top 3
Epoch 15, global step 42031: val_loss reached 2.31194 (best 2.31194), saving model to "/home/nxingyu/project/Punctuation_with_Domain_discriminator/2021-02-16_16-54-27/checkpoints/Punctuation_with_Domain_discriminator---val_loss=2.31-epoch=15.ckpt" as top 3
Epoch 16, global step 44658: val_loss reached 1.34128 (best 1.34128), saving model to "/home/nxingyu/project/Punctuation_with_Domain_discriminator/2021-02-16_16-54-27/checkpoints/Punctuation_with_Domain_discriminator---val_loss=1.34-epoch=16.ckpt" as top 3
Epoch 17, step 47285: val_loss was not in top 3
Epoch 18, global step 49912: val_loss reached 1.57048 (best 1.34128), saving model to "/home/nxingyu/project/Punctuation_with_Domain_discriminator/2021-02-16_16-54-27/checkpoints/Punctuation_with_Domain_discriminator---val_loss=1.57-epoch=18.ckpt" as top 3
Epoch 19, global step 52539: val_loss reached 1.74774 (best 1.34128), saving model to "/home/nxingyu/project/Punctuation_with_Domain_discriminator/2021-02-16_16-54-27/checkpoints/Punctuation_with_Domain_discriminator---val_loss=1.75-epoch=19.ckpt" as top 3
Saving latest checkpoint...
Global seed set to 42

  | Name                | Type                 | Params
-------------------------------------------------------------
0 | transformer         | ElectraModel         | 108 M 
1 | punct_classifier    | TokenClassifier      | 1.2 M 
2 | domain_classifier   | SequenceClassifier   | 3.1 K 
3 | punctuation_loss    | FocalDiceLoss        | 0     
4 | bilstm              | LSTM                 | 7.1 M 
5 | domain_loss         | CrossEntropyLoss     | 0     
6 | agg_loss            | AggregatorLoss       | 0     
7 | punct_class_report  | ClassificationReport | 0     
8 | domain_class_report | ClassificationReport | 0     
-------------------------------------------------------------
15.4 M    Trainable params
101 M     Non-trainable params
117 M     Total params
Epoch 0, global step 55166: val_loss reached 1.74770 (best 1.34128), saving model to "/home/nxingyu/project/Punctuation_with_Domain_discriminator/2021-02-16_16-54-27/checkpoints/Punctuation_with_Domain_discriminator---val_loss=1.75-epoch=0.ckpt" as top 3
Epoch 1, step 57793: val_loss was not in top 3
Epoch 2, step 60420: val_loss was not in top 3
Epoch 3, step 63047: val_loss was not in top 3
Epoch 4, step 65674: val_loss was not in top 3
Epoch 5, step 68301: val_loss was not in top 3
Epoch 6, global step 70928: val_loss reached 1.74754 (best 1.34128), saving model to "/home/nxingyu/project/Punctuation_with_Domain_discriminator/2021-02-16_16-54-27/checkpoints/Punctuation_with_Domain_discriminator---val_loss=1.75-epoch=6.ckpt" as top 3
Epoch 7, step 73555: val_loss was not in top 3
Epoch 8, step 76182: val_loss was not in top 3
Epoch 9, step 78809: val_loss was not in top 3
Epoch 10, step 81436: val_loss was not in top 3
Epoch 11, step 84063: val_loss was not in top 3
Epoch 12, step 86690: val_loss was not in top 3
Epoch 13, global step 89317: val_loss reached 1.74739 (best 1.34128), saving model to "/home/nxingyu/project/Punctuation_with_Domain_discriminator/2021-02-16_16-54-27/checkpoints/Punctuation_with_Domain_discriminator---val_loss=1.75-epoch=13.ckpt" as top 3
Epoch 14, step 91944: val_loss was not in top 3
Epoch 15, step 94571: val_loss was not in top 3
Epoch 16, step 97198: val_loss was not in top 3
Epoch 17, step 99825: val_loss was not in top 3
Epoch 18, step 102452: val_loss was not in top 3
Epoch 19, step 105079: val_loss was not in top 3
GPU available: True, used: True
TPU available: None, using: 0 TPU cores
Using environment variable NODE_RANK for node rank (0).
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
