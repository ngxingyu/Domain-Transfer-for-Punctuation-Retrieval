commit hash: df6d75722634ab0ca950ca79354c5225ca3262b6
diff --git a/Punctuation_with_Domain_discriminator/2021-03-01_09-28-23/cmd-args.log b/Punctuation_with_Domain_discriminator/2021-03-01_09-28-23/cmd-args.log
deleted file mode 100644
index 11a5d8e..0000000
--- a/Punctuation_with_Domain_discriminator/2021-03-01_09-28-23/cmd-args.log
+++ /dev/null
@@ -1 +0,0 @@
-main.py
\ No newline at end of file
diff --git a/Punctuation_with_Domain_discriminator/2021-03-01_09-28-23/events.out.tfevents.1614562167.intern-instance.25651.0 b/Punctuation_with_Domain_discriminator/2021-03-01_09-28-23/events.out.tfevents.1614562167.intern-instance.25651.0
deleted file mode 100644
index 59ab3df..0000000
Binary files a/Punctuation_with_Domain_discriminator/2021-03-01_09-28-23/events.out.tfevents.1614562167.intern-instance.25651.0 and /dev/null differ
diff --git a/Punctuation_with_Domain_discriminator/2021-03-01_09-28-23/git-info.log b/Punctuation_with_Domain_discriminator/2021-03-01_09-28-23/git-info.log
deleted file mode 100644
index a8a1231..0000000
--- a/Punctuation_with_Domain_discriminator/2021-03-01_09-28-23/git-info.log
+++ /dev/null
@@ -1,121 +0,0 @@
-commit hash: c3e0c8d06d6c49891d066054f713b1fe9405d41f
-diff --git a/experiment/config.yaml b/experiment/config.yaml
-index 809477a..c5d2da0 100644
---- a/experiment/config.yaml
-+++ b/experiment/config.yaml
-@@ -127,12 +127,12 @@ model:
-         # unfrozen_layers: 1
-     
-     punct_head:
--        punct_num_fc_layers: 3
-+        punct_num_fc_layers: 0
-         fc_dropout: 0.1
-         activation: 'gelu'
-         log_softmax: false
-         use_transformer_init: true
--        loss: 'dice'
-+        loss: 'crf'
-         bilstm: false
- 
-     domain_head:
-@@ -147,8 +147,8 @@ model:
-         pooling: 'mean_max' # 'mean' mean_max
-         idx_conditioned_on: 0
-         weight:
--            - 0.8
--            - 0.2
-+            - 0.6
-+            - 0.4
- 
- 
-     dice_loss:
-diff --git a/experiment/info.log b/experiment/info.log
-index 5fc3200..b3df31c 100644
---- a/experiment/info.log
-+++ b/experiment/info.log
-@@ -1,84 +1,5 @@
-+[INFO] - Global seed set to 42
- [INFO] - GPU available: True, used: True
- [INFO] - TPU available: None, using: 0 TPU cores
- [INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
- [INFO] - Using native 16bit precision.
--[INFO] - shuffling train set
--[INFO] - initializing ddp: GLOBAL_RANK: 0, MEMBER: 1/1
--[INFO] - Optimizer config = AdamW (
--Parameter Group 0
--    amsgrad: False
--    betas: (0.9, 0.999)
--    eps: 1e-08
--    lr: 0.001
--    weight_decay: 0.0
--)
--[INFO] - Scheduler "<core.optim.lr_scheduler.CosineAnnealing object at 0x7f1f8ee04790>" 
--will be used during training (effective maximum steps = 400) - 
--Parameters : 
--(warmup_steps: null
--warmup_ratio: 0.1
--min_lr: 1.0e-08
--last_epoch: -1
--max_steps: 400
--)
--[INFO] - 
--  | Name                       | Type                 | Params
----------------------------------------------------------------------
--0 | transformer                | ElectraModel         | 108 M 
--1 | punct_classifier           | TokenClassifier      | 1.2 M 
--2 | domain_classifier          | SequenceClassifier   | 3.1 K 
--3 | punctuation_loss           | FocalDiceLoss        | 0     
--4 | domain_loss                | CrossEntropyLoss     | 0     
--5 | agg_loss                   | AggregatorLoss       | 0     
--6 | punct_class_report         | ClassificationReport | 0     
--7 | chunked_punct_class_report | ClassificationReport | 0     
--8 | domain_class_report        | ClassificationReport | 0     
----------------------------------------------------------------------
--8.3 M     Trainable params
--101 M     Non-trainable params
--110 M     Total params
--[INFO] - Punctuation report: 
--label                                                precision    recall       f1           support   
-- (label_id: 0)                                          88.38      37.36      52.51      32611
--! (label_id: 1)                                          0.00       0.00       0.00         10
--# (label_id: 2)                                          1.95      16.57       3.49       1358
--, (label_id: 3)                                          1.59       0.40       0.64        997
--- (label_id: 4)                                          0.24       4.90       0.46        102
--. (label_id: 5)                                          4.48       4.72       4.60        932
--: (label_id: 6)                                          0.04      11.76       0.09         17
--? (label_id: 7)                                          0.00       0.00       0.00         71
--… (label_id: 8)                                          0.00       0.00       0.00          6
---------------------
--micro avg                                               34.52      34.52      34.52      36104
--macro avg                                               10.74       8.41       6.87      36104
--weighted avg                                            80.06      34.52      47.70      36104
--
---------------------
--                       !           #           ,           -           .           :           ?           …
--    12182.00         5.00       661.00       447.00        46.00       411.00         8.00        22.00         2.00
--     1145.00         0.00        52.00        48.00        10.00        65.00         1.00         6.00         0.00
--    10705.00         1.00       225.00       312.00        17.00       256.00         6.00        27.00         3.00
--      225.00         0.00        21.00         4.00         0.00         2.00         0.00         0.00         0.00
--     1914.00         0.00       114.00        15.00         5.00         4.00         0.00         1.00         0.00
--      874.00         0.00        20.00        37.00         3.00        44.00         0.00         3.00         1.00
--     4235.00         4.00       128.00       113.00        11.00       135.00         2.00        12.00         0.00
--      193.00         0.00         6.00         1.00         0.00         0.00         0.00         0.00         0.00
--     1138.00         0.00       131.00        20.00        10.00        15.00         0.00         0.00         0.00
---------------------
--
--[INFO] - Domain report: 
--label                                                precision    recall       f1           support   
--0 (label_id: 0)                                         50.65     100.00      67.24        156
--1 (label_id: 1)                                        100.00       2.56       5.00        156
---------------------
--micro avg                                               51.28      51.28      51.28        312
--macro avg                                               75.32      51.28      36.12        312
--weighted avg                                            75.32      51.28      36.12        312
--
---------------------
--           0           1
--      156.00       152.00
--        0.00         4.00
---------------------
--
--[INFO] - Internal process exited
diff --git a/Punctuation_with_Domain_discriminator/2021-03-01_09-28-23/hparams.yaml b/Punctuation_with_Domain_discriminator/2021-03-01_09-28-23/hparams.yaml
deleted file mode 100644
index 29791b0..0000000
--- a/Punctuation_with_Domain_discriminator/2021-03-01_09-28-23/hparams.yaml
+++ /dev/null
@@ -1,135 +0,0 @@
-seed: 42
-trainer:
-  gpus: 1
-  num_nodes: 1
-  max_epochs: 8
-  max_steps: null
-  accumulate_grad_batches: 4
-  gradient_clip_val: 0
-  amp_level: O1
-  precision: 16
-  accelerator: ddp
-  checkpoint_callback: false
-  logger: false
-  log_every_n_steps: 1
-  val_check_interval: 1.0
-  resume_from_checkpoint: null
-exp_manager:
-  exp_dir: /home/nxingyu2/project/
-  name: Punctuation_with_Domain_discriminator
-  create_tensorboard_logger: true
-  create_checkpoint_callback: true
-base_path: /home/nxingyu2/data
-tmp_path: /home/nxingyu2/data/tmp
-log_dir: /home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-01_09-28-23
-model:
-  nemo_path: null
-  transformer_path: google/electra-base-discriminator
-  unfrozen: 1
-  maximum_unfrozen: 3
-  unfreeze_step: 1
-  punct_label_ids:
-  - ''
-  - ','
-  - .
-  - '?'
-  - '-'
-  - '!'
-  - ':'
-  - …
-  label_map:
-    —: ','
-    ;: .
-  no_space_label: '#'
-  test_chunk_percent: 0.5
-  punct_class_weights: false
-  dataset:
-    data_dir: /home/nxingyu2/data
-    labelled:
-    - /home/nxingyu2/data/ted_talks_processed
-    unlabelled:
-    - /home/nxingyu2/data/switchboardutt_processed
-    max_seq_length: 128
-    pad_label: ''
-    ignore_extra_tokens: false
-    ignore_start_end: false
-    use_cache: false
-    num_workers: 8
-    pin_memory: false
-    drop_last: true
-    num_labels: 9
-    num_domains: 2
-    test_unlabelled: true
-    attach_label_to_end: null
-    pad_start: 0
-    train_ds:
-      shuffle: true
-      num_samples: -1
-      batch_size: 16
-      manual_len: 20000
-    validation_ds:
-      shuffle: true
-      num_samples: -1
-      batch_size: 16
-  tokenizer:
-    tokenizer_name: google/electra-base-discriminator
-    vocab_file: null
-    tokenizer_model: null
-    special_tokens: null
-  language_model:
-    pretrained_model_name: google/electra-base-discriminator
-    lm_checkpoint: null
-    config_file: null
-    config: null
-  punct_head:
-    punct_num_fc_layers: 0
-    fc_dropout: 0.1
-    activation: gelu
-    log_softmax: false
-    use_transformer_init: true
-    loss: crf
-    bilstm: false
-  domain_head:
-    predict_labelled: true
-    domain_num_fc_layers: 1
-    fc_dropout: 0.1
-    activation: relu
-    log_softmax: false
-    use_transformer_init: true
-    loss: cel
-    gamma: 0.1
-    pooling: mean_max
-    idx_conditioned_on: 0
-    weight:
-    - 0.6
-    - 0.4
-  dice_loss:
-    epsilon: 0.01
-    alpha: 2
-    macro_average: true
-  focal_loss:
-    gamma: 2
-  frozen_lr:
-  - 0.001
-  - 0.0001
-  - 0.0001
-  - 1.0e-05
-  - 1.0e-07
-  - 1.0e-08
-  gamma:
-  - 0.5
-  - 0.4
-  - 0.0001
-  - 1.0e-05
-  optim:
-    name: adamw
-    lr: 0.01
-    weight_decay: 0.0
-    sched:
-      name: CosineAnnealing
-      warmup_steps: null
-      warmup_ratio: 0.1
-      min_lr: 1.0e-08
-      last_epoch: -1
-      monitor: val_loss
-      reduce_on_plateau: false
diff --git a/Punctuation_with_Domain_discriminator/2021-03-01_09-28-23/lightning_logs.txt b/Punctuation_with_Domain_discriminator/2021-03-01_09-28-23/lightning_logs.txt
deleted file mode 100644
index ac3680a..0000000
--- a/Punctuation_with_Domain_discriminator/2021-03-01_09-28-23/lightning_logs.txt
+++ /dev/null
@@ -1,77 +0,0 @@
-Global seed set to 42
-GPU available: True, used: True
-TPU available: None, using: 0 TPU cores
-LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
-Using native 16bit precision.
-Global seed set to 42
-initializing ddp: GLOBAL_RANK: 0, MEMBER: 1/1
-
-  | Name                       | Type                 | Params
---------------------------------------------------------------------
-0 | transformer                | ElectraModel         | 108 M 
-1 | punct_classifier           | TokenClassifier      | 6.9 K 
-2 | domain_classifier          | SequenceClassifier   | 3.1 K 
-3 | punctuation_loss           | LinearChainCRF       | 99    
-4 | domain_loss                | CrossEntropyLoss     | 0     
-5 | agg_loss                   | AggregatorLoss       | 0     
-6 | punct_class_report         | ClassificationReport | 0     
-7 | chunked_punct_class_report | ClassificationReport | 0     
-8 | domain_class_report        | ClassificationReport | 0     
---------------------------------------------------------------------
-7.1 M     Trainable params
-101 M     Non-trainable params
-108 M     Total params
-Epoch 0, global step 49: val_loss reached 13.21681 (best 13.21681), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-01_09-28-23/checkpoints/Punctuation_with_Domain_discriminator---val_loss=13.22-epoch=0.ckpt" as top 3
-Epoch 1, global step 99: val_loss reached 9.28275 (best 9.28275), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-01_09-28-23/checkpoints/Punctuation_with_Domain_discriminator---val_loss=9.28-epoch=1.ckpt" as top 3
-Epoch 2, global step 149: val_loss reached 8.54270 (best 8.54270), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-01_09-28-23/checkpoints/Punctuation_with_Domain_discriminator---val_loss=8.54-epoch=2.ckpt" as top 3
-Epoch 3, global step 199: val_loss reached 8.02558 (best 8.02558), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-01_09-28-23/checkpoints/Punctuation_with_Domain_discriminator---val_loss=8.03-epoch=3.ckpt" as top 3
-Epoch 4, global step 249: val_loss reached 8.03053 (best 8.02558), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-01_09-28-23/checkpoints/Punctuation_with_Domain_discriminator---val_loss=8.03-epoch=4.ckpt" as top 3
-Epoch 5, global step 299: val_loss reached 7.87240 (best 7.87240), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-01_09-28-23/checkpoints/Punctuation_with_Domain_discriminator---val_loss=7.87-epoch=5.ckpt" as top 3
-Epoch 6, global step 349: val_loss reached 7.90138 (best 7.87240), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-01_09-28-23/checkpoints/Punctuation_with_Domain_discriminator---val_loss=7.90-epoch=6.ckpt" as top 3
-Epoch 7, global step 399: val_loss reached 7.78192 (best 7.78192), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-01_09-28-23/checkpoints/Punctuation_with_Domain_discriminator---val_loss=7.78-epoch=7.ckpt" as top 3
-Saving latest checkpoint...
-Global seed set to 42
-
-  | Name                       | Type                 | Params
---------------------------------------------------------------------
-0 | transformer                | ElectraModel         | 108 M 
-1 | punct_classifier           | TokenClassifier      | 6.9 K 
-2 | domain_classifier          | SequenceClassifier   | 3.1 K 
-3 | punctuation_loss           | LinearChainCRF       | 99    
-4 | domain_loss                | CrossEntropyLoss     | 0     
-5 | agg_loss                   | AggregatorLoss       | 0     
-6 | punct_class_report         | ClassificationReport | 0     
-7 | chunked_punct_class_report | ClassificationReport | 0     
-8 | domain_class_report        | ClassificationReport | 0     
---------------------------------------------------------------------
-14.2 M    Trainable params
-94.7 M    Non-trainable params
-108 M     Total params
-Epoch 0, global step 449: val_loss reached 7.80818 (best 7.78192), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-01_09-28-23/checkpoints/Punctuation_with_Domain_discriminator---val_loss=7.81-epoch=0.ckpt" as top 3
-Epoch 1, global step 499: val_loss reached 7.66479 (best 7.66479), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-01_09-28-23/checkpoints/Punctuation_with_Domain_discriminator---val_loss=7.66-epoch=1.ckpt" as top 3
-Epoch 2, step 549: val_loss was not in top 3
-Epoch 3, global step 599: val_loss reached 7.72051 (best 7.66479), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-01_09-28-23/checkpoints/Punctuation_with_Domain_discriminator---val_loss=7.72-epoch=3.ckpt" as top 3
-Epoch 4, step 649: val_loss was not in top 3
-Epoch 5, step 699: val_loss was not in top 3
-Epoch 6, step 749: val_loss was not in top 3
-Epoch 7, global step 799: val_loss reached 7.78175 (best 7.66479), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-01_09-28-23/checkpoints/Punctuation_with_Domain_discriminator---val_loss=7.78-epoch=7.ckpt" as top 3
-Global seed set to 42
-
-  | Name                       | Type                 | Params
---------------------------------------------------------------------
-0 | transformer                | ElectraModel         | 108 M 
-1 | punct_classifier           | TokenClassifier      | 6.9 K 
-2 | domain_classifier          | SequenceClassifier   | 3.1 K 
-3 | punctuation_loss           | LinearChainCRF       | 99    
-4 | domain_loss                | CrossEntropyLoss     | 0     
-5 | agg_loss                   | AggregatorLoss       | 0     
-6 | punct_class_report         | ClassificationReport | 0     
-7 | chunked_punct_class_report | ClassificationReport | 0     
-8 | domain_class_report        | ClassificationReport | 0     
---------------------------------------------------------------------
-21.3 M    Trainable params
-87.6 M    Non-trainable params
-108 M     Total params
-Epoch 0, step 849: val_loss was not in top 3
-Epoch 1, global step 899: val_loss reached 7.66359 (best 7.66359), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-01_09-28-23/checkpoints/Punctuation_with_Domain_discriminator---val_loss=7.66-epoch=1-v0.ckpt" as top 3
-Epoch 2, step 949: val_loss was not in top 3
diff --git a/Punctuation_with_Domain_discriminator/2021-03-01_09-28-23/nemo_error_log.txt b/Punctuation_with_Domain_discriminator/2021-03-01_09-28-23/nemo_error_log.txt
deleted file mode 100644
index ad711bb..0000000
--- a/Punctuation_with_Domain_discriminator/2021-03-01_09-28-23/nemo_error_log.txt
+++ /dev/null
@@ -1,31 +0,0 @@
-[NeMo W 2021-03-01 09:28:12 nemo_logging:349] /home/nxingyu2/project/experiment/models/punctuation_domain_model.py:68: SyntaxWarning: assertion is always true, perhaps remove parentheses?
-      assert(len(self._cfg.model.dataset.labelled)>0,'Please include at least 1 labelled dataset')
-    
-[NeMo W 2021-03-01 09:28:23 exp_manager:562] trainer had a weights_save_path of cwd(). This was ignored.
-[NeMo W 2021-03-01 09:28:35 nemo_logging:349] /home/nxingyu2/project/experiment/models/punctuation_domain_model.py:68: SyntaxWarning: assertion is always true, perhaps remove parentheses?
-      assert(len(self._cfg.model.dataset.labelled)>0,'Please include at least 1 labelled dataset')
-    
-[NeMo W 2021-03-01 09:28:35 nemo_logging:349] /home/nxingyu2/project/experiment/models/punctuation_domain_model.py:68: SyntaxWarning: assertion is always true, perhaps remove parentheses?
-      assert(len(self._cfg.model.dataset.labelled)>0,'Please include at least 1 labelled dataset')
-    
-[NeMo W 2021-03-01 09:29:09 nemo_logging:349] /home/nxingyu2/project/experiment/models/punctuation_domain_model.py:68: SyntaxWarning: assertion is always true, perhaps remove parentheses?
-      assert(len(self._cfg.model.dataset.labelled)>0,'Please include at least 1 labelled dataset')
-    
-[NeMo W 2021-03-01 09:29:10 nemo_logging:349] /home/nxingyu2/project/experiment/models/punctuation_domain_model.py:68: SyntaxWarning: assertion is always true, perhaps remove parentheses?
-      assert(len(self._cfg.model.dataset.labelled)>0,'Please include at least 1 labelled dataset')
-    
-[NeMo W 2021-03-01 09:29:10 nemo_logging:349] /home/nxingyu2/project/experiment/models/punctuation_domain_model.py:68: SyntaxWarning: assertion is always true, perhaps remove parentheses?
-      assert(len(self._cfg.model.dataset.labelled)>0,'Please include at least 1 labelled dataset')
-    
-[NeMo W 2021-03-01 09:29:27 nemo_logging:349] /home/nxingyu2/miniconda3/envs/NLP/lib/python3.8/site-packages/pytorch_lightning/utilities/distributed.py:49: UserWarning: Your `IterableDataset` has `__len__` defined. In combination with multi-processing data loading (e.g. batch size > 1), this can lead to unintended side effects since the samples will be duplicated.
-      warnings.warn(*args, **kwargs)
-    
-[NeMo W 2021-03-01 09:30:16 nemo_logging:349] /home/nxingyu2/miniconda3/envs/NLP/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:131: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
-      warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
-    
-[NeMo W 2021-03-01 09:33:12 nemo_logging:349] /home/nxingyu2/miniconda3/envs/NLP/lib/python3.8/site-packages/torch/utils/data/dataloader.py:447: UserWarning: Length of IterableDataset <data.punctuation_dataset_multi.PunctuationDomainDatasets object at 0x7ff660cd4cd0> was reported to be 199 (when accessing len(dataloader)), but 200 samples have been fetched. For multiprocessing data-loading, this could be caused by not properly configuring the IterableDataset replica at each worker. Please see https://pytorch.org/docs/stable/data.html#torch.utils.data.IterableDataset for examples.
-      warnings.warn(warn_msg)
-    
-[NeMo W 2021-03-01 09:33:41 nemo_logging:349] /home/nxingyu2/miniconda3/envs/NLP/lib/python3.8/site-packages/torch/utils/data/dataloader.py:447: UserWarning: Length of IterableDataset <data.punctuation_dataset_multi.PunctuationDomainDatasets object at 0x7ff660cddbb0> was reported to be 25 (when accessing len(dataloader)), but 26 samples have been fetched. For multiprocessing data-loading, this could be caused by not properly configuring the IterableDataset replica at each worker. Please see https://pytorch.org/docs/stable/data.html#torch.utils.data.IterableDataset for examples.
-      warnings.warn(warn_msg)
-    
diff --git a/Punctuation_with_Domain_discriminator/2021-03-01_09-28-23/nemo_log_globalrank-0_localrank-0.txt b/Punctuation_with_Domain_discriminator/2021-03-01_09-28-23/nemo_log_globalrank-0_localrank-0.txt
deleted file mode 100644
index 0141b1c..0000000
--- a/Punctuation_with_Domain_discriminator/2021-03-01_09-28-23/nemo_log_globalrank-0_localrank-0.txt
+++ /dev/null
@@ -1,33 +0,0 @@
-[NeMo W 2021-03-01 09:28:12 nemo_logging:349] /home/nxingyu2/project/experiment/models/punctuation_domain_model.py:68: SyntaxWarning: assertion is always true, perhaps remove parentheses?
-      assert(len(self._cfg.model.dataset.labelled)>0,'Please include at least 1 labelled dataset')
-    
-[NeMo I 2021-03-01 09:28:23 exp_manager:183] Experiments will be logged at /home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-01_09-28-23
-[NeMo I 2021-03-01 09:28:23 exp_manager:519] TensorboardLogger has been set up
-[NeMo W 2021-03-01 09:28:23 exp_manager:562] trainer had a weights_save_path of cwd(). This was ignored.
-[NeMo W 2021-03-01 09:28:35 nemo_logging:349] /home/nxingyu2/project/experiment/models/punctuation_domain_model.py:68: SyntaxWarning: assertion is always true, perhaps remove parentheses?
-      assert(len(self._cfg.model.dataset.labelled)>0,'Please include at least 1 labelled dataset')
-    
-[NeMo W 2021-03-01 09:28:35 nemo_logging:349] /home/nxingyu2/project/experiment/models/punctuation_domain_model.py:68: SyntaxWarning: assertion is always true, perhaps remove parentheses?
-      assert(len(self._cfg.model.dataset.labelled)>0,'Please include at least 1 labelled dataset')
-    
-[NeMo W 2021-03-01 09:29:09 nemo_logging:349] /home/nxingyu2/project/experiment/models/punctuation_domain_model.py:68: SyntaxWarning: assertion is always true, perhaps remove parentheses?
-      assert(len(self._cfg.model.dataset.labelled)>0,'Please include at least 1 labelled dataset')
-    
-[NeMo W 2021-03-01 09:29:10 nemo_logging:349] /home/nxingyu2/project/experiment/models/punctuation_domain_model.py:68: SyntaxWarning: assertion is always true, perhaps remove parentheses?
-      assert(len(self._cfg.model.dataset.labelled)>0,'Please include at least 1 labelled dataset')
-    
-[NeMo W 2021-03-01 09:29:10 nemo_logging:349] /home/nxingyu2/project/experiment/models/punctuation_domain_model.py:68: SyntaxWarning: assertion is always true, perhaps remove parentheses?
-      assert(len(self._cfg.model.dataset.labelled)>0,'Please include at least 1 labelled dataset')
-    
-[NeMo W 2021-03-01 09:29:27 nemo_logging:349] /home/nxingyu2/miniconda3/envs/NLP/lib/python3.8/site-packages/pytorch_lightning/utilities/distributed.py:49: UserWarning: Your `IterableDataset` has `__len__` defined. In combination with multi-processing data loading (e.g. batch size > 1), this can lead to unintended side effects since the samples will be duplicated.
-      warnings.warn(*args, **kwargs)
-    
-[NeMo W 2021-03-01 09:30:16 nemo_logging:349] /home/nxingyu2/miniconda3/envs/NLP/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:131: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
-      warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
-    
-[NeMo W 2021-03-01 09:33:12 nemo_logging:349] /home/nxingyu2/miniconda3/envs/NLP/lib/python3.8/site-packages/torch/utils/data/dataloader.py:447: UserWarning: Length of IterableDataset <data.punctuation_dataset_multi.PunctuationDomainDatasets object at 0x7ff660cd4cd0> was reported to be 199 (when accessing len(dataloader)), but 200 samples have been fetched. For multiprocessing data-loading, this could be caused by not properly configuring the IterableDataset replica at each worker. Please see https://pytorch.org/docs/stable/data.html#torch.utils.data.IterableDataset for examples.
-      warnings.warn(warn_msg)
-    
-[NeMo W 2021-03-01 09:33:41 nemo_logging:349] /home/nxingyu2/miniconda3/envs/NLP/lib/python3.8/site-packages/torch/utils/data/dataloader.py:447: UserWarning: Length of IterableDataset <data.punctuation_dataset_multi.PunctuationDomainDatasets object at 0x7ff660cddbb0> was reported to be 25 (when accessing len(dataloader)), but 26 samples have been fetched. For multiprocessing data-loading, this could be caused by not properly configuring the IterableDataset replica at each worker. Please see https://pytorch.org/docs/stable/data.html#torch.utils.data.IterableDataset for examples.
-      warnings.warn(warn_msg)
-    
diff --git a/experiment/info.log b/experiment/info.log
index 567223d..b3df31c 100644
--- a/experiment/info.log
+++ b/experiment/info.log
@@ -3,1095 +3,3 @@
 [INFO] - TPU available: None, using: 0 TPU cores
 [INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
 [INFO] - Using native 16bit precision.
-[INFO] - shuffling train set
-[INFO] - Global seed set to 42
-[INFO] - initializing ddp: GLOBAL_RANK: 0, MEMBER: 1/1
-[INFO] - Optimizer config = AdamW (
-Parameter Group 0
-    amsgrad: False
-    betas: (0.9, 0.999)
-    eps: 1e-08
-    lr: 0.001
-    weight_decay: 0.0
-)
-[INFO] - Scheduler "<core.optim.lr_scheduler.CosineAnnealing object at 0x7ff60875f970>" 
-will be used during training (effective maximum steps = 400) - 
-Parameters : 
-(warmup_steps: null
-warmup_ratio: 0.1
-min_lr: 1.0e-08
-last_epoch: -1
-max_steps: 400
-)
-[INFO] - 
-  | Name                       | Type                 | Params
---------------------------------------------------------------------
-0 | transformer                | ElectraModel         | 108 M 
-1 | punct_classifier           | TokenClassifier      | 6.9 K 
-2 | domain_classifier          | SequenceClassifier   | 3.1 K 
-3 | punctuation_loss           | LinearChainCRF       | 99    
-4 | domain_loss                | CrossEntropyLoss     | 0     
-5 | agg_loss                   | AggregatorLoss       | 0     
-6 | punct_class_report         | ClassificationReport | 0     
-7 | chunked_punct_class_report | ClassificationReport | 0     
-8 | domain_class_report        | ClassificationReport | 0     
---------------------------------------------------------------------
-7.1 M     Trainable params
-101 M     Non-trainable params
-108 M     Total params
-[INFO] - Punctuation report: 
-label                                                precision    recall       f1           support   
- (label_id: 0)                                          84.93       0.17       0.35      35588
-! (label_id: 1)                                          0.00       0.00       0.00         18
-# (label_id: 2)                                          8.16       5.96       6.89       1494
-, (label_id: 3)                                          1.73       0.83       1.12       1084
-- (label_id: 4)                                          0.46      13.91       0.89        115
-. (label_id: 5)                                          1.39      38.79       2.69        990
-: (label_id: 6)                                          0.00       0.00       0.00         18
-? (label_id: 7)                                          0.13       1.19       0.23         84
-… (label_id: 8)                                          0.05      20.00       0.10         10
--------------------
-micro avg                                                1.43       1.43       1.43      39401
-macro avg                                               10.76       8.98       1.36      39401
-weighted avg                                            77.11       1.43       0.68      39401
-
--------------------
-                       !           #           ,           -           .           :           ?           …
-       62.00         0.00         7.00         3.00         0.00         1.00         0.00         0.00         0.00
-      276.00         0.00         9.00        10.00         6.00        28.00         0.00         2.00         0.00
-      963.00         0.00        89.00        21.00         7.00        10.00         1.00         0.00         0.00
-      477.00         0.00        23.00         9.00         2.00         9.00         0.00         0.00         1.00
-     2874.00         5.00       103.00       223.00        16.00       249.00         1.00        26.00         1.00
-    25742.00         4.00       916.00       468.00        40.00       384.00        16.00        37.00         6.00
-     1144.00         0.00       228.00         0.00         0.00         0.00         0.00         0.00         0.00
-      758.00         0.00         9.00         6.00         5.00         6.00         0.00         1.00         0.00
-     3292.00         9.00       110.00       344.00        39.00       303.00         0.00        18.00         2.00
--------------------
-
-[INFO] - Domain report: 
-label                                                precision    recall       f1           support   
-0 (label_id: 0)                                         49.70      98.81      66.14        168
-1 (label_id: 1)                                          0.00       0.00       0.00        168
--------------------
-micro avg                                               49.40      49.40      49.40        336
-macro avg                                               24.85      49.40      33.07        336
-weighted avg                                            24.85      49.40      33.07        336
-
--------------------
-           0           1
-      166.00       168.00
-        2.00         0.00
--------------------
-
-[INFO] - Punctuation report: 
-label                                                precision    recall       f1           support   
- (label_id: 0)                                          98.75      98.69      98.72     429593
-! (label_id: 1)                                          0.00       0.00       0.00         82
-# (label_id: 2)                                         97.32      93.67      95.46      19814
-, (label_id: 3)                                         55.23      62.08      58.45      13891
-- (label_id: 4)                                         82.84      21.18      33.74       1185
-. (label_id: 5)                                         70.70      78.81      74.53      13225
-: (label_id: 6)                                          0.00       0.00       0.00        257
-? (label_id: 7)                                          0.00       0.00       0.00        924
-… (label_id: 8)                                          0.00       0.00       0.00         63
--------------------
-micro avg                                               96.40      96.40      96.40     479034
-macro avg                                               44.98      39.38      40.10     479034
-weighted avg                                            96.34      96.40      96.32     479034
-
--------------------
-                       !           #           ,           -           .           :           ?           …
-   423950.00         8.00      1228.00      2671.00       593.00       735.00        33.00        64.00        22.00
-        0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00
-      432.00         0.00     18560.00        10.00        58.00        12.00         0.00         0.00         0.00
-     4270.00        40.00        12.00      8623.00       274.00      2053.00       119.00       188.00        34.00
-       49.00         0.00         0.00         0.00       251.00         3.00         0.00         0.00         0.00
-      892.00        34.00        14.00      2587.00         9.00     10422.00       105.00       672.00         7.00
-        0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00
-        0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00
-        0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00
--------------------
-
-[INFO] - Domain report: 
-label                                                precision    recall       f1           support   
-0 (label_id: 0)                                          0.00       0.00       0.00       2043
-1 (label_id: 1)                                         50.00     100.00      66.67       2043
--------------------
-micro avg                                               50.00      50.00      50.00       4086
-macro avg                                               25.00      50.00      33.33       4086
-weighted avg                                            25.00      50.00      33.33       4086
-
--------------------
-           0           1
-        0.00         0.00
-     2043.00      2043.00
--------------------
-
-[INFO] - Epoch 0, global step 49: val_loss reached 13.21681 (best 13.21681), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-01_09-28-23/checkpoints/Punctuation_with_Domain_discriminator---val_loss=13.22-epoch=0.ckpt" as top 3
-[INFO] - Punctuation report: 
-label                                                precision    recall       f1           support   
- (label_id: 0)                                          99.06      98.93      99.00     429965
-! (label_id: 1)                                          0.00       0.00       0.00         82
-# (label_id: 2)                                         97.06      97.59      97.33      19975
-, (label_id: 3)                                         63.65      72.95      67.99      13852
-- (label_id: 4)                                         74.43      69.03      71.63       1227
-. (label_id: 5)                                         78.56      78.02      78.29      13301
-: (label_id: 6)                                          0.00       0.00       0.00        250
-? (label_id: 7)                                         80.00       0.41       0.82        966
-… (label_id: 8)                                          0.00       0.00       0.00         60
--------------------
-micro avg                                               97.19      97.19      97.19     479678
-macro avg                                               54.75      46.33      46.12     479678
-weighted avg                                            97.21      97.19      97.11     479678
-
--------------------
-                       !           #           ,           -           .           :           ?           …
-   425350.00         9.00       467.00      2442.00       329.00       655.00        31.00        55.00        27.00
-        0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00
-      570.00         0.00     19494.00         1.00         4.00        15.00         0.00         0.00         0.00
-     3132.00        36.00         3.00     10105.00        42.00      2218.00       117.00       194.00        28.00
-      242.00         0.00         6.00         8.00       847.00        35.00         0.00         0.00         0.00
-      671.00        37.00         5.00      1295.00         5.00     10378.00       102.00       713.00         5.00
-        0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00
-        0.00         0.00         0.00         1.00         0.00         0.00         0.00         4.00         0.00
-        0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00
--------------------
-
-[INFO] - Domain report: 
-label                                                precision    recall       f1           support   
-0 (label_id: 0)                                          0.00       0.00       0.00       2043
-1 (label_id: 1)                                         50.00     100.00      66.67       2043
--------------------
-micro avg                                               50.00      50.00      50.00       4086
-macro avg                                               25.00      50.00      33.33       4086
-weighted avg                                            25.00      50.00      33.33       4086
-
--------------------
-           0           1
-        0.00         0.00
-     2043.00      2043.00
--------------------
-
-[INFO] - Epoch 1, global step 99: val_loss reached 9.28275 (best 9.28275), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-01_09-28-23/checkpoints/Punctuation_with_Domain_discriminator---val_loss=9.28-epoch=1.ckpt" as top 3
-[INFO] - Punctuation report: 
-label                                                precision    recall       f1           support   
- (label_id: 0)                                          99.07      99.00      99.04     429155
-! (label_id: 1)                                          0.00       0.00       0.00         90
-# (label_id: 2)                                         97.29      97.97      97.63      20042
-, (label_id: 3)                                         66.31      71.99      69.03      14003
-- (label_id: 4)                                         77.16      71.55      74.25       1209
-. (label_id: 5)                                         82.41      79.61      80.99      13293
-: (label_id: 6)                                          0.00       0.00       0.00        265
-? (label_id: 7)                                         73.11      67.49      70.19        975
-… (label_id: 8)                                          0.00       0.00       0.00         61
--------------------
-micro avg                                               97.41      97.41      97.41     479093
-macro avg                                               55.04      54.18      54.57     479093
-weighted avg                                            97.38      97.41      97.39     479093
-
--------------------
-                       !           #           ,           -           .           :           ?           …
-   424867.00        12.00       400.00      2532.00       302.00       625.00        37.00        48.00        23.00
-        0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00
-      524.00         0.00     19635.00         3.00         3.00        16.00         0.00         0.00         0.00
-     2850.00        27.00         2.00     10081.00        33.00      1948.00       116.00       116.00        30.00
-      223.00         0.00         3.00         4.00       865.00        26.00         0.00         0.00         0.00
-      634.00        49.00         2.00      1299.00         6.00     10583.00       108.00       153.00         8.00
-        0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00
-       57.00         2.00         0.00        84.00         0.00        95.00         4.00       658.00         0.00
-        0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00
--------------------
-
-[INFO] - Domain report: 
-label                                                precision    recall       f1           support   
-0 (label_id: 0)                                          0.00       0.00       0.00       2043
-1 (label_id: 1)                                         50.00     100.00      66.67       2043
--------------------
-micro avg                                               50.00      50.00      50.00       4086
-macro avg                                               25.00      50.00      33.33       4086
-weighted avg                                            25.00      50.00      33.33       4086
-
--------------------
-           0           1
-        0.00         0.00
-     2043.00      2043.00
--------------------
-
-[INFO] - Epoch 2, global step 149: val_loss reached 8.54270 (best 8.54270), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-01_09-28-23/checkpoints/Punctuation_with_Domain_discriminator---val_loss=8.54-epoch=2.ckpt" as top 3
-[INFO] - Punctuation report: 
-label                                                precision    recall       f1           support   
- (label_id: 0)                                          98.98      99.15      99.07     428784
-! (label_id: 1)                                          0.00       0.00       0.00         74
-# (label_id: 2)                                         96.63      98.92      97.76      19942
-, (label_id: 3)                                         69.30      68.28      68.78      13958
-- (label_id: 4)                                         80.78      70.95      75.55       1167
-. (label_id: 5)                                         83.22      80.48      81.82      13210
-: (label_id: 6)                                         50.00       2.51       4.78        279
-? (label_id: 7)                                         75.73      71.53      73.57        973
-… (label_id: 8)                                          0.00       0.00       0.00         61
--------------------
-micro avg                                               97.52      97.52      97.52     478448
-macro avg                                               61.63      54.65      55.70     478448
-weighted avg                                            97.43      97.52      97.46     478448
-
--------------------
-                       !           #           ,           -           .           :           ?           …
-   425153.00        10.00       212.00      3056.00       300.00       690.00        42.00        59.00        25.00
-        0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00
-      678.00         0.00     19727.00         2.00         3.00         6.00         0.00         0.00         0.00
-     2151.00        28.00         1.00      9530.00        30.00      1775.00       117.00        93.00        27.00
-      179.00         0.00         0.00         3.00       828.00        15.00         0.00         0.00         0.00
-      572.00        35.00         1.00      1291.00         5.00     10631.00       107.00       125.00         8.00
-        1.00         0.00         0.00         0.00         0.00         6.00         7.00         0.00         0.00
-       50.00         1.00         1.00        76.00         1.00        87.00         6.00       696.00         1.00
-        0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00
--------------------
-
-[INFO] - Domain report: 
-label                                                precision    recall       f1           support   
-0 (label_id: 0)                                          0.00       0.00       0.00       2043
-1 (label_id: 1)                                         50.00     100.00      66.67       2043
--------------------
-micro avg                                               50.00      50.00      50.00       4086
-macro avg                                               25.00      50.00      33.33       4086
-weighted avg                                            25.00      50.00      33.33       4086
-
--------------------
-           0           1
-        0.00         0.00
-     2043.00      2043.00
--------------------
-
-[INFO] - Epoch 3, global step 199: val_loss reached 8.02558 (best 8.02558), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-01_09-28-23/checkpoints/Punctuation_with_Domain_discriminator---val_loss=8.03-epoch=3.ckpt" as top 3
-[INFO] - Punctuation report: 
-label                                                precision    recall       f1           support   
- (label_id: 0)                                          99.04      99.11      99.08     429860
-! (label_id: 1)                                          0.00       0.00       0.00         87
-# (label_id: 2)                                         96.35      99.27      97.79      20010
-, (label_id: 3)                                         70.41      67.24      68.79      13835
-- (label_id: 4)                                         81.24      71.68      76.16       1190
-. (label_id: 5)                                         81.28      82.94      82.10      13292
-: (label_id: 6)                                         47.06       9.23      15.43        260
-? (label_id: 7)                                         76.00      72.47      74.20        970
-… (label_id: 8)                                          0.00       0.00       0.00         59
--------------------
-micro avg                                               97.55      97.55      97.55     479563
-macro avg                                               61.26      55.77      57.06     479563
-weighted avg                                            97.46      97.55      97.50     479563
-
--------------------
-                       !           #           ,           -           .           :           ?           …
-   426029.00        10.00       143.00      2915.00       298.00       627.00        36.00        62.00        25.00
-        0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00
-      739.00         0.00     19863.00         3.00         3.00         7.00         0.00         0.00         0.00
-     2146.00        25.00         0.00      9303.00        30.00      1519.00        85.00        78.00        27.00
-      179.00         0.00         1.00         6.00       853.00        11.00         0.00         0.00         0.00
-      709.00        50.00         3.00      1526.00         5.00     11025.00       113.00       127.00         6.00
-        5.00         0.00         0.00         4.00         0.00        18.00        24.00         0.00         0.00
-       53.00         2.00         0.00        78.00         1.00        85.00         2.00       703.00         1.00
-        0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00
--------------------
-
-[INFO] - Domain report: 
-label                                                precision    recall       f1           support   
-0 (label_id: 0)                                          0.00       0.00       0.00       2043
-1 (label_id: 1)                                         50.00     100.00      66.67       2043
--------------------
-micro avg                                               50.00      50.00      50.00       4086
-macro avg                                               25.00      50.00      33.33       4086
-weighted avg                                            25.00      50.00      33.33       4086
-
--------------------
-           0           1
-        0.00         0.00
-     2043.00      2043.00
--------------------
-
-[INFO] - Epoch 4, global step 249: val_loss reached 8.03053 (best 8.02558), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-01_09-28-23/checkpoints/Punctuation_with_Domain_discriminator---val_loss=8.03-epoch=4.ckpt" as top 3
-[INFO] - Punctuation report: 
-label                                                precision    recall       f1           support   
- (label_id: 0)                                          99.10      99.10      99.10     429659
-! (label_id: 1)                                          0.00       0.00       0.00         85
-# (label_id: 2)                                         96.57      99.24      97.89      20044
-, (label_id: 3)                                         70.37      69.15      69.75      13925
-- (label_id: 4)                                         79.98      73.37      76.53       1209
-. (label_id: 5)                                         81.84      83.03      82.43      13291
-: (label_id: 6)                                         48.61      12.87      20.35        272
-? (label_id: 7)                                         76.52      72.28      74.34        938
-… (label_id: 8)                                          0.00       0.00       0.00         67
--------------------
-micro avg                                               97.59      97.59      97.59     479490
-macro avg                                               61.44      56.56      57.82     479490
-weighted avg                                            97.53      97.59      97.55     479490
-
--------------------
-                       !           #           ,           -           .           :           ?           …
-   425781.00        13.00       148.00      2747.00       282.00       570.00        38.00        53.00        27.00
-        0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00
-      692.00         0.00     19891.00         4.00         2.00         8.00         0.00         0.00         0.00
-     2221.00        23.00         1.00      9629.00        32.00      1562.00        94.00        94.00        28.00
-      202.00         0.00         1.00         6.00       887.00        13.00         0.00         0.00         0.00
-      703.00        46.00         3.00      1464.00         5.00     11035.00       103.00       113.00        11.00
-        8.00         0.00         0.00         7.00         0.00        22.00        35.00         0.00         0.00
-       52.00         3.00         0.00        68.00         1.00        81.00         2.00       678.00         1.00
-        0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00
--------------------
-
-[INFO] - Domain report: 
-label                                                precision    recall       f1           support   
-0 (label_id: 0)                                          0.00       0.00       0.00       2043
-1 (label_id: 1)                                         50.00     100.00      66.67       2043
--------------------
-micro avg                                               50.00      50.00      50.00       4086
-macro avg                                               25.00      50.00      33.33       4086
-weighted avg                                            25.00      50.00      33.33       4086
-
--------------------
-           0           1
-        0.00         0.00
-     2043.00      2043.00
--------------------
-
-[INFO] - Epoch 5, global step 299: val_loss reached 7.87240 (best 7.87240), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-01_09-28-23/checkpoints/Punctuation_with_Domain_discriminator---val_loss=7.87-epoch=5.ckpt" as top 3
-[INFO] - Punctuation report: 
-label                                                precision    recall       f1           support   
- (label_id: 0)                                          99.15      99.05      99.10     429924
-! (label_id: 1)                                          0.00       0.00       0.00         83
-# (label_id: 2)                                         96.58      99.26      97.90      20142
-, (label_id: 3)                                         69.66      70.18      69.92      13997
-- (label_id: 4)                                         80.09      73.90      76.87       1230
-. (label_id: 5)                                         81.53      82.65      82.09      13205
-: (label_id: 6)                                         43.48      11.28      17.91        266
-? (label_id: 7)                                         76.79      76.38      76.58        927
-… (label_id: 8)                                          0.00       0.00       0.00         62
--------------------
-micro avg                                               97.58      97.58      97.58     479836
-macro avg                                               60.81      56.97      57.82     479836
-weighted avg                                            97.54      97.58      97.56     479836
-
--------------------
-                       !           #           ,           -           .           :           ?           …
-   425861.00        13.00       147.00      2593.00       278.00       531.00        28.00        47.00        24.00
-        0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00
-      694.00         0.00     19992.00         3.00         2.00         9.00         0.00         0.00         0.00
-     2398.00        21.00         1.00      9823.00        34.00      1630.00        98.00        70.00        27.00
-      210.00         0.00         0.00         5.00       909.00        11.00         0.00         0.00         0.00
-      705.00        48.00         2.00      1490.00         6.00     10914.00       108.00       102.00        11.00
-        9.00         0.00         0.00         9.00         0.00        21.00        30.00         0.00         0.00
-       47.00         1.00         0.00        74.00         1.00        89.00         2.00       708.00         0.00
-        0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00
--------------------
-
-[INFO] - Domain report: 
-label                                                precision    recall       f1           support   
-0 (label_id: 0)                                          0.00       0.00       0.00       2043
-1 (label_id: 1)                                         50.00     100.00      66.67       2043
--------------------
-micro avg                                               50.00      50.00      50.00       4086
-macro avg                                               25.00      50.00      33.33       4086
-weighted avg                                            25.00      50.00      33.33       4086
-
--------------------
-           0           1
-        0.00         0.00
-     2043.00      2043.00
--------------------
-
-[INFO] - Epoch 6, global step 349: val_loss reached 7.90138 (best 7.87240), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-01_09-28-23/checkpoints/Punctuation_with_Domain_discriminator---val_loss=7.90-epoch=6.ckpt" as top 3
-[INFO] - Punctuation report: 
-label                                                precision    recall       f1           support   
- (label_id: 0)                                          99.11      99.11      99.11     429584
-! (label_id: 1)                                          0.00       0.00       0.00         85
-# (label_id: 2)                                         96.93      98.91      97.91      20017
-, (label_id: 3)                                         69.31      70.45      69.87      13894
-- (label_id: 4)                                         80.97      72.70      76.61       1176
-. (label_id: 5)                                         82.67      81.89      82.28      13225
-: (label_id: 6)                                         53.73      13.38      21.43        269
-? (label_id: 7)                                         76.52      74.19      75.33        953
-… (label_id: 8)                                          0.00       0.00       0.00         59
--------------------
-micro avg                                               97.60      97.60      97.60     479262
-macro avg                                               62.14      56.74      58.06     479262
-weighted avg                                            97.56      97.60      97.57     479262
-
--------------------
-                       !           #           ,           -           .           :           ?           …
-   425762.00         9.00       213.00      2653.00       279.00       538.00        34.00        56.00        22.00
-        0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00
-      616.00         0.00     19799.00         3.00         1.00         7.00         0.00         0.00         0.00
-     2324.00        25.00         1.00      9788.00        35.00      1733.00       104.00        84.00        28.00
-      182.00         0.00         1.00         6.00       855.00        12.00         0.00         0.00         0.00
-      640.00        50.00         3.00      1365.00         5.00     10830.00        93.00       106.00         9.00
-        5.00         0.00         0.00         4.00         0.00        22.00        36.00         0.00         0.00
-       55.00         1.00         0.00        75.00         1.00        83.00         2.00       707.00         0.00
-        0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00
--------------------
-
-[INFO] - Domain report: 
-label                                                precision    recall       f1           support   
-0 (label_id: 0)                                          0.00       0.00       0.00       2043
-1 (label_id: 1)                                         50.00     100.00      66.67       2043
--------------------
-micro avg                                               50.00      50.00      50.00       4086
-macro avg                                               25.00      50.00      33.33       4086
-weighted avg                                            25.00      50.00      33.33       4086
-
--------------------
-           0           1
-        0.00         0.00
-     2043.00      2043.00
--------------------
-
-[INFO] - Epoch 7, global step 399: val_loss reached 7.78192 (best 7.78192), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-01_09-28-23/checkpoints/Punctuation_with_Domain_discriminator---val_loss=7.78-epoch=7.ckpt" as top 3
-[INFO] - Saving latest checkpoint...
-[INFO] - Global seed set to 42
-[INFO] - Optimizer config = AdamW (
-Parameter Group 0
-    amsgrad: False
-    betas: (0.9, 0.999)
-    eps: 1e-08
-    lr: 0.0001
-    weight_decay: 0.0
-)
-[INFO] - Scheduler "<core.optim.lr_scheduler.CosineAnnealing object at 0x7ff60ca5e340>" 
-will be used during training (effective maximum steps = 400) - 
-Parameters : 
-(warmup_steps: null
-warmup_ratio: 0.1
-min_lr: 1.0e-08
-last_epoch: -1
-max_steps: 400
-)
-[INFO] - 
-  | Name                       | Type                 | Params
---------------------------------------------------------------------
-0 | transformer                | ElectraModel         | 108 M 
-1 | punct_classifier           | TokenClassifier      | 6.9 K 
-2 | domain_classifier          | SequenceClassifier   | 3.1 K 
-3 | punctuation_loss           | LinearChainCRF       | 99    
-4 | domain_loss                | CrossEntropyLoss     | 0     
-5 | agg_loss                   | AggregatorLoss       | 0     
-6 | punct_class_report         | ClassificationReport | 0     
-7 | chunked_punct_class_report | ClassificationReport | 0     
-8 | domain_class_report        | ClassificationReport | 0     
---------------------------------------------------------------------
-14.2 M    Trainable params
-94.7 M    Non-trainable params
-108 M     Total params
-[INFO] - Punctuation report: 
-label                                                precision    recall       f1           support   
- (label_id: 0)                                          99.20      99.20      99.20      35588
-! (label_id: 1)                                          0.00       0.00       0.00         18
-# (label_id: 2)                                         96.86      99.26      98.05       1494
-, (label_id: 3)                                         70.64      69.46      70.05       1084
-- (label_id: 4)                                         84.69      72.17      77.93        115
-. (label_id: 5)                                         80.31      82.83      81.55        990
-: (label_id: 6)                                         40.00      11.11      17.39         18
-? (label_id: 7)                                         75.00      82.14      78.41         84
-… (label_id: 8)                                          0.00       0.00       0.00         10
--------------------
-micro avg                                               97.74      97.74      97.74      39401
-macro avg                                               60.75      57.35      58.06      39401
-weighted avg                                            97.66      97.74      97.69      39401
-
--------------------
-                       !           #           ,           -           .           :           ?           …
-    35302.00         4.00         9.00       199.00        22.00        43.00         1.00         4.00         4.00
-        0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00
-       48.00         0.00      1483.00         0.00         0.00         0.00         0.00         0.00         0.00
-      163.00         4.00         1.00       753.00         8.00       120.00         8.00         5.00         4.00
-       15.00         0.00         0.00         0.00        83.00         0.00         0.00         0.00         0.00
-       56.00         7.00         1.00       120.00         2.00       820.00         7.00         6.00         2.00
-        0.00         0.00         0.00         2.00         0.00         1.00         2.00         0.00         0.00
-        4.00         3.00         0.00        10.00         0.00         6.00         0.00        69.00         0.00
-        0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00
--------------------
-
-[INFO] - Domain report: 
-label                                                precision    recall       f1           support   
-0 (label_id: 0)                                          0.00       0.00       0.00        168
-1 (label_id: 1)                                         50.00     100.00      66.67        168
--------------------
-micro avg                                               50.00      50.00      50.00        336
-macro avg                                               25.00      50.00      33.33        336
-weighted avg                                            25.00      50.00      33.33        336
-
--------------------
-           0           1
-        0.00         0.00
-      168.00       168.00
--------------------
-
-[INFO] - Punctuation report: 
-label                                                precision    recall       f1           support   
- (label_id: 0)                                          99.12      99.10      99.11     429593
-! (label_id: 1)                                          0.00       0.00       0.00         82
-# (label_id: 2)                                         96.77      98.98      97.86      19814
-, (label_id: 3)                                         69.15      70.48      69.81      13891
-- (label_id: 4)                                         80.43      72.15      76.07       1185
-. (label_id: 5)                                         82.62      81.60      82.11      13225
-: (label_id: 6)                                         46.88      11.67      18.69        257
-? (label_id: 7)                                         76.92      74.68      75.78        924
-… (label_id: 8)                                          0.00       0.00       0.00         63
--------------------
-micro avg                                               97.59      97.59      97.59     479034
-macro avg                                               61.32      56.52      57.71     479034
-weighted avg                                            97.55      97.59      97.56     479034
-
--------------------
-                       !           #           ,           -           .           :           ?           …
-   425736.00        10.00       196.00      2637.00       289.00       552.00        30.00        51.00        23.00
-        0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00
-      634.00         0.00     19612.00         4.00         2.00        15.00         0.00         0.00         0.00
-     2341.00        26.00         1.00      9790.00        32.00      1749.00       106.00        82.00        30.00
-      191.00         0.00         1.00         6.00       855.00        10.00         0.00         0.00         0.00
-      636.00        45.00         4.00      1379.00         6.00     10792.00        90.00       101.00         9.00
-        6.00         0.00         0.00         6.00         0.00        22.00        30.00         0.00         0.00
-       49.00         1.00         0.00        69.00         1.00        85.00         1.00       690.00         1.00
-        0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00
--------------------
-
-[INFO] - Domain report: 
-label                                                precision    recall       f1           support   
-0 (label_id: 0)                                          0.00       0.00       0.00       2043
-1 (label_id: 1)                                         50.00     100.00      66.67       2043
--------------------
-micro avg                                               50.00      50.00      50.00       4086
-macro avg                                               25.00      50.00      33.33       4086
-weighted avg                                            25.00      50.00      33.33       4086
-
--------------------
-           0           1
-        0.00         0.00
-     2043.00      2043.00
--------------------
-
-[INFO] - Epoch 0, global step 449: val_loss reached 7.80818 (best 7.78192), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-01_09-28-23/checkpoints/Punctuation_with_Domain_discriminator---val_loss=7.81-epoch=0.ckpt" as top 3
-[INFO] - Punctuation report: 
-label                                                precision    recall       f1           support   
- (label_id: 0)                                          99.13      99.11      99.12     429965
-! (label_id: 1)                                          0.00       0.00       0.00         82
-# (label_id: 2)                                         96.88      99.03      97.94      19975
-, (label_id: 3)                                         69.11      70.89      69.99      13852
-- (label_id: 4)                                         81.99      72.37      76.88       1227
-. (label_id: 5)                                         82.78      81.43      82.10      13301
-: (label_id: 6)                                         45.31      11.60      18.47        250
-? (label_id: 7)                                         77.91      75.57      76.72        966
-… (label_id: 8)                                          0.00       0.00       0.00         60
--------------------
-micro avg                                               97.61      97.61      97.61     479678
-macro avg                                               61.46      56.67      57.91     479678
-weighted avg                                            97.57      97.61      97.58     479678
-
--------------------
-                       !           #           ,           -           .           :           ?           …
-   426137.00        10.00       189.00      2582.00       296.00       562.00        28.00        55.00        25.00
-        0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00
-      615.00         0.00     19781.00         4.00         2.00        16.00         0.00         0.00         0.00
-     2343.00        27.00         1.00      9819.00        35.00      1780.00        96.00        80.00        27.00
-      180.00         0.00         0.00         5.00       888.00        10.00         0.00         0.00         0.00
-      627.00        43.00         4.00      1369.00         5.00     10831.00        96.00       101.00         8.00
-        7.00         0.00         0.00         6.00         0.00        22.00        29.00         0.00         0.00
-       56.00         2.00         0.00        67.00         1.00        80.00         1.00       730.00         0.00
-        0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00
--------------------
-
-[INFO] - Domain report: 
-label                                                precision    recall       f1           support   
-0 (label_id: 0)                                          0.00       0.00       0.00       2043
-1 (label_id: 1)                                         50.00     100.00      66.67       2043
--------------------
-micro avg                                               50.00      50.00      50.00       4086
-macro avg                                               25.00      50.00      33.33       4086
-weighted avg                                            25.00      50.00      33.33       4086
-
--------------------
-           0           1
-        0.00         0.00
-     2043.00      2043.00
--------------------
-
-[INFO] - Epoch 1, global step 499: val_loss reached 7.66479 (best 7.66479), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-01_09-28-23/checkpoints/Punctuation_with_Domain_discriminator---val_loss=7.66-epoch=1.ckpt" as top 3
-[INFO] - Punctuation report: 
-label                                                precision    recall       f1           support   
- (label_id: 0)                                          99.10      99.10      99.10     429155
-! (label_id: 1)                                          0.00       0.00       0.00         90
-# (label_id: 2)                                         96.82      99.02      97.91      20042
-, (label_id: 3)                                         69.21      70.64      69.92      14003
-- (label_id: 4)                                         81.29      72.95      76.90       1209
-. (label_id: 5)                                         82.80      81.36      82.07      13293
-: (label_id: 6)                                         45.31      10.94      17.63        265
-? (label_id: 7)                                         77.05      74.36      75.68        975
-… (label_id: 8)                                          0.00       0.00       0.00         61
--------------------
-micro avg                                               97.58      97.58      97.58     479093
-macro avg                                               61.29      56.49      57.69     479093
-weighted avg                                            97.53      97.58      97.55     479093
-
--------------------
-                       !           #           ,           -           .           :           ?           …
-   425303.00        13.00       193.00      2659.00       289.00       587.00        32.00        53.00        23.00
-        0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00
-      631.00         0.00     19846.00         3.00         2.00        15.00         0.00         0.00         0.00
-     2362.00        22.00         1.00      9892.00        31.00      1764.00       100.00        92.00        28.00
-      190.00         0.00         0.00         5.00       882.00         8.00         0.00         0.00         0.00
-      611.00        52.00         2.00      1360.00         4.00     10815.00       103.00       105.00        10.00
-        7.00         0.00         0.00         6.00         0.00        22.00        29.00         0.00         0.00
-       51.00         3.00         0.00        78.00         1.00        82.00         1.00       725.00         0.00
-        0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00
--------------------
-
-[INFO] - Domain report: 
-label                                                precision    recall       f1           support   
-0 (label_id: 0)                                          0.00       0.00       0.00       2043
-1 (label_id: 1)                                         50.00     100.00      66.67       2043
--------------------
-micro avg                                               50.00      50.00      50.00       4086
-macro avg                                               25.00      50.00      33.33       4086
-weighted avg                                            25.00      50.00      33.33       4086
-
--------------------
-           0           1
-        0.00         0.00
-     2043.00      2043.00
--------------------
-
-[INFO] - Epoch 2, step 549: val_loss was not in top 3
-[INFO] - Punctuation report: 
-label                                                precision    recall       f1           support   
- (label_id: 0)                                          99.10      99.10      99.10     428784
-! (label_id: 1)                                          0.00       0.00       0.00         74
-# (label_id: 2)                                         96.87      99.00      97.92      19942
-, (label_id: 3)                                         69.31      70.22      69.77      13958
-- (label_id: 4)                                         80.66      73.26      76.78       1167
-. (label_id: 5)                                         82.54      81.73      82.13      13210
-: (label_id: 6)                                         47.06      11.47      18.44        279
-? (label_id: 7)                                         77.25      75.03      76.12        973
-… (label_id: 8)                                          0.00       0.00       0.00         61
--------------------
-micro avg                                               97.58      97.58      97.58     478448
-macro avg                                               61.42      56.65      57.81     478448
-weighted avg                                            97.54      97.58      97.55     478448
-
--------------------
-                       !           #           ,           -           .           :           ?           …
-   424927.00        10.00       196.00      2684.00       271.00       573.00        34.00        55.00        24.00
-        0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00
-      627.00         0.00     19742.00         2.00         2.00         6.00         0.00         0.00         0.00
-     2355.00        24.00         1.00      9802.00        33.00      1715.00       108.00        78.00        26.00
-      189.00         0.00         0.00         5.00       855.00        11.00         0.00         0.00         0.00
-      629.00        39.00         3.00      1385.00         5.00     10796.00       103.00       110.00        10.00
-        7.00         0.00         0.00         6.00         0.00        23.00        32.00         0.00         0.00
-       50.00         1.00         0.00        74.00         1.00        86.00         2.00       730.00         1.00
-        0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00
--------------------
-
-[INFO] - Domain report: 
-label                                                precision    recall       f1           support   
-0 (label_id: 0)                                          0.00       0.00       0.00       2043
-1 (label_id: 1)                                         50.00     100.00      66.67       2043
--------------------
-micro avg                                               50.00      50.00      50.00       4086
-macro avg                                               25.00      50.00      33.33       4086
-weighted avg                                            25.00      50.00      33.33       4086
-
--------------------
-           0           1
-        0.00         0.00
-     2043.00      2043.00
--------------------
-
-[INFO] - Epoch 3, global step 599: val_loss reached 7.72051 (best 7.66479), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-01_09-28-23/checkpoints/Punctuation_with_Domain_discriminator---val_loss=7.72-epoch=3.ckpt" as top 3
-[INFO] - Punctuation report: 
-label                                                precision    recall       f1           support   
- (label_id: 0)                                          99.11      99.09      99.10     429860
-! (label_id: 1)                                          0.00       0.00       0.00         87
-# (label_id: 2)                                         96.84      99.01      97.91      20010
-, (label_id: 3)                                         68.96      70.15      69.55      13835
-- (label_id: 4)                                         81.05      72.61      76.60       1190
-. (label_id: 5)                                         82.36      81.70      82.03      13292
-: (label_id: 6)                                         46.27      11.92      18.96        260
-? (label_id: 7)                                         76.76      74.23      75.47        970
-… (label_id: 8)                                          0.00       0.00       0.00         59
--------------------
-micro avg                                               97.58      97.58      97.58     479563
-macro avg                                               61.26      56.52      57.74     479563
-weighted avg                                            97.53      97.58      97.55     479563
-
--------------------
-                       !           #           ,           -           .           :           ?           …
-   425951.00        10.00       193.00      2648.00       283.00       571.00        32.00        65.00        24.00
-        0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00
-      636.00         0.00     19811.00         3.00         2.00         6.00         0.00         0.00         0.00
-     2365.00        26.00         1.00      9705.00        35.00      1737.00        96.00        81.00        27.00
-      189.00         0.00         1.00         4.00       864.00         8.00         0.00         0.00         0.00
-      659.00        49.00         3.00      1398.00         5.00     10859.00       100.00       104.00         7.00
-        7.00         0.00         0.00         5.00         0.00        24.00        31.00         0.00         0.00
-       53.00         2.00         1.00        72.00         1.00        87.00         1.00       720.00         1.00
-        0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00
--------------------
-
-[INFO] - Domain report: 
-label                                                precision    recall       f1           support   
-0 (label_id: 0)                                          0.00       0.00       0.00       2043
-1 (label_id: 1)                                         50.00     100.00      66.67       2043
--------------------
-micro avg                                               50.00      50.00      50.00       4086
-macro avg                                               25.00      50.00      33.33       4086
-weighted avg                                            25.00      50.00      33.33       4086
-
--------------------
-           0           1
-        0.00         0.00
-     2043.00      2043.00
--------------------
-
-[INFO] - Epoch 4, step 649: val_loss was not in top 3
-[INFO] - Punctuation report: 
-label                                                precision    recall       f1           support   
- (label_id: 0)                                          99.11      99.10      99.10     429659
-! (label_id: 1)                                          0.00       0.00       0.00         85
-# (label_id: 2)                                         96.85      98.98      97.90      20044
-, (label_id: 3)                                         69.38      70.72      70.04      13925
-- (label_id: 4)                                         81.39      72.70      76.80       1209
-. (label_id: 5)                                         82.77      81.81      82.28      13291
-: (label_id: 6)                                         47.06      11.76      18.82        272
-? (label_id: 7)                                         76.95      73.67      75.27        938
-… (label_id: 8)                                          0.00       0.00       0.00         67
--------------------
-micro avg                                               97.59      97.59      97.59     479490
-macro avg                                               61.50      56.53      57.80     479490
-weighted avg                                            97.55      97.59      97.56     479490
-
--------------------
-                       !           #           ,           -           .           :           ?           …
-   425787.00        13.00       200.00      2656.00       289.00       569.00        32.00        56.00        25.00
-        0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00
-      633.00         0.00     19839.00         5.00         1.00         7.00         0.00         0.00         0.00
-     2347.00        22.00         1.00      9848.00        34.00      1723.00       103.00        87.00        30.00
-      184.00         0.00         1.00         5.00       879.00        11.00         0.00         0.00         0.00
-      650.00        47.00         3.00      1341.00         5.00     10873.00       103.00       104.00        11.00
-        8.00         0.00         0.00         5.00         0.00        23.00        32.00         0.00         0.00
-       50.00         3.00         0.00        65.00         1.00        85.00         2.00       691.00         1.00
-        0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00
--------------------
-
-[INFO] - Domain report: 
-label                                                precision    recall       f1           support   
-0 (label_id: 0)                                          0.00       0.00       0.00       2043
-1 (label_id: 1)                                         50.00     100.00      66.67       2043
--------------------
-micro avg                                               50.00      50.00      50.00       4086
-macro avg                                               25.00      50.00      33.33       4086
-weighted avg                                            25.00      50.00      33.33       4086
-
--------------------
-           0           1
-        0.00         0.00
-     2043.00      2043.00
--------------------
-
-[INFO] - Epoch 5, step 699: val_loss was not in top 3
-[INFO] - Punctuation report: 
-label                                                precision    recall       f1           support   
- (label_id: 0)                                          99.12      99.09      99.11     429924
-! (label_id: 1)                                          0.00       0.00       0.00         83
-# (label_id: 2)                                         96.83      99.10      97.95      20142
-, (label_id: 3)                                         69.41      70.62      70.01      13997
-- (label_id: 4)                                         81.14      73.09      76.90       1230
-. (label_id: 5)                                         82.43      81.92      82.17      13205
-: (label_id: 6)                                         45.90      10.53      17.13        266
-? (label_id: 7)                                         77.77      75.08      76.40        927
-… (label_id: 8)                                          0.00       0.00       0.00         62
--------------------
-micro avg                                               97.60      97.60      97.60     479836
-macro avg                                               61.40      56.60      57.74     479836
-weighted avg                                            97.55      97.60      97.57     479836
-
--------------------
-                       !           #           ,           -           .           :           ?           …
-   426020.00        13.00       178.00      2638.00       288.00       553.00        30.00        52.00        24.00
-        0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00
-      640.00         0.00     19960.00         3.00         2.00         8.00         0.00         0.00         0.00
-     2373.00        22.00         1.00      9884.00        34.00      1714.00       105.00        78.00        29.00
-      195.00         0.00         0.00         5.00       899.00         9.00         0.00         0.00         0.00
-      644.00        47.00         3.00      1394.00         6.00     10817.00       102.00       101.00         9.00
-        7.00         0.00         0.00         5.00         0.00        21.00        28.00         0.00         0.00
-       45.00         1.00         0.00        68.00         1.00        83.00         1.00       696.00         0.00
-        0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00
--------------------
-
-[INFO] - Domain report: 
-label                                                precision    recall       f1           support   
-0 (label_id: 0)                                          0.00       0.00       0.00       2043
-1 (label_id: 1)                                         50.00     100.00      66.67       2043
--------------------
-micro avg                                               50.00      50.00      50.00       4086
-macro avg                                               25.00      50.00      33.33       4086
-weighted avg                                            25.00      50.00      33.33       4086
-
--------------------
-           0           1
-        0.00         0.00
-     2043.00      2043.00
--------------------
-
-[INFO] - Epoch 6, step 749: val_loss was not in top 3
-[INFO] - Punctuation report: 
-label                                                precision    recall       f1           support   
- (label_id: 0)                                          99.11      99.11      99.11     429584
-! (label_id: 1)                                          0.00       0.00       0.00         85
-# (label_id: 2)                                         96.93      98.91      97.91      20017
-, (label_id: 3)                                         69.41      70.33      69.87      13894
-- (label_id: 4)                                         80.97      72.70      76.61       1176
-. (label_id: 5)                                         82.56      81.99      82.27      13225
-: (label_id: 6)                                         52.94      13.38      21.36        269
-? (label_id: 7)                                         76.43      74.19      75.29        953
-… (label_id: 8)                                          0.00       0.00       0.00         59
--------------------
-micro avg                                               97.60      97.60      97.60     479262
-macro avg                                               62.04      56.74      58.05     479262
-weighted avg                                            97.56      97.60      97.57     479262
-
--------------------
-                       !           #           ,           -           .           :           ?           …
-   425765.00         9.00       213.00      2658.00       279.00       538.00        34.00        57.00        22.00
-        0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00
-      617.00         0.00     19799.00         3.00         1.00         7.00         0.00         0.00         0.00
-     2314.00        25.00         1.00      9772.00        35.00      1720.00       100.00        83.00        28.00
-      182.00         0.00         1.00         6.00       855.00        12.00         0.00         0.00         0.00
-      645.00        50.00         3.00      1375.00         5.00     10843.00        97.00       106.00         9.00
-        6.00         0.00         0.00         4.00         0.00        22.00        36.00         0.00         0.00
-       55.00         1.00         0.00        76.00         1.00        83.00         2.00       707.00         0.00
-        0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00
--------------------
-
-[INFO] - Domain report: 
-label                                                precision    recall       f1           support   
-0 (label_id: 0)                                          0.00       0.00       0.00       2043
-1 (label_id: 1)                                         50.00     100.00      66.67       2043
--------------------
-micro avg                                               50.00      50.00      50.00       4086
-macro avg                                               25.00      50.00      33.33       4086
-weighted avg                                            25.00      50.00      33.33       4086
-
--------------------
-           0           1
-        0.00         0.00
-     2043.00      2043.00
--------------------
-
-[INFO] - Epoch 7, global step 799: val_loss reached 7.78175 (best 7.66479), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-01_09-28-23/checkpoints/Punctuation_with_Domain_discriminator---val_loss=7.78-epoch=7.ckpt" as top 3
-[INFO] - Global seed set to 42
-[INFO] - Optimizer config = AdamW (
-Parameter Group 0
-    amsgrad: False
-    betas: (0.9, 0.999)
-    eps: 1e-08
-    lr: 0.0001
-    weight_decay: 0.0
-)
-[INFO] - Scheduler "<core.optim.lr_scheduler.CosineAnnealing object at 0x7ff60ca2d790>" 
-will be used during training (effective maximum steps = 400) - 
-Parameters : 
-(warmup_steps: null
-warmup_ratio: 0.1
-min_lr: 1.0e-08
-last_epoch: -1
-max_steps: 400
-)
-[INFO] - 
-  | Name                       | Type                 | Params
---------------------------------------------------------------------
-0 | transformer                | ElectraModel         | 108 M 
-1 | punct_classifier           | TokenClassifier      | 6.9 K 
-2 | domain_classifier          | SequenceClassifier   | 3.1 K 
-3 | punctuation_loss           | LinearChainCRF       | 99    
-4 | domain_loss                | CrossEntropyLoss     | 0     
-5 | agg_loss                   | AggregatorLoss       | 0     
-6 | punct_class_report         | ClassificationReport | 0     
-7 | chunked_punct_class_report | ClassificationReport | 0     
-8 | domain_class_report        | ClassificationReport | 0     
---------------------------------------------------------------------
-21.3 M    Trainable params
-87.6 M    Non-trainable params
-108 M     Total params
-[INFO] - Punctuation report: 
-label                                                precision    recall       f1           support   
- (label_id: 0)                                          99.20      99.19      99.19      35588
-! (label_id: 1)                                          0.00       0.00       0.00         18
-# (label_id: 2)                                         96.86      99.26      98.05       1494
-, (label_id: 3)                                         70.68      69.37      70.02       1084
-- (label_id: 4)                                         84.69      72.17      77.93        115
-. (label_id: 5)                                         80.18      82.93      81.53        990
-: (label_id: 6)                                         40.00      11.11      17.39         18
-? (label_id: 7)                                         75.00      82.14      78.41         84
-… (label_id: 8)                                          0.00       0.00       0.00         10
--------------------
-micro avg                                               97.74      97.74      97.74      39401
-macro avg                                               60.73      57.35      58.06      39401
-weighted avg                                            97.65      97.74      97.69      39401
-
--------------------
-                       !           #           ,           -           .           :           ?           …
-    35301.00         4.00         9.00       199.00        22.00        43.00         1.00         4.00         4.00
-        0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00
-       48.00         0.00      1483.00         0.00         0.00         0.00         0.00         0.00         0.00
-      163.00         4.00         1.00       752.00         8.00       119.00         8.00         5.00         4.00
-       15.00         0.00         0.00         0.00        83.00         0.00         0.00         0.00         0.00
-       57.00         7.00         1.00       121.00         2.00       821.00         7.00         6.00         2.00
-        0.00         0.00         0.00         2.00         0.00         1.00         2.00         0.00         0.00
-        4.00         3.00         0.00        10.00         0.00         6.00         0.00        69.00         0.00
-        0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00
--------------------
-
-[INFO] - Domain report: 
-label                                                precision    recall       f1           support   
-0 (label_id: 0)                                          0.00       0.00       0.00        168
-1 (label_id: 1)                                         50.00     100.00      66.67        168
--------------------
-micro avg                                               50.00      50.00      50.00        336
-macro avg                                               25.00      50.00      33.33        336
-weighted avg                                            25.00      50.00      33.33        336
-
--------------------
-           0           1
-        0.00         0.00
-      168.00       168.00
--------------------
-
-[INFO] - Punctuation report: 
-label                                                precision    recall       f1           support   
- (label_id: 0)                                          99.12      99.10      99.11     429593
-! (label_id: 1)                                          0.00       0.00       0.00         82
-# (label_id: 2)                                         96.76      98.98      97.86      19814
-, (label_id: 3)                                         69.26      70.36      69.81      13891
-- (label_id: 4)                                         80.43      72.15      76.07       1185
-. (label_id: 5)                                         82.53      81.72      82.12      13225
-: (label_id: 6)                                         46.15      11.67      18.63        257
-? (label_id: 7)                                         76.86      74.78      75.81        924
-… (label_id: 8)                                          0.00       0.00       0.00         63
--------------------
-micro avg                                               97.59      97.59      97.59     479034
-macro avg                                               61.24      56.53      57.71     479034
-weighted avg                                            97.55      97.59      97.56     479034
-
--------------------
-                       !           #           ,           -           .           :           ?           …
-   425739.00        10.00       196.00      2644.00       289.00       550.00        30.00        51.00        23.00
-        0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00
-      636.00         0.00     19612.00         4.00         2.00        15.00         0.00         0.00         0.00
-     2331.00        26.00         1.00      9774.00        32.00      1736.00       101.00        81.00        30.00
-      191.00         0.00         1.00         6.00       855.00        10.00         0.00         0.00         0.00
-      640.00        45.00         4.00      1387.00         6.00     10807.00        95.00       101.00         9.00
-        7.00         0.00         0.00         6.00         0.00        22.00        30.00         0.00         0.00
-       49.00         1.00         0.00        70.00         1.00        85.00         1.00       691.00         1.00
-        0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00
--------------------
-
-[INFO] - Domain report: 
-label                                                precision    recall       f1           support   
-0 (label_id: 0)                                          0.00       0.00       0.00       2043
-1 (label_id: 1)                                         50.00     100.00      66.67       2043
--------------------
-micro avg                                               50.00      50.00      50.00       4086
-macro avg                                               25.00      50.00      33.33       4086
-weighted avg                                            25.00      50.00      33.33       4086
-
--------------------
-           0           1
-        0.00         0.00
-     2043.00      2043.00
--------------------
-
-[INFO] - Epoch 0, step 849: val_loss was not in top 3
-[INFO] - Punctuation report: 
-label                                                precision    recall       f1           support   
- (label_id: 0)                                          99.13      99.11      99.12     429965
-! (label_id: 1)                                          0.00       0.00       0.00         82
-# (label_id: 2)                                         96.87      99.03      97.94      19975
-, (label_id: 3)                                         69.20      70.76      69.97      13852
-- (label_id: 4)                                         81.99      72.37      76.88       1227
-. (label_id: 5)                                         82.70      81.57      82.13      13301
-: (label_id: 6)                                         45.31      11.60      18.47        250
-? (label_id: 7)                                         77.77      75.67      76.71        966
-… (label_id: 8)                                          0.00       0.00       0.00         60
--------------------
-micro avg                                               97.61      97.61      97.61     479678
-macro avg                                               61.44      56.68      57.91     479678
-weighted avg                                            97.57      97.61      97.58     479678
-
--------------------
-                       !           #           ,           -           .           :           ?           …
-   426138.00        10.00       189.00      2587.00       296.00       560.00        28.00        55.00        25.00
-        0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00
-      617.00         0.00     19781.00         4.00         2.00        16.00         0.00         0.00         0.00
-     2336.00        27.00         1.00      9802.00        35.00      1764.00        94.00        79.00        27.00
-      180.00         0.00         0.00         5.00       888.00        10.00         0.00         0.00         0.00
-      630.00        43.00         4.00      1380.00         5.00     10849.00        98.00       101.00         8.00
-        7.00         0.00         0.00         6.00         0.00        22.00        29.00         0.00         0.00
-       57.00         2.00         0.00        68.00         1.00        80.00         1.00       731.00         0.00
-        0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00
--------------------
-
-[INFO] - Domain report: 
-label                                                precision    recall       f1           support   
-0 (label_id: 0)                                          0.00       0.00       0.00       2043
-1 (label_id: 1)                                         50.00     100.00      66.67       2043
--------------------
-micro avg                                               50.00      50.00      50.00       4086
-macro avg                                               25.00      50.00      33.33       4086
-weighted avg                                            25.00      50.00      33.33       4086
-
--------------------
-           0           1
-        0.00         0.00
-     2043.00      2043.00
--------------------
-
-[INFO] - Epoch 1, global step 899: val_loss reached 7.66359 (best 7.66359), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-01_09-28-23/checkpoints/Punctuation_with_Domain_discriminator---val_loss=7.66-epoch=1-v0.ckpt" as top 3
-[INFO] - Punctuation report: 
-label                                                precision    recall       f1           support   
- (label_id: 0)                                          99.10      99.10      99.10     429155
-! (label_id: 1)                                          0.00       0.00       0.00         90
-# (label_id: 2)                                         96.81      99.02      97.91      20042
-, (label_id: 3)                                         69.29      70.51      69.89      14003
-- (label_id: 4)                                         81.29      72.95      76.90       1209
-. (label_id: 5)                                         82.71      81.49      82.09      13293
-: (label_id: 6)                                         45.31      10.94      17.63        265
-? (label_id: 7)                                         76.96      74.36      75.64        975
-… (label_id: 8)                                          0.00       0.00       0.00         61
--------------------
-micro avg                                               97.58      97.58      97.58     479093
-macro avg                                               61.28      56.49      57.68     479093
-weighted avg                                            97.53      97.58      97.55     479093
-
--------------------
-                       !           #           ,           -           .           :           ?           …
-   425302.00        13.00       193.00      2667.00       289.00       585.00        33.00        53.00        23.00
-        0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00
-      633.00         0.00     19846.00         3.00         2.00        15.00         0.00         0.00         0.00
-     2357.00        22.00         1.00      9873.00        31.00      1749.00        96.00        92.00        27.00
-      190.00         0.00         0.00         5.00       882.00         8.00         0.00         0.00         0.00
-      614.00        52.00         2.00      1371.00         4.00     10832.00       106.00       105.00        11.00
-        7.00         0.00         0.00         6.00         0.00        22.00        29.00         0.00         0.00
-       52.00         3.00         0.00        78.00         1.00        82.00         1.00       725.00         0.00
-        0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00         0.00
--------------------
-
-[INFO] - Domain report: 
-label                                                precision    recall       f1           support   
-0 (label_id: 0)                                          0.00       0.00       0.00       2043
-1 (label_id: 1)                                         50.00     100.00      66.67       2043
--------------------
-micro avg                                               50.00      50.00      50.00       4086
-macro avg                                               25.00      50.00      33.33       4086
-weighted avg                                            25.00      50.00      33.33       4086
-
--------------------
-           0           1
-        0.00         0.00
-     2043.00      2043.00
--------------------
-
-[INFO] - Epoch 2, step 949: val_loss was not in top 3
