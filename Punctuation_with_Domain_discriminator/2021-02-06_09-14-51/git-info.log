commit hash: cce540d4c95ad9ed32010552a7aa1fb2486658c8
diff --git a/experiment/config.yaml b/experiment/config.yaml
index 3d27dd7..6d84830 100644
--- a/experiment/config.yaml
+++ b/experiment/config.yaml
@@ -1,43 +1,43 @@
 seed: 42
 trainer:
-    gpus: 1 # the number of gpus, 0 for CPU
-    num_nodes: 1
-    max_epochs: 2
-    max_steps: null # precedence over max_epochs
-    accumulate_grad_batches: 4 # accumulates grads every k batches
-    gradient_clip_val: 0
-    amp_level: O1 # O1/O2 for mixed precision
-    precision: 16 # Should be set to 16 for O1 and O2, default is 16 as PT ignores it when am_level is O0
-    accelerator: ddp
-    checkpoint_callback: false  # Provided by exp_manager
-    logger: false #false  # Provided by exp_manager
-    log_every_n_steps: 1  # Interval of logging.
-    val_check_interval: 1.0  # Set to 0.25 to check 4 times per epoch, or an int for number of iterations
-    resume_from_checkpoint: null
-
-    # gpus: 0 # the number of gpus, 0 for CPU
+    # gpus: 1 # the number of gpus, 0 for CPU
     # num_nodes: 1
-    # max_epochs: 10
+    # max_epochs: 2
     # max_steps: null # precedence over max_epochs
     # accumulate_grad_batches: 4 # accumulates grads every k batches
     # gradient_clip_val: 0
-    # amp_level: O0 # O1/O2 for mixed precision
-    # precision: 32 # Should be set to 16 for O1 and O2, default is 16 as PT ignores it when am_level is O0
-    # # accelerator: ddp
+    # amp_level: O1 # O1/O2 for mixed precision
+    # precision: 16 # Should be set to 16 for O1 and O2, default is 16 as PT ignores it when am_level is O0
+    # accelerator: ddp
     # checkpoint_callback: false  # Provided by exp_manager
     # logger: false #false  # Provided by exp_manager
     # log_every_n_steps: 1  # Interval of logging.
     # val_check_interval: 1.0  # Set to 0.25 to check 4 times per epoch, or an int for number of iterations
-    # reload_dataloaders_every_epoch: true
     # resume_from_checkpoint: null
 
+    gpus: 0 # the number of gpus, 0 for CPU
+    num_nodes: 1
+    max_epochs: 8
+    max_steps: null # precedence over max_epochs
+    accumulate_grad_batches: 4 # accumulates grads every k batches
+    gradient_clip_val: 0
+    amp_level: O0 # O1/O2 for mixed precision
+    precision: 32 # Should be set to 16 for O1 and O2, default is 16 as PT ignores it when am_level is O0
+    # accelerator: ddp
+    checkpoint_callback: false  # Provided by exp_manager
+    logger: false #false  # Provided by exp_manager
+    log_every_n_steps: 1  # Interval of logging.
+    val_check_interval: 1.0  # Set to 0.25 to check 4 times per epoch, or an int for number of iterations
+    reload_dataloaders_every_epoch: true
+    resume_from_checkpoint: null
+
 exp_manager:
-    exp_dir: /root/experiments # /home/nxingyu2/project/ # exp_dir for your experiment, if None, defaults to "./nemo_experiments"
+    exp_dir: /home/nxingyu2/project/ # /root/experiments # exp_dir for your experiment, if None, defaults to "./nemo_experiments"
     name: Punctuation_with_Domain_discriminator  # The name of your model
     create_tensorboard_logger: true  # Whether you want exp_manger to create a tb logger
     create_checkpoint_callback: true 
-base_path: /root/data # /home/nxingyu2/data # 
-tmp_path: /tmp # /home/nxingyu2/data/tmp # 
+base_path: /home/nxingyu2/data # /root/data # 
+tmp_path: /home/nxingyu2/data/tmp # /tmp # 
 
 model:
     nemo_path: null
@@ -61,7 +61,7 @@ model:
     punct_class_weights: true
     
     dataset:
-        data_dir: /root/data # /home/nxingyu2/data # 
+        data_dir: /home/nxingyu2/data # /root/data # 
         labelled:
             - ${base_path}/ted_talks_processed #
         unlabelled:
@@ -125,17 +125,18 @@ model:
     
     dice_loss:
         epsilon: 0.01
-        alpha: 4
+        alpha: 3
         macro_average: true
 
     focal_loss: 
         gamma: 5
 
     optim:
-        name: adamw
+        name: ranger
         lr: 1e-3
         weight_decay: 0.00
 
+        delay_epochs: 4
         sched:
             name: WarmupAnnealing #CyclicLR
             # Scheduler params
@@ -145,7 +146,7 @@ model:
 
             # pytorch lightning args
             monitor: val_loss
-            reduce_on_plateau: true
+            reduce_on_plateau: false
 hydra:
     run:
         dir: .
diff --git a/experiment/core/optim/lr_scheduler.py b/experiment/core/optim/lr_scheduler.py
index a17ebf8..4944555 100644
--- a/experiment/core/optim/lr_scheduler.py
+++ b/experiment/core/optim/lr_scheduler.py
@@ -347,6 +347,39 @@ class PolynomialHoldDecayAnnealing(WarmupHoldPolicy):
         return new_lrs
 
 
+class DelayerScheduler(_LRScheduler):
+	""" Starts with a flat lr schedule until it reaches N epochs the applies a scheduler 
+	Args:
+		optimizer (Optimizer): Wrapped optimizer.
+		delay_epochs: number of epochs to keep the initial lr until starting aplying the scheduler
+		after_scheduler: after target_epoch, use this scheduler(eg. ReduceLROnPlateau)
+	"""
+
+	def __init__(self, optimizer, delay_epochs, after_scheduler):
+		self.delay_epochs = delay_epochs
+		self.after_scheduler = after_scheduler
+		self.finished = False
+		super().__init__(optimizer)
+
+	def get_lr(self):
+		if self.last_epoch >= self.delay_epochs:
+			if not self.finished:
+				self.after_scheduler.base_lrs = self.base_lrs
+				self.finished = True
+			return self.after_scheduler.get_lr()
+
+		return self.base_lrs
+
+	def step(self, epoch=None):
+		if self.finished:
+			if epoch is None:
+				self.after_scheduler.step(None)
+			else:
+				self.after_scheduler.step(epoch - self.delay_epochs)
+		else:
+			return super(DelayerScheduler, self).step(epoch)
+
+
 def register_scheduler(name: str, scheduler: _LRScheduler, scheduler_params: SchedulerParams):
     """
     Checks if the scheduler name exists in the registry, and if it doesnt, adds it.
@@ -365,7 +398,7 @@ def register_scheduler(name: str, scheduler: _LRScheduler, scheduler_params: Sch
     register_scheduler_params(name=sched_name, scheduler_params=scheduler_params)
 
 
-def get_scheduler(name: str, **kwargs: Optional[Dict[str, Any]]) -> _LRScheduler:
+def get_scheduler(name: str, optimizer, delay_epochs, **kwargs: Optional[Dict[str, Any]]) -> _LRScheduler:
     """
     Convenience method to obtain an _LRScheduler class and partially instantiate it with optimizer kwargs.
     Args:
@@ -380,12 +413,15 @@ def get_scheduler(name: str, **kwargs: Optional[Dict[str, Any]]) -> _LRScheduler
         )
 
     scheduler_cls = AVAILABLE_SCHEDULERS[name]
-    scheduler = partial(scheduler_cls, **kwargs)
+    scheduler = scheduler_cls(optimizer=optimizer, **kwargs)
+    if delay_epochs>0:
+        scheduler = DelayerScheduler(optimizer=optimizer,delay_epochs=delay_epochs,after_scheduler=scheduler)
     return scheduler
 
 
 def prepare_lr_scheduler(
     optimizer: optim.Optimizer,
+    delay_epochs: int,
     scheduler_config: Union[Dict[str, Any], DictConfig],
     train_dataloader: Optional[Dict[str,int]] = None,
 
@@ -584,10 +620,10 @@ def prepare_lr_scheduler(
         scheduler_args['max_steps'] = max_steps
 
     # Get the scheduler class from the config
-    scheduler_cls = get_scheduler(scheduler_name, **scheduler_args)
+    scheduler = get_scheduler(scheduler_name, optimizer, delay_epochs, **scheduler_args)
 
     # Instantiate the LR schedule
-    schedule = scheduler_cls(optimizer, **scheduler_args)
+    # schedule = scheduler_cls(optimizer, **scheduler_args)
 
     logging.info(
         'Scheduler "%s" \nwill be used during training (effective maximum steps = %d) - \nParameters : \n(%s)',
diff --git a/experiment/core/optim/optimizers.py b/experiment/core/optim/optimizers.py
index 5afc4fd..f15686e 100644
--- a/experiment/core/optim/optimizers.py
+++ b/experiment/core/optim/optimizers.py
@@ -7,6 +7,7 @@ import torch.optim as optim
 from omegaconf import DictConfig, OmegaConf
 from torch.optim import adadelta, adagrad, adamax, rmsprop, rprop
 from torch.optim.optimizer import Optimizer
+from torchtools.optim import Ranger
 
 from core.config import OptimizerParams, get_optimizer_config, register_optimizer_params
 from core.optim.novograd import Novograd
@@ -24,6 +25,7 @@ AVAILABLE_OPTIMIZERS = {
     'rmsprop': rmsprop.RMSprop,
     'rprop': rprop.Rprop,
     'novograd': Novograd,
+    'ranger': Ranger,
 }
 
 
diff --git a/experiment/info.log b/experiment/info.log
index b211d42..5024c4f 100644
--- a/experiment/info.log
+++ b/experiment/info.log
@@ -1,473 +1,2 @@
-[INFO] - shuffling train set
-[INFO] - Optimizer config = AdamW (
-Parameter Group 0
-    amsgrad: False
-    betas: (0.9, 0.999)
-    eps: 1e-08
-    lr: 0.001
-    weight_decay: 0.0
-)
-[INFO] - Scheduler "<core.optim.lr_scheduler.WarmupAnnealing object at 0x7fee4da7f8e0>" 
-will be used during training (effective maximum steps = 80) - 
-Parameters : 
-(warmup_steps: null
-warmup_ratio: 0.1
-last_epoch: -1
-max_steps: 80
-)
-[INFO] - Punctuation report: 
-label                                                precision    recall       f1           support   
- (label_id: 0)                                          24.14      10.10      14.24        208
-! (label_id: 1)                                          0.00       0.00       0.00         13
-, (label_id: 2)                                         34.00       2.47       4.60        689
-- (label_id: 3)                                          4.42       8.62       5.85         58
-. (label_id: 4)                                         50.00       1.57       3.05        572
-: (label_id: 5)                                          0.55      40.00       1.09         10
-; (label_id: 6)                                          0.00       0.00       0.00          6
-? (label_id: 7)                                          2.18      17.39       3.87         46
-— (label_id: 8)                                          1.42       5.71       2.27         35
-… (label_id: 9)                                          0.00       0.00       0.00          4
--------------------
-micro avg                                                4.02       4.02       4.02       1641
-macro avg                                               11.67       8.59       3.50       1641
-weighted avg                                            35.01       4.02       5.17       1641
-
-[INFO] - Domain report: 
-label                                                precision    recall       f1           support   
-0 (label_id: 0)                                        100.00     100.00     100.00        104
--------------------
-micro avg                                              100.00     100.00     100.00        104
-macro avg                                              100.00     100.00     100.00        104
-weighted avg                                           100.00     100.00     100.00        104
-
-[INFO] - Optimizer config = AdamW (
-Parameter Group 0
-    amsgrad: False
-    betas: (0.9, 0.999)
-    eps: 1e-08
-    lr: 0.008413951416451957
-    weight_decay: 0.0
-)
-[INFO] - Scheduler "<core.optim.lr_scheduler.WarmupAnnealing object at 0x7fee4e67aa00>" 
-will be used during training (effective maximum steps = 200) - 
-Parameters : 
-(warmup_steps: null
-warmup_ratio: 0.1
-last_epoch: -1
-max_steps: 200
-)
-[INFO] - Punctuation report: 
-label                                                precision    recall       f1           support   
- (label_id: 0)                                          24.14      10.10      14.24        208
-! (label_id: 1)                                          0.00       0.00       0.00         13
-, (label_id: 2)                                         34.00       2.47       4.60        689
-- (label_id: 3)                                          4.42       8.62       5.85         58
-. (label_id: 4)                                         50.00       1.57       3.05        572
-: (label_id: 5)                                          0.55      40.00       1.09         10
-; (label_id: 6)                                          0.00       0.00       0.00          6
-? (label_id: 7)                                          2.18      17.39       3.87         46
-— (label_id: 8)                                          1.42       5.71       2.27         35
-… (label_id: 9)                                          0.00       0.00       0.00          4
--------------------
-micro avg                                                4.02       4.02       4.02       1641
-macro avg                                               11.67       8.59       3.50       1641
-weighted avg                                            35.01       4.02       5.17       1641
-
-[INFO] - Domain report: 
-label                                                precision    recall       f1           support   
-0 (label_id: 0)                                        100.00     100.00     100.00        104
--------------------
-micro avg                                              100.00     100.00     100.00        104
-macro avg                                              100.00     100.00     100.00        104
-weighted avg                                           100.00     100.00     100.00        104
-
-[INFO] - Punctuation report: 
-label                                                precision    recall       f1           support   
- (label_id: 0)                                          22.42      11.12      14.86       5614
-! (label_id: 1)                                          0.00       0.00       0.00        108
-, (label_id: 2)                                         38.62       7.46      12.50      19530
-- (label_id: 3)                                          6.60      15.75       9.30       1746
-. (label_id: 4)                                         33.33       0.01       0.01      17976
-: (label_id: 5)                                          0.79      19.15       1.52        376
-; (label_id: 6)                                          0.45       2.94       0.78        170
-? (label_id: 7)                                          0.00       0.00       0.00       1418
-— (label_id: 8)                                          0.00       0.00       0.00       1206
-… (label_id: 9)                                          0.17      50.56       0.33         89
--------------------
-micro avg                                                5.14       5.14       5.14      48233
-macro avg                                               10.24      10.70       3.93      48233
-weighted avg                                            30.92       5.14       7.15      48233
-
-[INFO] - Domain report: 
-label                                                precision    recall       f1           support   
-0 (label_id: 0)                                        100.00     100.00     100.00       2807
--------------------
-micro avg                                              100.00     100.00     100.00       2807
-macro avg                                              100.00     100.00     100.00       2807
-weighted avg                                           100.00     100.00     100.00       2807
-
-[INFO] - Punctuation report: 
-label                                                precision    recall       f1           support   
- (label_id: 0)                                          22.09      11.27      14.93       5634
-! (label_id: 1)                                          0.00       0.00       0.00        113
-, (label_id: 2)                                         35.39       6.74      11.32      19813
-- (label_id: 3)                                          6.03      16.28       8.79       1708
-. (label_id: 4)                                        100.00       0.01       0.02      18084
-: (label_id: 5)                                          0.78      20.69       1.51        348
-; (label_id: 6)                                          0.45       2.55       0.77        196
-? (label_id: 7)                                          0.00       0.00       0.00       1392
-— (label_id: 8)                                          0.00       0.00       0.00       1258
-… (label_id: 9)                                          0.19      58.62       0.38         87
--------------------
-micro avg                                                4.89       4.89       4.89      48633
-macro avg                                               16.49      11.62       3.77      48633
-weighted avg                                            54.38       4.89       6.67      48633
-
-[INFO] - Domain report: 
-label                                                precision    recall       f1           support   
-0 (label_id: 0)                                        100.00     100.00     100.00       2817
--------------------
-micro avg                                              100.00     100.00     100.00       2817
-macro avg                                              100.00     100.00     100.00       2817
-weighted avg                                           100.00     100.00     100.00       2817
-
-[INFO] - Optimizer config = AdamW (
-Parameter Group 0
-    amsgrad: False
-    betas: (0.9, 0.999)
-    eps: 1e-08
-    lr: 0.008413951416451957
-    weight_decay: 0.0
-)
-[INFO] - Scheduler "<core.optim.lr_scheduler.WarmupAnnealing object at 0x7fee4e74d910>" 
-will be used during training (effective maximum steps = 80) - 
-Parameters : 
-(warmup_steps: null
-warmup_ratio: 0.1
-last_epoch: -1
-max_steps: 80
-)
-[INFO] - Punctuation report: 
-label                                                precision    recall       f1           support   
- (label_id: 0)                                          19.61      14.42      16.62        208
-! (label_id: 1)                                          0.00       0.00       0.00         13
-, (label_id: 2)                                         38.84       6.82      11.60        689
-- (label_id: 3)                                          4.50      15.52       6.98         58
-. (label_id: 4)                                          0.00       0.00       0.00        572
-: (label_id: 5)                                          0.59      20.00       1.14         10
-; (label_id: 6)                                          2.56      16.67       4.44          6
-? (label_id: 7)                                          0.00       0.00       0.00         46
-— (label_id: 8)                                          0.00       0.00       0.00         35
-… (label_id: 9)                                          0.25      50.00       0.51          4
--------------------
-micro avg                                                5.55       5.55       5.55       1641
-macro avg                                                6.64      12.34       4.13       1641
-weighted avg                                            18.97       5.55       7.25       1641
-
-[INFO] - Domain report: 
-label                                                precision    recall       f1           support   
-0 (label_id: 0)                                        100.00     100.00     100.00        104
--------------------
-micro avg                                              100.00     100.00     100.00        104
-macro avg                                              100.00     100.00     100.00        104
-weighted avg                                           100.00     100.00     100.00        104
-
-[INFO] - Punctuation report: 
-label                                                precision    recall       f1           support   
- (label_id: 0)                                           0.00       0.00       0.00       5614
-! (label_id: 1)                                          0.00       0.00       0.00        108
-, (label_id: 2)                                          0.00       0.00       0.00      19530
-- (label_id: 3)                                          3.63      98.91       7.00       1746
-. (label_id: 4)                                          0.00       0.00       0.00      17976
-: (label_id: 5)                                          0.00       0.00       0.00        376
-; (label_id: 6)                                          0.00       0.00       0.00        170
-? (label_id: 7)                                          3.96       1.76       2.44       1418
-— (label_id: 8)                                          0.00       0.00       0.00       1206
-… (label_id: 9)                                          0.00       0.00       0.00         89
--------------------
-micro avg                                                3.63       3.63       3.63      48233
-macro avg                                                0.76      10.07       0.94      48233
-weighted avg                                             0.25       3.63       0.33      48233
-
-[INFO] - Domain report: 
-label                                                precision    recall       f1           support   
-0 (label_id: 0)                                        100.00     100.00     100.00       2807
--------------------
-micro avg                                              100.00     100.00     100.00       2807
-macro avg                                              100.00     100.00     100.00       2807
-weighted avg                                           100.00     100.00     100.00       2807
-
-[INFO] - Optimizer config = AdamW (
-Parameter Group 0
-    amsgrad: False
-    betas: (0.9, 0.999)
-    eps: 1e-08
-    lr: 0.00031622776601683794
-    weight_decay: 0.0
-)
-[INFO] - Scheduler "<core.optim.lr_scheduler.WarmupAnnealing object at 0x7fee4e68b8b0>" 
-will be used during training (effective maximum steps = 200) - 
-Parameters : 
-(warmup_steps: null
-warmup_ratio: 0.1
-last_epoch: -1
-max_steps: 200
-)
-[INFO] - Punctuation report: 
-label                                                precision    recall       f1           support   
- (label_id: 0)                                          19.61      14.42      16.62        208
-! (label_id: 1)                                          0.00       0.00       0.00         13
-, (label_id: 2)                                         38.84       6.82      11.60        689
-- (label_id: 3)                                          4.50      15.52       6.98         58
-. (label_id: 4)                                          0.00       0.00       0.00        572
-: (label_id: 5)                                          0.59      20.00       1.14         10
-; (label_id: 6)                                          2.56      16.67       4.44          6
-? (label_id: 7)                                          0.00       0.00       0.00         46
-— (label_id: 8)                                          0.00       0.00       0.00         35
-… (label_id: 9)                                          0.25      50.00       0.51          4
--------------------
-micro avg                                                5.55       5.55       5.55       1641
-macro avg                                                6.64      12.34       4.13       1641
-weighted avg                                            18.97       5.55       7.25       1641
-
-[INFO] - Domain report: 
-label                                                precision    recall       f1           support   
-0 (label_id: 0)                                        100.00     100.00     100.00        104
--------------------
-micro avg                                              100.00     100.00     100.00        104
-macro avg                                              100.00     100.00     100.00        104
-weighted avg                                           100.00     100.00     100.00        104
-
-[INFO] - Punctuation report: 
-label                                                precision    recall       f1           support   
- (label_id: 0)                                           0.00       0.00       0.00       5614
-! (label_id: 1)                                          0.00       0.00       0.00        108
-, (label_id: 2)                                          0.00       0.00       0.00      19530
-- (label_id: 3)                                          3.62     100.00       6.99       1746
-. (label_id: 4)                                          0.00       0.00       0.00      17976
-: (label_id: 5)                                          0.00       0.00       0.00        376
-; (label_id: 6)                                          0.00       0.00       0.00        170
-? (label_id: 7)                                          0.00       0.00       0.00       1418
-— (label_id: 8)                                          0.00       0.00       0.00       1206
-… (label_id: 9)                                          0.00       0.00       0.00         89
--------------------
-micro avg                                                3.62       3.62       3.62      48233
-macro avg                                                0.36      10.00       0.70      48233
-weighted avg                                             0.13       3.62       0.25      48233
-
-[INFO] - Domain report: 
-label                                                precision    recall       f1           support   
-0 (label_id: 0)                                        100.00     100.00     100.00       2807
--------------------
-micro avg                                              100.00     100.00     100.00       2807
-macro avg                                              100.00     100.00     100.00       2807
-weighted avg                                           100.00     100.00     100.00       2807
-
-[INFO] - Punctuation report: 
-label                                                precision    recall       f1           support   
- (label_id: 0)                                           0.00       0.00       0.00       5634
-! (label_id: 1)                                          0.00       0.00       0.00        113
-, (label_id: 2)                                          0.00       0.00       0.00      19813
-- (label_id: 3)                                          3.51     100.00       6.79       1708
-. (label_id: 4)                                          0.00       0.00       0.00      18084
-: (label_id: 5)                                          0.00       0.00       0.00        348
-; (label_id: 6)                                          0.00       0.00       0.00        196
-? (label_id: 7)                                          0.00       0.00       0.00       1392
-— (label_id: 8)                                          0.00       0.00       0.00       1258
-… (label_id: 9)                                          0.00       0.00       0.00         87
--------------------
-micro avg                                                3.51       3.51       3.51      48633
-macro avg                                                0.35      10.00       0.68      48633
-weighted avg                                             0.12       3.51       0.24      48633
-
-[INFO] - Domain report: 
-label                                                precision    recall       f1           support   
-0 (label_id: 0)                                        100.00     100.00     100.00       2817
--------------------
-micro avg                                              100.00     100.00     100.00       2817
-macro avg                                              100.00     100.00     100.00       2817
-weighted avg                                           100.00     100.00     100.00       2817
-
-[INFO] - Optimizer config = AdamW (
-Parameter Group 0
-    amsgrad: False
-    betas: (0.9, 0.999)
-    eps: 1e-08
-    lr: 0.00031622776601683794
-    weight_decay: 0.0
-)
-[INFO] - Scheduler "<core.optim.lr_scheduler.WarmupAnnealing object at 0x7fee4e75eaf0>" 
-will be used during training (effective maximum steps = 80) - 
-Parameters : 
-(warmup_steps: null
-warmup_ratio: 0.1
-last_epoch: -1
-max_steps: 80
-)
-[INFO] - Punctuation report: 
-label                                                precision    recall       f1           support   
- (label_id: 0)                                           0.00       0.00       0.00        208
-! (label_id: 1)                                          0.00       0.00       0.00         13
-, (label_id: 2)                                          0.00       0.00       0.00        689
-- (label_id: 3)                                          3.53     100.00       6.83         58
-. (label_id: 4)                                          0.00       0.00       0.00        572
-: (label_id: 5)                                          0.00       0.00       0.00         10
-; (label_id: 6)                                          0.00       0.00       0.00          6
-? (label_id: 7)                                          0.00       0.00       0.00         46
-— (label_id: 8)                                          0.00       0.00       0.00         35
-… (label_id: 9)                                          0.00       0.00       0.00          4
--------------------
-micro avg                                                3.53       3.53       3.53       1641
-macro avg                                                0.35      10.00       0.68       1641
-weighted avg                                             0.12       3.53       0.24       1641
-
-[INFO] - Domain report: 
-label                                                precision    recall       f1           support   
-0 (label_id: 0)                                        100.00     100.00     100.00        104
--------------------
-micro avg                                              100.00     100.00     100.00        104
-macro avg                                              100.00     100.00     100.00        104
-weighted avg                                           100.00     100.00     100.00        104
-
-[INFO] - Punctuation report: 
-label                                                precision    recall       f1           support   
- (label_id: 0)                                           0.00       0.00       0.00       5614
-! (label_id: 1)                                          0.00       0.00       0.00        108
-, (label_id: 2)                                          0.00       0.00       0.00      19530
-- (label_id: 3)                                          3.62     100.00       6.99       1746
-. (label_id: 4)                                          0.00       0.00       0.00      17976
-: (label_id: 5)                                          0.00       0.00       0.00        376
-; (label_id: 6)                                          0.00       0.00       0.00        170
-? (label_id: 7)                                          0.00       0.00       0.00       1418
-— (label_id: 8)                                          0.00       0.00       0.00       1206
-… (label_id: 9)                                          0.00       0.00       0.00         89
--------------------
-micro avg                                                3.62       3.62       3.62      48233
-macro avg                                                0.36      10.00       0.70      48233
-weighted avg                                             0.13       3.62       0.25      48233
-
-[INFO] - Domain report: 
-label                                                precision    recall       f1           support   
-0 (label_id: 0)                                        100.00     100.00     100.00       2807
--------------------
-micro avg                                              100.00     100.00     100.00       2807
-macro avg                                              100.00     100.00     100.00       2807
-weighted avg                                           100.00     100.00     100.00       2807
-
-[INFO] - Optimizer config = AdamW (
-Parameter Group 0
-    amsgrad: False
-    betas: (0.9, 0.999)
-    eps: 1e-08
-    lr: 0.00031622776601683794
-    weight_decay: 0.0
-)
-[INFO] - Scheduler "<core.optim.lr_scheduler.WarmupAnnealing object at 0x7fee4e75e160>" 
-will be used during training (effective maximum steps = 200) - 
-Parameters : 
-(warmup_steps: null
-warmup_ratio: 0.1
-last_epoch: -1
-max_steps: 200
-)
-[INFO] - Punctuation report: 
-label                                                precision    recall       f1           support   
- (label_id: 0)                                           0.00       0.00       0.00        208
-! (label_id: 1)                                          0.00       0.00       0.00         13
-, (label_id: 2)                                          0.00       0.00       0.00        689
-- (label_id: 3)                                          3.53     100.00       6.83         58
-. (label_id: 4)                                          0.00       0.00       0.00        572
-: (label_id: 5)                                          0.00       0.00       0.00         10
-; (label_id: 6)                                          0.00       0.00       0.00          6
-? (label_id: 7)                                          0.00       0.00       0.00         46
-— (label_id: 8)                                          0.00       0.00       0.00         35
-… (label_id: 9)                                          0.00       0.00       0.00          4
--------------------
-micro avg                                                3.53       3.53       3.53       1641
-macro avg                                                0.35      10.00       0.68       1641
-weighted avg                                             0.12       3.53       0.24       1641
-
-[INFO] - Domain report: 
-label                                                precision    recall       f1           support   
-0 (label_id: 0)                                        100.00     100.00     100.00        104
--------------------
-micro avg                                              100.00     100.00     100.00        104
-macro avg                                              100.00     100.00     100.00        104
-weighted avg                                           100.00     100.00     100.00        104
-
-[INFO] - Punctuation report: 
-label                                                precision    recall       f1           support   
- (label_id: 0)                                           0.00       0.00       0.00       5614
-! (label_id: 1)                                          0.00       0.00       0.00        108
-, (label_id: 2)                                          0.00       0.00       0.00      19530
-- (label_id: 3)                                          3.62     100.00       6.99       1746
-. (label_id: 4)                                          0.00       0.00       0.00      17976
-: (label_id: 5)                                          0.00       0.00       0.00        376
-; (label_id: 6)                                          0.00       0.00       0.00        170
-? (label_id: 7)                                          0.00       0.00       0.00       1418
-— (label_id: 8)                                          0.00       0.00       0.00       1206
-… (label_id: 9)                                          0.00       0.00       0.00         89
--------------------
-micro avg                                                3.62       3.62       3.62      48233
-macro avg                                                0.36      10.00       0.70      48233
-weighted avg                                             0.13       3.62       0.25      48233
-
-[INFO] - Domain report: 
-label                                                precision    recall       f1           support   
-0 (label_id: 0)                                        100.00     100.00     100.00       2807
--------------------
-micro avg                                              100.00     100.00     100.00       2807
-macro avg                                              100.00     100.00     100.00       2807
-weighted avg                                           100.00     100.00     100.00       2807
-
-[INFO] - Punctuation report: 
-label                                                precision    recall       f1           support   
- (label_id: 0)                                           0.00       0.00       0.00       5634
-! (label_id: 1)                                          0.00       0.00       0.00        113
-, (label_id: 2)                                          0.00       0.00       0.00      19813
-- (label_id: 3)                                          3.51     100.00       6.79       1708
-. (label_id: 4)                                          0.00       0.00       0.00      18084
-: (label_id: 5)                                          0.00       0.00       0.00        348
-; (label_id: 6)                                          0.00       0.00       0.00        196
-? (label_id: 7)                                          0.00       0.00       0.00       1392
-— (label_id: 8)                                          0.00       0.00       0.00       1258
-… (label_id: 9)                                          0.00       0.00       0.00         87
--------------------
-micro avg                                                3.51       3.51       3.51      48633
-macro avg                                                0.35      10.00       0.68      48633
-weighted avg                                             0.12       3.51       0.24      48633
-
-[INFO] - Domain report: 
-label                                                precision    recall       f1           support   
-0 (label_id: 0)                                        100.00     100.00     100.00       2817
--------------------
-micro avg                                              100.00     100.00     100.00       2817
-macro avg                                              100.00     100.00     100.00       2817
-weighted avg                                           100.00     100.00     100.00       2817
-
-[INFO] - Punctuation report: 
-label                                                precision    recall       f1           support   
- (label_id: 0)                                           0.00       0.00       0.00       7470
-! (label_id: 1)                                          0.00       0.00       0.00        148
-, (label_id: 2)                                          0.00       0.00       0.00      28513
-- (label_id: 3)                                          3.02     100.00       5.86       2074
-. (label_id: 4)                                          0.00       0.00       0.00      25120
-: (label_id: 5)                                          0.00       0.00       0.00        570
-; (label_id: 6)                                          0.00       0.00       0.00        534
-? (label_id: 7)                                          0.00       0.00       0.00       2085
-— (label_id: 8)                                          0.00       0.00       0.00       2073
-… (label_id: 9)                                          0.00       0.00       0.00        142
--------------------
-micro avg                                                3.02       3.02       3.02      68729
-macro avg                                                0.30      10.00       0.59      68729
-weighted avg                                             0.09       3.02       0.18      68729
-
-[INFO] - Domain report: 
-label                                                precision    recall       f1           support   
-0 (label_id: 0)                                        100.00     100.00     100.00       3735
--------------------
-micro avg                                              100.00     100.00     100.00       3735
-macro avg                                              100.00     100.00     100.00       3735
-weighted avg                                           100.00     100.00     100.00       3735
-
-[INFO] - Internal process exited
+[INFO] - GPU available: True, used: False
+[INFO] - TPU available: None, using: 0 TPU cores
diff --git a/experiment/models/punctuation_domain_model.py b/experiment/models/punctuation_domain_model.py
index 782fbfa..464595d 100644
--- a/experiment/models/punctuation_domain_model.py
+++ b/experiment/models/punctuation_domain_model.py
@@ -374,6 +374,11 @@ class PunctuationDomainModel(pl.LightningModule, Serialization, FileIO):
         else:
             scheduler_config = None
 
+        if 'delay_epochs' in optim_config:
+            delay_epochs = optim_config.pop('delay_epochs')
+        else:
+            delay_epochs = 0
+
         # Check if caller provided optimizer name, default to Adam otherwise
         optimizer_cls = optim_config.get('_target_', None)
 
@@ -455,7 +460,7 @@ class PunctuationDomainModel(pl.LightningModule, Serialization, FileIO):
 
         # Try to instantiate scheduler for optimizer
         self._scheduler = prepare_lr_scheduler(
-            optimizer=self._optimizer, scheduler_config=scheduler_config,
+            optimizer=self._optimizer, delay_epochs=delay_epochs,scheduler_config=scheduler_config,
             train_dataloader=pp({'num_samples' : self.train_size*self.hparams.model.dataset.train_ds.batch_size, 
             'batch_size': self.hparams.model.dataset.train_ds.batch_size,
             'drop_last' : self.hparams.model.dataset.drop_last})
