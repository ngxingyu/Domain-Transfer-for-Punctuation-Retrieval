commit hash: 34fa2ef84aba8a61f74a2c1ebf23108afe96f0d2
diff --git a/Punctuation_with_Domain_discriminator/2021-03-01_15-40-46/events.out.tfevents.1614584460.intern-instance.9281.0 b/Punctuation_with_Domain_discriminator/2021-03-01_15-40-46/events.out.tfevents.1614584460.intern-instance.9281.0
index de6fa73..3c535ba 100644
Binary files a/Punctuation_with_Domain_discriminator/2021-03-01_15-40-46/events.out.tfevents.1614584460.intern-instance.9281.0 and b/Punctuation_with_Domain_discriminator/2021-03-01_15-40-46/events.out.tfevents.1614584460.intern-instance.9281.0 differ
diff --git a/Punctuation_with_Domain_discriminator/2021-03-01_15-40-46/lightning_logs.txt b/Punctuation_with_Domain_discriminator/2021-03-01_15-40-46/lightning_logs.txt
index b7e2109..829a9c6 100644
--- a/Punctuation_with_Domain_discriminator/2021-03-01_15-40-46/lightning_logs.txt
+++ b/Punctuation_with_Domain_discriminator/2021-03-01_15-40-46/lightning_logs.txt
@@ -23,3 +23,4 @@ initializing ddp: GLOBAL_RANK: 0, MEMBER: 1/1
 108 M     Total params
 Epoch 0, global step 49: val_loss reached 90.77777 (best 90.77777), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-01_15-40-46/checkpoints/Punctuation_with_Domain_discriminator---val_loss=90.78-epoch=0.ckpt" as top 3
 Epoch 1, global step 99: val_loss reached 58.67143 (best 58.67143), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-01_15-40-46/checkpoints/Punctuation_with_Domain_discriminator---val_loss=58.67-epoch=1.ckpt" as top 3
+Epoch 2, global step 149: val_loss reached 53.53348 (best 53.53348), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-01_15-40-46/checkpoints/Punctuation_with_Domain_discriminator---val_loss=53.53-epoch=2.ckpt" as top 3
diff --git a/experiment/config.yaml b/experiment/config.yaml
index 2209c72..1d2482d 100644
--- a/experiment/config.yaml
+++ b/experiment/config.yaml
@@ -72,7 +72,7 @@ model:
         
     no_space_label: '#'
     test_chunk_percent: 0.5
-    punct_class_weights: 0.5 #0 if don't weight
+    punct_class_weights: 0.8 #0 if don't weight
     
     dataset:
         data_dir: /home/${env:USER}/data # /root/data # 
@@ -128,12 +128,12 @@ model:
         # unfrozen_layers: 1
     
     punct_head:
-        punct_num_fc_layers: 0
+        punct_num_fc_layers: 3
         fc_dropout: 0.1
         activation: 'gelu'
         log_softmax: false
         use_transformer_init: true
-        loss: 'crf'
+        loss: 'dice'
         bilstm: false
 
     domain_head:
diff --git a/experiment/info.log b/experiment/info.log
index e3c9909..e2b8960 100644
--- a/experiment/info.log
+++ b/experiment/info.log
@@ -1,157 +1,5 @@
 [INFO] - Global seed set to 42
 [INFO] - GPU available: True, used: True
 [INFO] - TPU available: None, using: 0 TPU cores
-[INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
+[INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [1]
 [INFO] - Using native 16bit precision.
-[INFO] - shuffling train set
-[INFO] - Global seed set to 42
-[INFO] - initializing ddp: GLOBAL_RANK: 0, MEMBER: 1/1
-[INFO] - Optimizer config = AdamW (
-Parameter Group 0
-    amsgrad: False
-    betas: (0.9, 0.999)
-    eps: 1e-08
-    lr: 0.01
-    weight_decay: 0.0
-)
-[INFO] - Scheduler "<core.optim.lr_scheduler.CosineAnnealing object at 0x7f9d387b2a30>" 
-will be used during training (effective maximum steps = 400) - 
-Parameters : 
-(warmup_steps: null
-warmup_ratio: 0.1
-min_lr: 1.0e-08
-last_epoch: -1
-max_steps: 400
-)
-[INFO] - 
-  | Name                       | Type                 | Params
---------------------------------------------------------------------
-0 | transformer                | ElectraModel         | 108 M 
-1 | punct_classifier           | TokenClassifier      | 4.6 K 
-2 | domain_classifier          | SequenceClassifier   | 1.5 K 
-3 | punctuation_loss           | LinearChainCRF       | 48    
-4 | domain_loss                | CrossEntropyLoss     | 0     
-5 | agg_loss                   | AggregatorLoss       | 0     
-6 | punct_class_report         | ClassificationReport | 0     
-7 | chunked_punct_class_report | ClassificationReport | 0     
-8 | domain_class_report        | ClassificationReport | 0     
---------------------------------------------------------------------
-6.2 K     Trainable params
-108 M     Non-trainable params
-108 M     Total params
-[INFO] - Punctuation report: 
-label                                                precision    recall       f1           support   
- (label_id: 0)                                          83.61      15.68      26.41      35602
-! (label_id: 1)                                          0.00       0.00       0.00         18
-# (label_id: 2)                                          3.22      56.02       6.09       1494
-, (label_id: 3)                                          1.14       0.50       0.69       1212
-. (label_id: 4)                                          3.72       7.67       5.01        991
-? (label_id: 5)                                          0.00       0.00       0.00         84
--------------------
-micro avg                                               16.50      16.50      16.50      39401
-macro avg                                               15.28      13.31       6.37      39401
-weighted avg                                            75.79      16.50      24.25      39401
-
--------------------
-                       !           #           ,           .           ?
-     5584.00         6.00       215.00       424.00       411.00        39.00
-     1982.00         0.00        22.00        50.00        25.00         1.00
-    24058.00        10.00       837.00       591.00       455.00        33.00
-      415.00         0.00       103.00         6.00         2.00         0.00
-     1696.00         2.00       162.00        96.00        76.00        11.00
-     1867.00         0.00       155.00        45.00        22.00         0.00
--------------------
-
-[INFO] - Domain report: 
-label                                                precision    recall       f1           support   
-0 (label_id: 0)                                         50.00      99.40      66.53        168
-1 (label_id: 1)                                         50.00       0.60       1.18        168
--------------------
-micro avg                                               50.00      50.00      50.00        336
-macro avg                                               50.00      50.00      33.86        336
-weighted avg                                            50.00      50.00      33.86        336
-
--------------------
-           0           1
-      167.00       167.00
-        1.00         1.00
--------------------
-
-[INFO] - Punctuation report: 
-label                                                precision    recall       f1           support   
- (label_id: 0)                                          89.69     100.00      94.57     429657
-! (label_id: 1)                                          0.00       0.00       0.00         83
-# (label_id: 2)                                          0.00       0.00       0.00      19814
-, (label_id: 3)                                          0.00       0.00       0.00      15326
-. (label_id: 4)                                          0.00       0.00       0.00      13230
-? (label_id: 5)                                          0.00       0.00       0.00        924
--------------------
-micro avg                                               89.69      89.69      89.69     479034
-macro avg                                               14.95      16.67      15.76     479034
-weighted avg                                            80.45      89.69      84.82     479034
-
--------------------
-                       !           #           ,           .           ?
-   429657.00        83.00     19814.00     15326.00     13230.00       924.00
-        0.00         0.00         0.00         0.00         0.00         0.00
-        0.00         0.00         0.00         0.00         0.00         0.00
-        0.00         0.00         0.00         0.00         0.00         0.00
-        0.00         0.00         0.00         0.00         0.00         0.00
-        0.00         0.00         0.00         0.00         0.00         0.00
--------------------
-
-[INFO] - Domain report: 
-label                                                precision    recall       f1           support   
-0 (label_id: 0)                                          0.00       0.00       0.00       2043
-1 (label_id: 1)                                         50.00     100.00      66.67       2043
--------------------
-micro avg                                               50.00      50.00      50.00       4086
-macro avg                                               25.00      50.00      33.33       4086
-weighted avg                                            25.00      50.00      33.33       4086
-
--------------------
-           0           1
-        0.00         0.00
-     2043.00      2043.00
--------------------
-
-[INFO] - Epoch 0, global step 49: val_loss reached 90.77777 (best 90.77777), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-01_15-40-46/checkpoints/Punctuation_with_Domain_discriminator---val_loss=90.78-epoch=0.ckpt" as top 3
-[INFO] - Punctuation report: 
-label                                                precision    recall       f1           support   
- (label_id: 0)                                          89.65     100.00      94.54     430027
-! (label_id: 1)                                          0.00       0.00       0.00         83
-# (label_id: 2)                                          0.00       0.00       0.00      19975
-, (label_id: 3)                                          0.00       0.00       0.00      15320
-. (label_id: 4)                                          0.00       0.00       0.00      13307
-? (label_id: 5)                                          0.00       0.00       0.00        966
--------------------
-micro avg                                               89.65      89.65      89.65     479678
-macro avg                                               14.94      16.67      15.76     479678
-weighted avg                                            80.37      89.65      84.76     479678
-
--------------------
-                       !           #           ,           .           ?
-   430027.00        83.00     19975.00     15320.00     13307.00       966.00
-        0.00         0.00         0.00         0.00         0.00         0.00
-        0.00         0.00         0.00         0.00         0.00         0.00
-        0.00         0.00         0.00         0.00         0.00         0.00
-        0.00         0.00         0.00         0.00         0.00         0.00
-        0.00         0.00         0.00         0.00         0.00         0.00
--------------------
-
-[INFO] - Domain report: 
-label                                                precision    recall       f1           support   
-0 (label_id: 0)                                          0.00       0.00       0.00       2043
-1 (label_id: 1)                                         50.00     100.00      66.67       2043
--------------------
-micro avg                                               50.00      50.00      50.00       4086
-macro avg                                               25.00      50.00      33.33       4086
-weighted avg                                            25.00      50.00      33.33       4086
-
--------------------
-           0           1
-        0.00         0.00
-     2043.00      2043.00
--------------------
-
-[INFO] - Epoch 1, global step 99: val_loss reached 58.67143 (best 58.67143), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-03-01_15-40-46/checkpoints/Punctuation_with_Domain_discriminator---val_loss=58.67-epoch=1.ckpt" as top 3
