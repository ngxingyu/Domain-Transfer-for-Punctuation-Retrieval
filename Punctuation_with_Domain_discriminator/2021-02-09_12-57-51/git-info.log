commit hash: 4cccf1ef224a31f16ab4158a6dbd1472d2705371
diff --git a/Punctuation_with_Domain_discriminator/2021-02-09_11-10-37/events.out.tfevents.1612840713.Titan.20119.0 b/Punctuation_with_Domain_discriminator/2021-02-09_11-10-37/events.out.tfevents.1612840713.Titan.20119.0
index a4eb1d2..b90a1e5 100644
Binary files a/Punctuation_with_Domain_discriminator/2021-02-09_11-10-37/events.out.tfevents.1612840713.Titan.20119.0 and b/Punctuation_with_Domain_discriminator/2021-02-09_11-10-37/events.out.tfevents.1612840713.Titan.20119.0 differ
diff --git a/Punctuation_with_Domain_discriminator/2021-02-09_11-10-37/lightning_logs.txt b/Punctuation_with_Domain_discriminator/2021-02-09_11-10-37/lightning_logs.txt
index c7d0c2d..f654115 100644
--- a/Punctuation_with_Domain_discriminator/2021-02-09_11-10-37/lightning_logs.txt
+++ b/Punctuation_with_Domain_discriminator/2021-02-09_11-10-37/lightning_logs.txt
@@ -37,3 +37,19 @@ Global seed set to 42
 299 K     Trainable params
 13.2 M    Non-trainable params
 13.5 M    Total params
+Global seed set to 42
+
+  | Name                | Type                 | Params
+-------------------------------------------------------------
+0 | transformer         | ElectraModel         | 13.5 M
+1 | punct_classifier    | TokenClassifier      | 2.6 K 
+2 | domain_classifier   | SequenceClassifier   | 1.0 K 
+3 | punctuation_loss    | FocalDiceLoss        | 0     
+4 | domain_loss         | CrossEntropyLoss     | 0     
+5 | agg_loss            | AggregatorLoss       | 0     
+6 | punct_class_report  | ClassificationReport | 0     
+7 | domain_class_report | ClassificationReport | 0     
+-------------------------------------------------------------
+826 K     Trainable params
+12.7 M    Non-trainable params
+13.5 M    Total params
diff --git a/Punctuation_with_Domain_discriminator/2021-02-09_11-10-37/nemo_error_log.txt b/Punctuation_with_Domain_discriminator/2021-02-09_11-10-37/nemo_error_log.txt
index 0c8b389..f0409dd 100644
--- a/Punctuation_with_Domain_discriminator/2021-02-09_11-10-37/nemo_error_log.txt
+++ b/Punctuation_with_Domain_discriminator/2021-02-09_11-10-37/nemo_error_log.txt
@@ -8,3 +8,6 @@
 [NeMo W 2021-02-09 11:24:13 nemo_logging:349] /home/nxingyu/miniconda3/envs/NLP/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:131: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
       warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
     
+[NeMo W 2021-02-09 12:57:04 nemo_logging:349] /home/nxingyu/miniconda3/envs/NLP/lib/python3.8/site-packages/pytorch_lightning/utilities/distributed.py:50: UserWarning: Detected KeyboardInterrupt, attempting graceful shutdown...
+      warnings.warn(*args, **kwargs)
+    
diff --git a/Punctuation_with_Domain_discriminator/2021-02-09_11-10-37/nemo_log_globalrank-0_localrank-0.txt b/Punctuation_with_Domain_discriminator/2021-02-09_11-10-37/nemo_log_globalrank-0_localrank-0.txt
index 84d61e5..4c66514 100644
--- a/Punctuation_with_Domain_discriminator/2021-02-09_11-10-37/nemo_log_globalrank-0_localrank-0.txt
+++ b/Punctuation_with_Domain_discriminator/2021-02-09_11-10-37/nemo_log_globalrank-0_localrank-0.txt
@@ -10,3 +10,6 @@
 [NeMo W 2021-02-09 11:24:13 nemo_logging:349] /home/nxingyu/miniconda3/envs/NLP/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:131: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
       warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
     
+[NeMo W 2021-02-09 12:57:04 nemo_logging:349] /home/nxingyu/miniconda3/envs/NLP/lib/python3.8/site-packages/pytorch_lightning/utilities/distributed.py:50: UserWarning: Detected KeyboardInterrupt, attempting graceful shutdown...
+      warnings.warn(*args, **kwargs)
+    
diff --git a/experiment/Untitled.ipynb b/experiment/Untitled.ipynb
index 1a5526d..cd5247e 100644
--- a/experiment/Untitled.ipynb
+++ b/experiment/Untitled.ipynb
@@ -3,33 +3,33 @@
   {
    "cell_type": "code",
    "execution_count": 1,
-   "id": "dense-meaning",
+   "id": "modern-amplifier",
    "metadata": {},
    "outputs": [
     {
      "name": "stderr",
      "output_type": "stream",
      "text": [
-      "12:16:24.02 LOG:\n"
+      "12:17:39.23 LOG:\n"
      ]
     },
     {
      "name": "stdout",
      "output_type": "stream",
      "text": [
-      "shuffling <data.punctuation_dataset_multi.PunctuationDomainDataset object at 0x7f86e5bc2220>\n"
+      "shuffling <data.punctuation_dataset_multi.PunctuationDomainDataset object at 0x7f383a13c0a0>\n"
      ]
     },
     {
      "name": "stderr",
      "output_type": "stream",
      "text": [
-      "12:16:24.11 .... os.system('bash data/shuffle.sh -i {} -o {} -a {} -s {} -m {} -t {}'.format(self.target_file, self.target_file, ['true','false'][randomize], seed, '100M',self.tmp_path)) = 0\n",
-      "12:16:24.17 LOG:\n",
-      "12:16:24.48 .... f\"1st {n} encoder layers of transformer frozen\" = '1st 11 encoder layers of transformer frozen'\n",
+      "12:17:39.32 .... os.system('bash data/shuffle.sh -i {} -o {} -a {} -s {} -m {} -t {}'.format(self.target_file, self.target_file, ['true','false'][randomize], seed, '100M',self.tmp_path)) = 0\n",
+      "12:17:39.38 LOG:\n",
+      "12:17:39.75 .... f\"1st {n} encoder layers of transformer frozen\" = '1st 11 encoder layers of transformer frozen'\n",
       "GPU available: True, used: False\n",
       "TPU available: None, using: 0 TPU cores\n",
-      "[NeMo W 2021-02-09 12:16:24 nemo_logging:349] /home/nxingyu/miniconda3/envs/NLP/lib/python3.8/site-packages/pytorch_lightning/utilities/distributed.py:50: UserWarning: GPU available but not used. Set the --gpus flag when calling the script.\n",
+      "[NeMo W 2021-02-09 12:17:39 nemo_logging:349] /home/nxingyu/miniconda3/envs/NLP/lib/python3.8/site-packages/pytorch_lightning/utilities/distributed.py:50: UserWarning: GPU available but not used. Set the --gpus flag when calling the script.\n",
       "      warnings.warn(*args, **kwargs)\n",
       "    \n"
      ]
@@ -74,157 +74,26 @@
   },
   {
    "cell_type": "code",
+   "execution_count": null,
+   "id": "minus-mississippi",
+   "metadata": {},
+   "outputs": [],
+   "source": [
+    "import regex as re\n",
+    "re.sub('(\"[CLS]\"|)','','[CLS] we, bought: four- shirts, one, pen, and, a, mug, from, the, nvidia- gear, store, in, santa- clara, [SEP] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD]')"
+   ]
+  },
+  {
+   "cell_type": "code",
    "execution_count": 2,
-   "id": "potential-adrian",
+   "id": "hairy-proxy",
    "metadata": {},
    "outputs": [
     {
-     "name": "stderr",
-     "output_type": "stream",
-     "text": [
-      "12:16:24.62 LOG:\n",
-      "12:16:24.69 .... chunk_to_len_batch(max_seq_length, tokenizer,chunked['texts'],chunked['tags'],True) = {'attention_mask': tensor([[ True,  True,  True,  True,  True,  True,  True,  True,  True,  True,\n",
-      "12:16:24.69                                                                                                      True,  True,  True,  True,  True,  True,  True,  True,  True,  True,\n",
-      "12:16:24.69                                                                                                      True, False, False, False, False, False, False, False, False, False,\n",
-      "12:16:24.69                                                                                                     False, False, False, False, False, False, False, False, False, False,\n",
-      "12:16:24.69                                                                                                     False, False, False, False, False, False, False, False, False, False,\n",
-      "12:16:24.69                                                                                                     False, False, False, False, False, False, False, False, False, False,\n",
-      "12:16:24.69                                                                                                     False, False, False, False, False, False, False, False, False, False,\n",
-      "12:16:24.69                                                                                                     False, False, False, False, False, False, False, False, False, False,\n",
-      "12:16:24.69                                                                                                     False, False, False, False, False, False, False, False, False, False,\n",
-      "12:16:24.69                                                                                                     False, False, False, False, False, False, False, False, False, False,\n",
-      "12:16:24.69                                                                                                     False, False, False, False, False, False, False, False, False, False,\n",
-      "12:16:24.69                                                                                                     False, False, False, False, False, False, False, False, False, False,\n",
-      "12:16:24.69                                                                                                     False, False, False, False, False, False, False, False],\n",
-      "12:16:24.69                                                                                                    [ True,  True,  True,  True,  True,  True,  True,  True,  True, False,\n",
-      "12:16:24.69                                                                                                     False, False, False, False, False, False, False, False, False, False,\n",
-      "12:16:24.69                                                                                                     False, False, False, False, False, False, False, False, False, False,\n",
-      "12:16:24.69                                                                                                     False, False, False, False, False, False, False, False, False, False,\n",
-      "12:16:24.69                                                                                                     False, False, False, False, False, False, False, False, False, False,\n",
-      "12:16:24.69                                                                                                     False, False, False, False, False, False, False, False, False, False,\n",
-      "12:16:24.69                                                                                                     False, False, False, False, False, False, False, False, False, False,\n",
-      "12:16:24.69                                                                                                     False, False, False, False, False, False, False, False, False, False,\n",
-      "12:16:24.69                                                                                                     False, False, False, False, False, False, False, False, False, False,\n",
-      "12:16:24.69                                                                                                     False, False, False, False, False, False, False, False, False, False,\n",
-      "12:16:24.69                                                                                                     False, False, False, False, False, False, False, False, False, False,\n",
-      "12:16:24.69                                                                                                     False, False, False, False, False, False, False, False, False, False,\n",
-      "12:16:24.69                                                                                                     False, False, False, False, False, False, False, False],\n",
-      "12:16:24.69                                                                                                    [ True,  True,  True,  True,  True, False, False, False, False, False,\n",
-      "12:16:24.69                                                                                                     False, False, False, False, False, False, False, False, False, False,\n",
-      "12:16:24.69                                                                                                     False, False, False, False, False, False, False, False, False, False,\n",
-      "12:16:24.69                                                                                                     False, False, False, False, False, False, False, False, False, False,\n",
-      "12:16:24.69                                                                                                     False, False, False, False, False, False, False, False, False, False,\n",
-      "12:16:24.69                                                                                                     False, False, False, False, False, False, False, False, False, False,\n",
-      "12:16:24.69                                                                                                     False, False, False, False, False, False, False, False, False, False,\n",
-      "12:16:24.69                                                                                                     False, False, False, False, False, False, False, False, False, False,\n",
-      "12:16:24.69                                                                                                     False, False, False, False, False, False, False, False, False, False,\n",
-      "12:16:24.69                                                                                                     False, False, False, False, False, False, False, False, False, False,\n",
-      "12:16:24.69                                                                                                     False, False, False, False, False, False, False, False, False, False,\n",
-      "12:16:24.69                                                                                                     False, False, False, False, False, False, False, False, False, False,\n",
-      "12:16:24.69                                                                                                     False, False, False, False, False, False, False, False]]),\n",
-      "12:16:24.69                                                                                             'input_ids': tensor([[  101,  2057,  4149,  2176, 11344,  2028,  7279,  1998,  1037, 14757,\n",
-      "12:16:24.69                                                                                                      2013,  1996,  1050, 17258,  2401,  6718,  3573,  1999,  4203, 10254,\n",
-      "12:16:24.69                                                                                                       102,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n",
-      "12:16:24.69                                                                                                         0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n",
-      "12:16:24.69                                                                                                         0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n",
-      "12:16:24.69                                                                                                         0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n",
-      "12:16:24.69                                                                                                         0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n",
-      "12:16:24.69                                                                                                         0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n",
-      "12:16:24.69                                                                                                         0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n",
-      "12:16:24.69                                                                                                         0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n",
-      "12:16:24.69                                                                                                         0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n",
-      "12:16:24.69                                                                                                         0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n",
-      "12:16:24.69                                                                                                         0,     0,     0,     0,     0,     0,     0,     0],\n",
-      "12:16:24.69                                                                                                    [  101,  2054,  2064,  1045,  2079,  2005,  2017,  2651,   102,     0,\n",
-      "12:16:24.69                                                                                                         0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n",
-      "12:16:24.69                                                                                                         0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n",
-      "12:16:24.69                                                                                                         0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n",
-      "12:16:24.69                                                                                                         0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n",
-      "12:16:24.69                                                                                                         0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n",
-      "12:16:24.69                                                                                                         0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n",
-      "12:16:24.69                                                                                                         0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n",
-      "12:16:24.69                                                                                                         0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n",
-      "12:16:24.69                                                                                                         0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n",
-      "12:16:24.69                                                                                                         0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n",
-      "12:16:24.69                                                                                                         0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n",
-      "12:16:24.69                                                                                                         0,     0,     0,     0,     0,     0,     0,     0],\n",
-      "12:16:24.69                                                                                                    [  101,  2129,  2024,  2017,   102,     0,     0,     0,     0,     0,\n",
-      "12:16:24.69                                                                                                         0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n",
-      "12:16:24.69                                                                                                         0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n",
-      "12:16:24.69                                                                                                         0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n",
-      "12:16:24.69                                                                                                         0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n",
-      "12:16:24.69                                                                                                         0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n",
-      "12:16:24.69                                                                                                         0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n",
-      "12:16:24.69                                                                                                         0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n",
-      "12:16:24.69                                                                                                         0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n",
-      "12:16:24.69                                                                                                         0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n",
-      "12:16:24.69                                                                                                         0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n",
-      "12:16:24.69                                                                                                         0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n",
-      "12:16:24.69                                                                                                         0,     0,     0,     0,     0,     0,     0,     0]]),\n",
-      "12:16:24.69                                                                                             'labels': tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n",
-      "12:16:24.69                                                                                                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n",
-      "12:16:24.69                                                                                                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n",
-      "12:16:24.69                                                                                                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n",
-      "12:16:24.69                                                                                                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n",
-      "12:16:24.69                                                                                                     0, 0, 0, 0, 0, 0, 0, 0],\n",
-      "12:16:24.69                                                                                                    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n",
-      "12:16:24.69                                                                                                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n",
-      "12:16:24.69                                                                                                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n",
-      "12:16:24.69                                                                                                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n",
-      "12:16:24.69                                                                                                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n",
-      "12:16:24.69                                                                                                     0, 0, 0, 0, 0, 0, 0, 0],\n",
-      "12:16:24.69                                                                                                    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n",
-      "12:16:24.69                                                                                                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n",
-      "12:16:24.69                                                                                                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n",
-      "12:16:24.69                                                                                                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n",
-      "12:16:24.69                                                                                                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n",
-      "12:16:24.69                                                                                                     0, 0, 0, 0, 0, 0, 0, 0]]),\n",
-      "12:16:24.69                                                                                             'subtoken_mask': tensor([[ True,  True,  True,  True,  True,  True,  True,  True,  True,  True,\n",
-      "12:16:24.69                                                                                                      True,  True, False, False,  True,  True,  True,  True,  True,  True,\n",
-      "12:16:24.69                                                                                                      True, False, False, False, False, False, False, False, False, False,\n",
-      "12:16:24.69                                                                                                     False, False, False, False, False, False, False, False, False, False,\n",
-      "12:16:24.69                                                                                                     False, False, False, False, False, False, False, False, False, False,\n",
-      "12:16:24.69                                                                                                     False, False, False, False, False, False, False, False, False, False,\n",
-      "12:16:24.69                                                                                                     False, False, False, False, False, False, False, False, False, False,\n",
-      "12:16:24.69                                                                                                     False, False, False, False, False, False, False, False, False, False,\n",
-      "12:16:24.69                                                                                                     False, False, False, False, False, False, False, False, False, False,\n",
-      "12:16:24.69                                                                                                     False, False, False, False, False, False, False, False, False, False,\n",
-      "12:16:24.69                                                                                                     False, False, False, False, False, False, False, False, False, False,\n",
-      "12:16:24.69                                                                                                     False, False, False, False, False, False, False, False, False, False,\n",
-      "12:16:24.69                                                                                                     False, False, False, False, False, False, False, False],\n",
-      "12:16:24.69                                                                                                    [ True,  True,  True,  True,  True,  True,  True,  True,  True, False,\n",
-      "12:16:24.69                                                                                                     False, False, False, False, False, False, False, False, False, False,\n",
-      "12:16:24.69                                                                                                     False, False, False, False, False, False, False, False, False, False,\n",
-      "12:16:24.69                                                                                                     False, False, False, False, False, False, False, False, False, False,\n",
-      "12:16:24.69                                                                                                     False, False, False, False, False, False, False, False, False, False,\n",
-      "12:16:24.69                                                                                                     False, False, False, False, False, False, False, False, False, False,\n",
-      "12:16:24.69                                                                                                     False, False, False, False, False, False, False, False, False, False,\n",
-      "12:16:24.69                                                                                                     False, False, False, False, False, False, False, False, False, False,\n",
-      "12:16:24.69                                                                                                     False, False, False, False, False, False, False, False, False, False,\n",
-      "12:16:24.69                                                                                                     False, False, False, False, False, False, False, False, False, False,\n",
-      "12:16:24.69                                                                                                     False, False, False, False, False, False, False, False, False, False,\n",
-      "12:16:24.69                                                                                                     False, False, False, False, False, False, False, False, False, False,\n",
-      "12:16:24.69                                                                                                     False, False, False, False, False, False, False, False],\n",
-      "12:16:24.69                                                                                                    [ True,  True,  True,  True,  True, False, False, False, False, False,\n",
-      "12:16:24.69                                                                                                     False, False, False, False, False, False, False, False, False, False,\n",
-      "12:16:24.69                                                                                                     False, False, False, False, False, False, False, False, False, False,\n",
-      "12:16:24.69                                                                                                     False, False, False, False, False, False, False, False, False, False,\n",
-      "12:16:24.69                                                                                                     False, False, False, False, False, False, False, False, False, False,\n",
-      "12:16:24.69                                                                                                     False, False, False, False, False, False, False, False, False, False,\n",
-      "12:16:24.69                                                                                                     False, False, False, False, False, False, False, False, False, False,\n",
-      "12:16:24.69                                                                                                     False, False, False, False, False, False, False, False, False, False,\n",
-      "12:16:24.69                                                                                                     False, False, False, False, False, False, False, False, False, False,\n",
-      "12:16:24.69                                                                                                     False, False, False, False, False, False, False, False, False, False,\n",
-      "12:16:24.69                                                                                                     False, False, False, False, False, False, False, False, False, False,\n",
-      "12:16:24.69                                                                                                     False, False, False, False, False, False, False, False, False, False,\n",
-      "12:16:24.69                                                                                                     False, False, False, False, False, False, False, False]])}\n"
-     ]
-    },
-    {
      "data": {
       "text/plain": [
-       "['[CLS] we, bought, four- shirts: one, pen, and, a, mug, from, the, nvidia- gear, store, in, santa- clara, [SEP] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD]',\n",
-       " '[CLS] what? can— i? do? for? you? today? [SEP] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD]',\n",
+       "['[CLS] we, bought: four- shirts, one, pen, and, a, mug, from, the, nvidia- gear, store, in, santa- clara, [SEP] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD]',\n",
+       " '[CLS] what? can, i? do? for? you? today? [SEP] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD]',\n",
        " '[CLS] how? are? you? [SEP] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD]']"
       ]
      },
@@ -246,7 +115,7 @@
   {
    "cell_type": "code",
    "execution_count": null,
-   "id": "amateur-production",
+   "id": "employed-station",
    "metadata": {},
    "outputs": [],
    "source": []
diff --git a/experiment/config.yaml b/experiment/config.yaml
index efa7a5d..13df7bd 100644
--- a/experiment/config.yaml
+++ b/experiment/config.yaml
@@ -5,7 +5,7 @@ trainer:
     max_epochs: 10
     max_steps: null # precedence over max_epochs
     accumulate_grad_batches: 4 # accumulates grads every k batches
-    gradient_clip_val: 0
+    gradient_clip_val: 4
     amp_level: O1 # O1/O2 for mixed precision
     precision: 16 # Should be set to 16 for O1 and O2, default is 16 as PT ignores it when am_level is O0
     accelerator: ddp
@@ -75,7 +75,7 @@ model:
         ignore_start_end: false
         use_cache: false
         # shared among dataloaders
-        num_workers:  4
+        num_workers:  6
         pin_memory: true
         drop_last: false
         num_labels: 10
diff --git a/experiment/info.log b/experiment/info.log
index 69e9a76..e69de29 100644
--- a/experiment/info.log
+++ b/experiment/info.log
@@ -1,85 +0,0 @@
-[INFO] - shuffling train set
-[INFO] - Optimizer config = AdamW (
-Parameter Group 0
-    amsgrad: False
-    betas: (0.9, 0.999)
-    eps: 1e-08
-    lr: 0.001
-    weight_decay: 0.0
-)
-[INFO] - Scheduler "<core.optim.lr_scheduler.WarmupAnnealing object at 0x7f717ffe5b80>" 
-will be used during training (effective maximum steps = 80) - 
-Parameters : 
-(warmup_steps: null
-warmup_ratio: 0.1
-last_epoch: -1
-max_steps: 80
-)
-[INFO] - Punctuation report: 
-label                                                precision    recall       f1           support   
- (label_id: 0)                                          89.19      22.74      36.24       3012
-! (label_id: 1)                                          0.00       0.00       0.00          1
-, (label_id: 2)                                          7.31      36.21      12.16        243
-- (label_id: 3)                                          2.27      21.43       4.11         28
-. (label_id: 4)                                          1.68       1.65       1.66        182
-: (label_id: 5)                                          0.00       0.00       0.00          5
-; (label_id: 6)                                          0.00       0.00       0.00          3
-? (label_id: 7)                                          0.24      22.22       0.48          9
-— (label_id: 8)                                          0.00       0.00       0.00         10
-… (label_id: 9)                                          0.00       0.00       0.00          1
--------------------
-micro avg                                               22.44      22.44      22.44       3494
-macro avg                                               10.07      10.43       5.47       3494
-weighted avg                                            77.50      22.44      32.21       3494
-
-[INFO] - Domain report: 
-label                                                precision    recall       f1           support   
-0 (label_id: 0)                                         50.00     100.00      66.67         34
-1 (label_id: 1)                                          0.00       0.00       0.00         34
--------------------
-micro avg                                               50.00      50.00      50.00         68
-macro avg                                               25.00      50.00      33.33         68
-weighted avg                                            25.00      50.00      33.33         68
-
-[INFO] - Optimizer config = AdamW (
-Parameter Group 0
-    amsgrad: False
-    betas: (0.9, 0.999)
-    eps: 1e-08
-    lr: 0.007943282347242822
-    weight_decay: 0.0
-)
-[INFO] - Scheduler "<core.optim.lr_scheduler.WarmupAnnealing object at 0x7f717f560fa0>" 
-will be used during training (effective maximum steps = 53050) - 
-Parameters : 
-(warmup_steps: null
-warmup_ratio: 0.1
-last_epoch: -1
-max_steps: 53050
-)
-[INFO] - Punctuation report: 
-label                                                precision    recall       f1           support   
- (label_id: 0)                                          89.19      22.74      36.24       3012
-! (label_id: 1)                                          0.00       0.00       0.00          1
-, (label_id: 2)                                          7.31      36.21      12.16        243
-- (label_id: 3)                                          2.27      21.43       4.11         28
-. (label_id: 4)                                          1.68       1.65       1.66        182
-: (label_id: 5)                                          0.00       0.00       0.00          5
-; (label_id: 6)                                          0.00       0.00       0.00          3
-? (label_id: 7)                                          0.24      22.22       0.48          9
-— (label_id: 8)                                          0.00       0.00       0.00         10
-… (label_id: 9)                                          0.00       0.00       0.00          1
--------------------
-micro avg                                               22.44      22.44      22.44       3494
-macro avg                                               10.07      10.43       5.47       3494
-weighted avg                                            77.50      22.44      32.21       3494
-
-[INFO] - Domain report: 
-label                                                precision    recall       f1           support   
-0 (label_id: 0)                                         50.00     100.00      66.67         34
-1 (label_id: 1)                                          0.00       0.00       0.00         34
--------------------
-micro avg                                               50.00      50.00      50.00         68
-macro avg                                               25.00      50.00      33.33         68
-weighted avg                                            25.00      50.00      33.33         68
-
