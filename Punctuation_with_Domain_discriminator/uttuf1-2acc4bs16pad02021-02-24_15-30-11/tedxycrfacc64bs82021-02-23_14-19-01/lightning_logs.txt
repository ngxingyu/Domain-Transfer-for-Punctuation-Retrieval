GPU available: True, used: True
TPU available: None, using: 0 TPU cores
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Using native 16bit precision.
initializing ddp: GLOBAL_RANK: 0, MEMBER: 1/1

  | Name                       | Type                 | Params
--------------------------------------------------------------------
0 | transformer                | ElectraModel         | 108 M 
1 | punct_classifier           | TokenClassifier      | 6.9 K 
2 | domain_classifier          | SequenceClassifier   | 4.7 M 
3 | punctuation_loss           | LinearChainCRF       | 99    
4 | domain_loss                | CrossEntropyLoss     | 0     
5 | agg_loss                   | AggregatorLoss       | 0     
6 | punct_class_report         | ClassificationReport | 0     
7 | chunked_punct_class_report | ClassificationReport | 0     
8 | domain_class_report        | ClassificationReport | 0     
--------------------------------------------------------------------
4.7 M     Trainable params
108 M     Non-trainable params
113 M     Total params
Epoch 0, global step 6: val_loss reached 85.12852 (best 85.12852), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-02-23_14-19-01/checkpoints/Punctuation_with_Domain_discriminator---val_loss=85.13-epoch=0.ckpt" as top 3
Epoch 1, global step 13: val_loss reached 55.79579 (best 55.79579), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-02-23_14-19-01/checkpoints/Punctuation_with_Domain_discriminator---val_loss=55.80-epoch=1.ckpt" as top 3
Epoch 2, global step 20: val_loss reached 45.62790 (best 45.62790), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-02-23_14-19-01/checkpoints/Punctuation_with_Domain_discriminator---val_loss=45.63-epoch=2.ckpt" as top 3
Epoch 3, global step 27: val_loss reached 40.77449 (best 40.77449), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-02-23_14-19-01/checkpoints/Punctuation_with_Domain_discriminator---val_loss=40.77-epoch=3.ckpt" as top 3
Epoch 4, global step 34: val_loss reached 35.99324 (best 35.99324), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-02-23_14-19-01/checkpoints/Punctuation_with_Domain_discriminator---val_loss=35.99-epoch=4.ckpt" as top 3
Epoch 5, global step 41: val_loss reached 34.62835 (best 34.62835), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-02-23_14-19-01/checkpoints/Punctuation_with_Domain_discriminator---val_loss=34.63-epoch=5.ckpt" as top 3
Epoch 6, global step 48: val_loss reached 34.04360 (best 34.04360), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-02-23_14-19-01/checkpoints/Punctuation_with_Domain_discriminator---val_loss=34.04-epoch=6.ckpt" as top 3
Epoch 7, global step 55: val_loss reached 33.92826 (best 33.92826), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-02-23_14-19-01/checkpoints/Punctuation_with_Domain_discriminator---val_loss=33.93-epoch=7.ckpt" as top 3
Saving latest checkpoint...

  | Name                       | Type                 | Params
--------------------------------------------------------------------
0 | transformer                | ElectraModel         | 108 M 
1 | punct_classifier           | TokenClassifier      | 6.9 K 
2 | domain_classifier          | SequenceClassifier   | 4.7 M 
3 | punctuation_loss           | LinearChainCRF       | 99    
4 | domain_loss                | CrossEntropyLoss     | 0     
5 | agg_loss                   | AggregatorLoss       | 0     
6 | punct_class_report         | ClassificationReport | 0     
7 | chunked_punct_class_report | ClassificationReport | 0     
8 | domain_class_report        | ClassificationReport | 0     
--------------------------------------------------------------------
11.8 M    Trainable params
101 M     Non-trainable params
113 M     Total params
Epoch 0, step 62: val_loss was not in top 3
Epoch 1, global step 69: val_loss reached 34.51523 (best 33.92826), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-02-23_14-19-01/checkpoints/Punctuation_with_Domain_discriminator---val_loss=34.52-epoch=1.ckpt" as top 3
Epoch 2, global step 76: val_loss reached 29.93641 (best 29.93641), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-02-23_14-19-01/checkpoints/Punctuation_with_Domain_discriminator---val_loss=29.94-epoch=2.ckpt" as top 3
Epoch 3, global step 83: val_loss reached 23.24255 (best 23.24255), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-02-23_14-19-01/checkpoints/Punctuation_with_Domain_discriminator---val_loss=23.24-epoch=3.ckpt" as top 3
Epoch 4, global step 90: val_loss reached 21.94288 (best 21.94288), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-02-23_14-19-01/checkpoints/Punctuation_with_Domain_discriminator---val_loss=21.94-epoch=4.ckpt" as top 3
Epoch 5, global step 97: val_loss reached 21.88619 (best 21.88619), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-02-23_14-19-01/checkpoints/Punctuation_with_Domain_discriminator---val_loss=21.89-epoch=5.ckpt" as top 3
Epoch 6, global step 104: val_loss reached 21.58325 (best 21.58325), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-02-23_14-19-01/checkpoints/Punctuation_with_Domain_discriminator---val_loss=21.58-epoch=6.ckpt" as top 3
Epoch 7, global step 111: val_loss reached 21.49760 (best 21.49760), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-02-23_14-19-01/checkpoints/Punctuation_with_Domain_discriminator---val_loss=21.50-epoch=7.ckpt" as top 3

  | Name                       | Type                 | Params
--------------------------------------------------------------------
0 | transformer                | ElectraModel         | 108 M 
1 | punct_classifier           | TokenClassifier      | 6.9 K 
2 | domain_classifier          | SequenceClassifier   | 4.7 M 
3 | punctuation_loss           | LinearChainCRF       | 99    
4 | domain_loss                | CrossEntropyLoss     | 0     
5 | agg_loss                   | AggregatorLoss       | 0     
6 | punct_class_report         | ClassificationReport | 0     
7 | chunked_punct_class_report | ClassificationReport | 0     
8 | domain_class_report        | ClassificationReport | 0     
--------------------------------------------------------------------
18.9 M    Trainable params
94.7 M    Non-trainable params
113 M     Total params
Epoch 0, global step 118: val_loss reached 20.72651 (best 20.72651), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-02-23_14-19-01/checkpoints/Punctuation_with_Domain_discriminator---val_loss=20.73-epoch=0.ckpt" as top 3
Epoch 1, global step 125: val_loss reached 18.46413 (best 18.46413), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-02-23_14-19-01/checkpoints/Punctuation_with_Domain_discriminator---val_loss=18.46-epoch=1.ckpt" as top 3
Epoch 2, global step 132: val_loss reached 17.67385 (best 17.67385), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-02-23_14-19-01/checkpoints/Punctuation_with_Domain_discriminator---val_loss=17.67-epoch=2.ckpt" as top 3
Epoch 3, global step 139: val_loss reached 17.75857 (best 17.67385), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-02-23_14-19-01/checkpoints/Punctuation_with_Domain_discriminator---val_loss=17.76-epoch=3.ckpt" as top 3
Epoch 4, global step 146: val_loss reached 17.71283 (best 17.67385), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-02-23_14-19-01/checkpoints/Punctuation_with_Domain_discriminator---val_loss=17.71-epoch=4.ckpt" as top 3
Epoch 5, global step 153: val_loss reached 17.66510 (best 17.66510), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-02-23_14-19-01/checkpoints/Punctuation_with_Domain_discriminator---val_loss=17.67-epoch=5.ckpt" as top 3
Epoch 6, global step 160: val_loss reached 17.43834 (best 17.43834), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-02-23_14-19-01/checkpoints/Punctuation_with_Domain_discriminator---val_loss=17.44-epoch=6.ckpt" as top 3
Epoch 7, global step 167: val_loss reached 17.37023 (best 17.37023), saving model to "/home/nxingyu2/project/Punctuation_with_Domain_discriminator/2021-02-23_14-19-01/checkpoints/Punctuation_with_Domain_discriminator---val_loss=17.37-epoch=7.ckpt" as top 3
GPU available: True, used: True
TPU available: None, using: 0 TPU cores
Using environment variable NODE_RANK for node rank (0).
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
